<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report-3.0.xsd" version="3.0" name="org.apache.hadoop.hdds.scm.block.TestBlockManager" time="6.918" tests="12" errors="1" skipped="0" failures="0">
  <properties>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="file.encoding.pkg" value="sun.io"/>
    <property name="java.specification.version" value="1.8"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/home/runner/work/ozone/ozone/hadoop-hdds/server-scm/target/test-classes:/home/runner/work/ozone/ozone/hadoop-hdds/server-scm/target/classes:/home/runner/work/ozone/ozone/hadoop-hdds/test-utils/target/classes:/home/runner/.m2/repository/com/google/guava/guava/31.1-jre/guava-31.1-jre.jar:/home/runner/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/runner/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/runner/.m2/repository/org/checkerframework/checker-qual/3.12.0/checker-qual-3.12.0.jar:/home/runner/.m2/repository/com/google/errorprone/error_prone_annotations/2.2.0/error_prone_annotations-2.2.0.jar:/home/runner/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/runner/.m2/repository/commons-io/commons-io/2.11.0/commons-io-2.11.0.jar:/home/runner/.m2/repository/commons-logging/commons-logging/1.2/commons-logging-1.2.jar:/home/runner/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/runner/.m2/repository/org/apache/commons/commons-lang3/3.7/commons-lang3-3.7.jar:/home/runner/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes:/home/runner/work/ozone/ozone/hadoop-hdds/hadoop-dependency-client/target/classes:/home/runner/.m2/repository/info/picocli/picocli/4.6.1/picocli-4.6.1.jar:/home/runner/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.13.2/jackson-annotations-2.13.2.jar:/home/runner/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.13.2/jackson-datatype-jsr310-2.13.2.jar:/home/runner/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.13.2/jackson-core-2.13.2.jar:/home/runner/work/ozone/ozone/hadoop-hdds/config/target/classes:/home/runner/.m2/repository/javax/annotation/javax.annotation-api/1.2/javax.annotation-api-1.2.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-server/2.3.0/ratis-server-2.3.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.0/ratis-thirdparty-misc-1.0.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-proto/2.3.0/ratis-proto-2.3.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-common/2.3.0/ratis-common-2.3.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-client/2.3.0/ratis-client-2.3.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-server-api/2.3.0/ratis-server-api-2.3.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-metrics/2.3.0/ratis-metrics-2.3.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-netty/2.3.0/ratis-netty-2.3.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-grpc/2.3.0/ratis-grpc-2.3.0.jar:/home/runner/.m2/repository/org/apache/logging/log4j/log4j-api/2.17.1/log4j-api-2.17.1.jar:/home/runner/.m2/repository/org/apache/commons/commons-pool2/2.6.0/commons-pool2-2.6.0.jar:/home/runner/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.67/bcpkix-jdk15on-1.67.jar:/home/runner/.m2/repository/commons-validator/commons-validator/1.6/commons-validator-1.6.jar:/home/runner/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/runner/.m2/repository/commons-digester/commons-digester/1.8.1/commons-digester-1.8.1.jar:/home/runner/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/runner/.m2/repository/io/jaegertracing/jaeger-client/1.6.0/jaeger-client-1.6.0.jar:/home/runner/.m2/repository/io/jaegertracing/jaeger-thrift/1.6.0/jaeger-thrift-1.6.0.jar:/home/runner/.m2/repository/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar:/home/runner/.m2/repository/com/squareup/okhttp3/okhttp/4.9.0/okhttp-4.9.0.jar:/home/runner/.m2/repository/com/squareup/okio/okio/2.8.0/okio-2.8.0.jar:/home/runner/.m2/repository/io/jaegertracing/jaeger-core/1.6.0/jaeger-core-1.6.0.jar:/home/runner/.m2/repository/io/jaegertracing/jaeger-tracerresolver/1.6.0/jaeger-tracerresolver-1.6.0.jar:/home/runner/.m2/repository/io/opentracing/contrib/opentracing-tracerresolver/0.1.8/opentracing-tracerresolver-0.1.8.jar:/home/runner/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.21/kotlin-stdlib-1.6.21.jar:/home/runner/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.21/kotlin-stdlib-common-1.6.21.jar:/home/runner/.m2/repository/org/jetbrains/annotations/13.0/annotations-13.0.jar:/home/runner/.m2/repository/io/opentracing/opentracing-util/0.33.0/opentracing-util-0.33.0.jar:/home/runner/.m2/repository/io/opentracing/opentracing-api/0.33.0/opentracing-api-0.33.0.jar:/home/runner/.m2/repository/io/opentracing/opentracing-noop/0.33.0/opentracing-noop-0.33.0.jar:/home/runner/.m2/repository/org/yaml/snakeyaml/1.26/snakeyaml-1.26.jar:/home/runner/.m2/repository/org/reflections/reflections/0.9.11/reflections-0.9.11.jar:/home/runner/.m2/repository/org/javassist/javassist/3.21.0-GA/javassist-3.21.0-GA.jar:/home/runner/work/ozone/ozone/hadoop-hdds/interface-client/target/classes:/home/runner/.m2/repository/org/apache/hadoop/thirdparty/hadoop-shaded-protobuf_3_7/1.1.1/hadoop-shaded-protobuf_3_7-1.1.1.jar:/home/runner/work/ozone/ozone/hadoop-hdds/interface-admin/target/classes:/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/classes:/home/runner/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/runner/.m2/repository/commons-codec/commons-codec/1.11/commons-codec-1.11.jar:/home/runner/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar:/home/runner/.m2/repository/org/glassfish/jaxb/jaxb-runtime/2.3.0.1/jaxb-runtime-2.3.0.1.jar:/home/runner/.m2/repository/org/glassfish/jaxb/jaxb-core/2.3.0.1/jaxb-core-2.3.0.1.jar:/home/runner/.m2/repository/org/glassfish/jaxb/txw2/2.3.0.1/txw2-2.3.0.1.jar:/home/runner/.m2/repository/com/sun/istack/istack-commons-runtime/3.0.5/istack-commons-runtime-3.0.5.jar:/home/runner/.m2/repository/org/jvnet/staxex/stax-ex/1.7.8/stax-ex-1.7.8.jar:/home/runner/.m2/repository/com/sun/xml/fastinfoset/FastInfoset/1.2.13/FastInfoset-1.2.13.jar:/home/runner/.m2/repository/io/netty/netty-transport/4.1.74.Final/netty-transport-4.1.74.Final.jar:/home/runner/.m2/repository/io/netty/netty-common/4.1.74.Final/netty-common-4.1.74.Final.jar:/home/runner/.m2/repository/io/netty/netty-buffer/4.1.74.Final/netty-buffer-4.1.74.Final.jar:/home/runner/.m2/repository/io/netty/netty-resolver/4.1.74.Final/netty-resolver-4.1.74.Final.jar:/home/runner/.m2/repository/io/netty/netty-codec/4.1.74.Final/netty-codec-4.1.74.Final.jar:/home/runner/.m2/repository/io/netty/netty-handler/4.1.74.Final/netty-handler-4.1.74.Final.jar:/home/runner/.m2/repository/io/netty/netty-tcnative-classes/2.0.48.Final/netty-tcnative-classes-2.0.48.Final.jar:/home/runner/work/ozone/ozone/hadoop-hdds/client/target/classes:/home/runner/work/ozone/ozone/hadoop-hdds/erasurecode/target/classes:/home/runner/work/ozone/ozone/hadoop-hdds/hadoop-dependency-server/target/classes:/home/runner/.m2/repository/org/apache/hadoop/hadoop-annotations/3.3.1/hadoop-annotations-3.3.1.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/../lib/tools.jar:/home/runner/.m2/repository/org/apache/hadoop/hadoop-common/3.3.1/hadoop-common-3.3.1.jar:/home/runner/.m2/repository/org/apache/hadoop/thirdparty/hadoop-shaded-guava/1.1.1/hadoop-shaded-guava-1.1.1.jar:/home/runner/.m2/repository/org/apache/commons/commons-math3/3.1.1/commons-math3-3.1.1.jar:/home/runner/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/runner/.m2/repository/org/apache/httpcomponents/httpcore/4.4.13/httpcore-4.4.13.jar:/home/runner/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/runner/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/runner/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:/home/runner/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/runner/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/runner/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/runner/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/runner/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/runner/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/runner/.m2/repository/org/apache/commons/commons-text/1.4/commons-text-1.4.jar:/home/runner/.m2/repository/org/slf4j/slf4j-log4j12/1.7.30/slf4j-log4j12-1.7.30.jar:/home/runner/.m2/repository/com/google/re2j/re2j/1.1/re2j-1.1.jar:/home/runner/.m2/repository/com/google/code/gson/gson/2.9.0/gson-2.9.0.jar:/home/runner/.m2/repository/org/apache/hadoop/hadoop-auth/3.3.1/hadoop-auth-3.3.1.jar:/home/runner/.m2/repository/com/nimbusds/nimbus-jose-jwt/7.9/nimbus-jose-jwt-7.9.jar:/home/runner/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/runner/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/runner/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/runner/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/runner/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/runner/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/runner/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/runner/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/runner/.m2/repository/dnsjava/dnsjava/2.1.7/dnsjava-2.1.7.jar:/home/runner/.m2/repository/org/xerial/snappy/snappy-java/1.1.8.2/snappy-java-1.1.8.2.jar:/home/runner/.m2/repository/commons-cli/commons-cli/1.2/commons-cli-1.2.jar:/home/runner/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.3.1/hadoop-hdfs-3.3.1.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.43.v20210629/jetty-util-ajax-9.4.43.v20210629.jar:/home/runner/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/runner/work/ozone/ozone/hadoop-hdds/framework/target/classes:/home/runner/work/ozone/ozone/hadoop-hdds/interface-server/target/classes:/home/runner/.m2/repository/org/apache/logging/log4j/log4j-core/2.17.1/log4j-core-2.17.1.jar:/home/runner/.m2/repository/com/lmax/disruptor/3.4.2/disruptor-3.4.2.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-util/9.4.43.v20210629/jetty-util-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-server/9.4.43.v20210629/jetty-server-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-http/9.4.43.v20210629/jetty-http-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-io/9.4.43.v20210629/jetty-io-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.43.v20210629/jetty-servlet-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-security/9.4.43.v20210629/jetty-security-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.43.v20210629/jetty-webapp-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.43.v20210629/jetty-xml-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/rocksdb/rocksdbjni/6.29.5/rocksdbjni-6.29.5.jar:/home/runner/.m2/repository/io/prometheus/simpleclient_dropwizard/0.7.0/simpleclient_dropwizard-0.7.0.jar:/home/runner/.m2/repository/io/prometheus/simpleclient/0.7.0/simpleclient-0.7.0.jar:/home/runner/.m2/repository/io/prometheus/simpleclient_common/0.7.0/simpleclient_common-0.7.0.jar:/home/runner/work/ozone/ozone/hadoop-hdds/docs/target/classes:/home/runner/.m2/repository/io/dropwizard/metrics/metrics-core/3.2.4/metrics-core-3.2.4.jar:/home/runner/.m2/repository/com/github/spotbugs/spotbugs-annotations/3.1.12/spotbugs-annotations-3.1.12.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/runner/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.3.1/hadoop-hdfs-client-3.3.1.jar:/home/runner/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.13.2.2/jackson-databind-2.13.2.2.jar:/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-classes:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/test-classes:/home/runner/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/runner/.m2/repository/org/assertj/assertj-core/3.12.2/assertj-core-3.12.2.jar:/home/runner/.m2/repository/org/mockito/mockito-core/2.28.2/mockito-core-2.28.2.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.9.10/byte-buddy-1.9.10.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.9.10/byte-buddy-agent-1.9.10.jar:/home/runner/.m2/repository/org/objenesis/objenesis/1.0/objenesis-1.0.jar:/home/runner/.m2/repository/org/hamcrest/hamcrest-all/1.3/hamcrest-all-1.3.jar:/home/runner/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.67/bcprov-jdk15on-1.67.jar:/home/runner/work/ozone/ozone/hadoop-hdds/hadoop-dependency-test/target/classes:/home/runner/.m2/repository/org/apache/hadoop/hadoop-common/3.3.1/hadoop-common-3.3.1-tests.jar:/home/runner/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.3.1/hadoop-hdfs-3.3.1-tests.jar:/home/runner/.m2/repository/com/google/protobuf/protobuf-java/2.5.0/protobuf-java-2.5.0.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.8.2/junit-jupiter-api-5.8.2.jar:/home/runner/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-commons/1.8.2/junit-platform-commons-1.8.2.jar:/home/runner/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.8.2/junit-jupiter-engine-5.8.2.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-engine/1.8.2/junit-platform-engine-1.8.2.jar:/home/runner/.m2/repository/org/junit/vintage/junit-vintage-engine/5.8.2/junit-vintage-engine-5.8.2.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-launcher/1.8.2/junit-platform-launcher-1.8.2.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.8.2/junit-jupiter-params-5.8.2.jar:/home/runner/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/runner/work/ozone/ozone/dev-support/annotations/target/classes:"/>
    <property name="java.vm.vendor" value="Temurin"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="test.build.dir" value="/home/runner/work/ozone/ozone/hadoop-hdds/server-scm/target/test-dir"/>
    <property name="test.cache.data" value=""/>
    <property name="java.vendor.url" value="https://adoptium.net/"/>
    <property name="user.timezone" value="Etc/UTC"/>
    <property name="java.vm.specification.version" value="1.8"/>
    <property name="os.name" value="Linux"/>
    <property name="test.build.data" value="/home/runner/work/ozone/ozone/hadoop-hdds/server-scm/target/test-dir"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/amd64"/>
    <property name="sun.java.command" value="/home/runner/work/ozone/ozone/hadoop-hdds/server-scm/target/surefire/surefirebooter8618760530362787685.jar /home/runner/work/ozone/ozone/hadoop-hdds/server-scm/target/surefire 2022-06-30T10-22-02_148-jvmRun1 surefire1205032818785085135tmp surefire_2595171726417741197048tmp"/>
    <property name="surefire.test.class.path" value="/home/runner/work/ozone/ozone/hadoop-hdds/server-scm/target/test-classes:/home/runner/work/ozone/ozone/hadoop-hdds/server-scm/target/classes:/home/runner/work/ozone/ozone/hadoop-hdds/test-utils/target/classes:/home/runner/.m2/repository/com/google/guava/guava/31.1-jre/guava-31.1-jre.jar:/home/runner/.m2/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:/home/runner/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/home/runner/.m2/repository/org/checkerframework/checker-qual/3.12.0/checker-qual-3.12.0.jar:/home/runner/.m2/repository/com/google/errorprone/error_prone_annotations/2.2.0/error_prone_annotations-2.2.0.jar:/home/runner/.m2/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:/home/runner/.m2/repository/commons-io/commons-io/2.11.0/commons-io-2.11.0.jar:/home/runner/.m2/repository/commons-logging/commons-logging/1.2/commons-logging-1.2.jar:/home/runner/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/runner/.m2/repository/org/apache/commons/commons-lang3/3.7/commons-lang3-3.7.jar:/home/runner/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes:/home/runner/work/ozone/ozone/hadoop-hdds/hadoop-dependency-client/target/classes:/home/runner/.m2/repository/info/picocli/picocli/4.6.1/picocli-4.6.1.jar:/home/runner/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.13.2/jackson-annotations-2.13.2.jar:/home/runner/.m2/repository/com/fasterxml/jackson/datatype/jackson-datatype-jsr310/2.13.2/jackson-datatype-jsr310-2.13.2.jar:/home/runner/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.13.2/jackson-core-2.13.2.jar:/home/runner/work/ozone/ozone/hadoop-hdds/config/target/classes:/home/runner/.m2/repository/javax/annotation/javax.annotation-api/1.2/javax.annotation-api-1.2.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-server/2.3.0/ratis-server-2.3.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/1.0.0/ratis-thirdparty-misc-1.0.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-proto/2.3.0/ratis-proto-2.3.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-common/2.3.0/ratis-common-2.3.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-client/2.3.0/ratis-client-2.3.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-server-api/2.3.0/ratis-server-api-2.3.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-metrics/2.3.0/ratis-metrics-2.3.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-netty/2.3.0/ratis-netty-2.3.0.jar:/home/runner/.m2/repository/org/apache/ratis/ratis-grpc/2.3.0/ratis-grpc-2.3.0.jar:/home/runner/.m2/repository/org/apache/logging/log4j/log4j-api/2.17.1/log4j-api-2.17.1.jar:/home/runner/.m2/repository/org/apache/commons/commons-pool2/2.6.0/commons-pool2-2.6.0.jar:/home/runner/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.67/bcpkix-jdk15on-1.67.jar:/home/runner/.m2/repository/commons-validator/commons-validator/1.6/commons-validator-1.6.jar:/home/runner/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/runner/.m2/repository/commons-digester/commons-digester/1.8.1/commons-digester-1.8.1.jar:/home/runner/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/runner/.m2/repository/io/jaegertracing/jaeger-client/1.6.0/jaeger-client-1.6.0.jar:/home/runner/.m2/repository/io/jaegertracing/jaeger-thrift/1.6.0/jaeger-thrift-1.6.0.jar:/home/runner/.m2/repository/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar:/home/runner/.m2/repository/com/squareup/okhttp3/okhttp/4.9.0/okhttp-4.9.0.jar:/home/runner/.m2/repository/com/squareup/okio/okio/2.8.0/okio-2.8.0.jar:/home/runner/.m2/repository/io/jaegertracing/jaeger-core/1.6.0/jaeger-core-1.6.0.jar:/home/runner/.m2/repository/io/jaegertracing/jaeger-tracerresolver/1.6.0/jaeger-tracerresolver-1.6.0.jar:/home/runner/.m2/repository/io/opentracing/contrib/opentracing-tracerresolver/0.1.8/opentracing-tracerresolver-0.1.8.jar:/home/runner/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib/1.6.21/kotlin-stdlib-1.6.21.jar:/home/runner/.m2/repository/org/jetbrains/kotlin/kotlin-stdlib-common/1.6.21/kotlin-stdlib-common-1.6.21.jar:/home/runner/.m2/repository/org/jetbrains/annotations/13.0/annotations-13.0.jar:/home/runner/.m2/repository/io/opentracing/opentracing-util/0.33.0/opentracing-util-0.33.0.jar:/home/runner/.m2/repository/io/opentracing/opentracing-api/0.33.0/opentracing-api-0.33.0.jar:/home/runner/.m2/repository/io/opentracing/opentracing-noop/0.33.0/opentracing-noop-0.33.0.jar:/home/runner/.m2/repository/org/yaml/snakeyaml/1.26/snakeyaml-1.26.jar:/home/runner/.m2/repository/org/reflections/reflections/0.9.11/reflections-0.9.11.jar:/home/runner/.m2/repository/org/javassist/javassist/3.21.0-GA/javassist-3.21.0-GA.jar:/home/runner/work/ozone/ozone/hadoop-hdds/interface-client/target/classes:/home/runner/.m2/repository/org/apache/hadoop/thirdparty/hadoop-shaded-protobuf_3_7/1.1.1/hadoop-shaded-protobuf_3_7-1.1.1.jar:/home/runner/work/ozone/ozone/hadoop-hdds/interface-admin/target/classes:/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/classes:/home/runner/.m2/repository/org/apache/commons/commons-compress/1.21/commons-compress-1.21.jar:/home/runner/.m2/repository/commons-codec/commons-codec/1.11/commons-codec-1.11.jar:/home/runner/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar:/home/runner/.m2/repository/org/glassfish/jaxb/jaxb-runtime/2.3.0.1/jaxb-runtime-2.3.0.1.jar:/home/runner/.m2/repository/org/glassfish/jaxb/jaxb-core/2.3.0.1/jaxb-core-2.3.0.1.jar:/home/runner/.m2/repository/org/glassfish/jaxb/txw2/2.3.0.1/txw2-2.3.0.1.jar:/home/runner/.m2/repository/com/sun/istack/istack-commons-runtime/3.0.5/istack-commons-runtime-3.0.5.jar:/home/runner/.m2/repository/org/jvnet/staxex/stax-ex/1.7.8/stax-ex-1.7.8.jar:/home/runner/.m2/repository/com/sun/xml/fastinfoset/FastInfoset/1.2.13/FastInfoset-1.2.13.jar:/home/runner/.m2/repository/io/netty/netty-transport/4.1.74.Final/netty-transport-4.1.74.Final.jar:/home/runner/.m2/repository/io/netty/netty-common/4.1.74.Final/netty-common-4.1.74.Final.jar:/home/runner/.m2/repository/io/netty/netty-buffer/4.1.74.Final/netty-buffer-4.1.74.Final.jar:/home/runner/.m2/repository/io/netty/netty-resolver/4.1.74.Final/netty-resolver-4.1.74.Final.jar:/home/runner/.m2/repository/io/netty/netty-codec/4.1.74.Final/netty-codec-4.1.74.Final.jar:/home/runner/.m2/repository/io/netty/netty-handler/4.1.74.Final/netty-handler-4.1.74.Final.jar:/home/runner/.m2/repository/io/netty/netty-tcnative-classes/2.0.48.Final/netty-tcnative-classes-2.0.48.Final.jar:/home/runner/work/ozone/ozone/hadoop-hdds/client/target/classes:/home/runner/work/ozone/ozone/hadoop-hdds/erasurecode/target/classes:/home/runner/work/ozone/ozone/hadoop-hdds/hadoop-dependency-server/target/classes:/home/runner/.m2/repository/org/apache/hadoop/hadoop-annotations/3.3.1/hadoop-annotations-3.3.1.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/../lib/tools.jar:/home/runner/.m2/repository/org/apache/hadoop/hadoop-common/3.3.1/hadoop-common-3.3.1.jar:/home/runner/.m2/repository/org/apache/hadoop/thirdparty/hadoop-shaded-guava/1.1.1/hadoop-shaded-guava-1.1.1.jar:/home/runner/.m2/repository/org/apache/commons/commons-math3/3.1.1/commons-math3-3.1.1.jar:/home/runner/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar:/home/runner/.m2/repository/org/apache/httpcomponents/httpcore/4.4.13/httpcore-4.4.13.jar:/home/runner/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/runner/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/runner/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:/home/runner/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/runner/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/runner/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/runner/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/runner/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/runner/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/runner/.m2/repository/org/apache/commons/commons-text/1.4/commons-text-1.4.jar:/home/runner/.m2/repository/org/slf4j/slf4j-log4j12/1.7.30/slf4j-log4j12-1.7.30.jar:/home/runner/.m2/repository/com/google/re2j/re2j/1.1/re2j-1.1.jar:/home/runner/.m2/repository/com/google/code/gson/gson/2.9.0/gson-2.9.0.jar:/home/runner/.m2/repository/org/apache/hadoop/hadoop-auth/3.3.1/hadoop-auth-3.3.1.jar:/home/runner/.m2/repository/com/nimbusds/nimbus-jose-jwt/7.9/nimbus-jose-jwt-7.9.jar:/home/runner/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/runner/.m2/repository/net/minidev/json-smart/2.4.7/json-smart-2.4.7.jar:/home/runner/.m2/repository/net/minidev/accessors-smart/2.4.7/accessors-smart-2.4.7.jar:/home/runner/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/runner/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/runner/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/runner/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/runner/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/runner/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/runner/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/runner/.m2/repository/dnsjava/dnsjava/2.1.7/dnsjava-2.1.7.jar:/home/runner/.m2/repository/org/xerial/snappy/snappy-java/1.1.8.2/snappy-java-1.1.8.2.jar:/home/runner/.m2/repository/commons-cli/commons-cli/1.2/commons-cli-1.2.jar:/home/runner/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.3.1/hadoop-hdfs-3.3.1.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.4.43.v20210629/jetty-util-ajax-9.4.43.v20210629.jar:/home/runner/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/runner/work/ozone/ozone/hadoop-hdds/framework/target/classes:/home/runner/work/ozone/ozone/hadoop-hdds/interface-server/target/classes:/home/runner/.m2/repository/org/apache/logging/log4j/log4j-core/2.17.1/log4j-core-2.17.1.jar:/home/runner/.m2/repository/com/lmax/disruptor/3.4.2/disruptor-3.4.2.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-util/9.4.43.v20210629/jetty-util-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-server/9.4.43.v20210629/jetty-server-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-http/9.4.43.v20210629/jetty-http-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-io/9.4.43.v20210629/jetty-io-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-servlet/9.4.43.v20210629/jetty-servlet-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-security/9.4.43.v20210629/jetty-security-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-webapp/9.4.43.v20210629/jetty-webapp-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/eclipse/jetty/jetty-xml/9.4.43.v20210629/jetty-xml-9.4.43.v20210629.jar:/home/runner/.m2/repository/org/rocksdb/rocksdbjni/6.29.5/rocksdbjni-6.29.5.jar:/home/runner/.m2/repository/io/prometheus/simpleclient_dropwizard/0.7.0/simpleclient_dropwizard-0.7.0.jar:/home/runner/.m2/repository/io/prometheus/simpleclient/0.7.0/simpleclient-0.7.0.jar:/home/runner/.m2/repository/io/prometheus/simpleclient_common/0.7.0/simpleclient_common-0.7.0.jar:/home/runner/work/ozone/ozone/hadoop-hdds/docs/target/classes:/home/runner/.m2/repository/io/dropwizard/metrics/metrics-core/3.2.4/metrics-core-3.2.4.jar:/home/runner/.m2/repository/com/github/spotbugs/spotbugs-annotations/3.1.12/spotbugs-annotations-3.1.12.jar:/home/runner/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/runner/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.3.1/hadoop-hdfs-client-3.3.1.jar:/home/runner/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.13.2.2/jackson-databind-2.13.2.2.jar:/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-classes:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/test-classes:/home/runner/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/runner/.m2/repository/org/assertj/assertj-core/3.12.2/assertj-core-3.12.2.jar:/home/runner/.m2/repository/org/mockito/mockito-core/2.28.2/mockito-core-2.28.2.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy/1.9.10/byte-buddy-1.9.10.jar:/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.9.10/byte-buddy-agent-1.9.10.jar:/home/runner/.m2/repository/org/objenesis/objenesis/1.0/objenesis-1.0.jar:/home/runner/.m2/repository/org/hamcrest/hamcrest-all/1.3/hamcrest-all-1.3.jar:/home/runner/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.67/bcprov-jdk15on-1.67.jar:/home/runner/work/ozone/ozone/hadoop-hdds/hadoop-dependency-test/target/classes:/home/runner/.m2/repository/org/apache/hadoop/hadoop-common/3.3.1/hadoop-common-3.3.1-tests.jar:/home/runner/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.3.1/hadoop-hdfs-3.3.1-tests.jar:/home/runner/.m2/repository/com/google/protobuf/protobuf-java/2.5.0/protobuf-java-2.5.0.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.8.2/junit-jupiter-api-5.8.2.jar:/home/runner/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-commons/1.8.2/junit-platform-commons-1.8.2.jar:/home/runner/.m2/repository/org/apiguardian/apiguardian-api/1.1.2/apiguardian-api-1.1.2.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.8.2/junit-jupiter-engine-5.8.2.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-engine/1.8.2/junit-platform-engine-1.8.2.jar:/home/runner/.m2/repository/org/junit/vintage/junit-vintage-engine/5.8.2/junit-vintage-engine-5.8.2.jar:/home/runner/.m2/repository/org/junit/platform/junit-platform-launcher/1.8.2/junit-platform-launcher-1.8.2.jar:/home/runner/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.8.2/junit-jupiter-params-5.8.2.jar:/home/runner/.m2/repository/junit/junit/4.13.1/junit-4.13.1.jar:/home/runner/work/ozone/ozone/dev-support/annotations/target/classes:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/runner"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.home" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre"/>
    <property name="java.security.krb5.conf" value="/home/runner/work/ozone/ozone/hadoop-hdds/server-scm/target/test-classes/krb5.conf"/>
    <property name="basedir" value="/home/runner/work/ozone/ozone/hadoop-hdds/server-scm"/>
    <property name="file.separator" value="/"/>
    <property name="line.separator" value="&#10;"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="skip.installnpx" value="true"/>
    <property name="surefire.real.class.path" value="/home/runner/work/ozone/ozone/hadoop-hdds/server-scm/target/surefire/surefirebooter8618760530362787685.jar:/home/runner/.m2/repository/org/jacoco/org.jacoco.agent/0.8.5/org.jacoco.agent-0.8.5-runtime.jar"/>
    <property name="hadoop.log.dir" value="/home/runner/work/ozone/ozone/hadoop-hdds/server-scm/target/log"/>
    <property name="sun.boot.class.path" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/temurin-8-jdk-amd64/jre/classes"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="skip.npx" value="true"/>
    <property name="java.runtime.version" value="1.8.0_332-b09"/>
    <property name="java.net.preferIPv4Stack" value="true"/>
    <property name="user.name" value="runner"/>
    <property name="path.separator" value=":"/>
    <property name="java.security.egd" value="file:///dev/urandom"/>
    <property name="os.version" value="5.4.0-1085-azure"/>
    <property name="java.endorsed.dirs" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/endorsed"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="test.build.webapps" value=""/>
    <property name="localRepository" value="/home/runner/.m2/repository"/>
    <property name="java.vendor.url.bug" value="https://github.com/adoptium/adoptium-support/issues"/>
    <property name="java.io.tmpdir" value="/tmp"/>
    <property name="require.test.libhadoop" value=""/>
    <property name="java.version" value="1.8.0_332"/>
    <property name="user.dir" value="/home/runner/work/ozone/ozone/hadoop-hdds/server-scm"/>
    <property name="os.arch" value="amd64"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="test.build.classes" value="/home/runner/work/ozone/ozone/hadoop-hdds/server-scm/target/test-classes"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="hadoop.tmp.dir" value="/home/runner/work/ozone/ozone/hadoop-hdds/server-scm/target/tmp"/>
    <property name="java.library.path" value="/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vendor" value="Temurin"/>
    <property name="java.vm.version" value="25.332-b09"/>
    <property name="java.ext.dirs" value="/usr/lib/jvm/temurin-8-jdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="java.class.version" value="52.0"/>
  </properties>
  <testcase name="testMultipleBlockAllocationWithClosedContainer" classname="org.apache.hadoop.hdds.scm.block.TestBlockManager" time="2.572">
    <system-out><![CDATA[2022-06-30 10:46:20,148 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:20,152 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:20,214 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:20,215 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:20,266 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/283b220c-eff4-4f14-a2be-f1a9a2072d20
2022-06-30 10:46:20,267 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/3d91e098-a2c0-4b5d-8d67-157e45ac98e9
2022-06-30 10:46:20,267 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/0fe923b4-a4de-4048-9163-9f28e67eb6b9
2022-06-30 10:46:20,267 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/7b5a9179-322d-4e64-97f9-921950d77fa2
2022-06-30 10:46:20,267 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/4899e36a-708d-4b3d-8e89-fed0deb5942a
2022-06-30 10:46:20,268 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/56f2344f-8f80-49ac-9a06-5866005b58bc
2022-06-30 10:46:20,268 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/c5968184-c285-4a83-b0b6-cc5a187e9f9f
2022-06-30 10:46:20,268 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/bdb85e00-2c14-4dd4-9f23-5c4072330f07
2022-06-30 10:46:20,269 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/95067dc5-3748-4a93-8e6c-52161bb4c312
2022-06-30 10:46:20,269 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/123e6e3c-12f5-4f0c-97f7-096fbe5eaad4
2022-06-30 10:46:20,335 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:20,509 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:20,667 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:20,677 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-06-30 10:46:20,706 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:20,710 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2022-06-30 10:46:20,822 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2022-06-30 10:46:20,827 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(68)) - Starting BackgroundPipelineScrubber Service.
2022-06-30 10:46:20,828 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-06-30 10:46:20,828 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2022-06-30 10:46:20,829 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:20,906 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-06-30 10:46:20,909 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-06-30 10:46:20,911 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-06-30 10:46:20,925 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:20,954 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:20,959 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(209)) - ServiceID for StorageContainerManager is null
2022-06-30 10:46:20,959 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(214)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-06-30 10:46:21,372 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:21,373 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:21,381 [main] INFO  metrics.MetricRegistries (MetricRegistriesLoader.java:load(64)) - Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
2022-06-30 10:46:21,384 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(82)) - Initializing Layout version manager with metadata layout = DATANODE_SCHEMA_V3 (version = 4), software layout = DATANODE_SCHEMA_V3 (version = 4)
2022-06-30 10:46:21,509 [main] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 103 ms to scan 6 urls, producing 128 keys and 304 values 
2022-06-30 10:46:21,573 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-06-30 10:46:21,574 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-06-30 10:46:21,574 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(374)) - upgrade containerId to 0
2022-06-30 10:46:21,574 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:21,575 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-06-30 10:46:21,577 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(68)) - Starting ExpiredContainerReplicaOpScrubber Service.
2022-06-30 10:46:21,577 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2022-06-30 10:46:21,580 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-06-30 10:46:21,594 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-06-30 10:46:21,618 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(178)) - Starting Replication Monitor Thread.
2022-06-30 10:46:21,623 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-06-30 10:46:21,628 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(227)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-06-30 10:46:21,646 [main] WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2022-06-30 10:46:21,969 [main] INFO  audit.AuditLogger (AuditLogger.java:refreshDebugCmdSet(120)) - Refresh DebugCmdSet for SCMAudit to [].
2022-06-30 10:46:22,009 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:22,044 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:22,078 [Listener at 0.0.0.0/39337] INFO  audit.AuditLogger (AuditLogger.java:refreshDebugCmdSet(120)) - Refresh DebugCmdSet for SCMAudit to [].
2022-06-30 10:46:22,084 [Listener at 0.0.0.0/39337] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:22,085 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:22,102 [Listener at 0.0.0.0/38155] INFO  audit.AuditLogger (AuditLogger.java:refreshDebugCmdSet(120)) - Refresh DebugCmdSet for SCMAudit to [].
2022-06-30 10:46:22,111 [Listener at 0.0.0.0/38155] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:22,112 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:22,152 [Listener at 0.0.0.0/43687] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2022-06-30 10:46:22,153 [Listener at 0.0.0.0/43687] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(401)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-06-30 10:46:22,155 [Listener at 0.0.0.0/43687] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(228)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-06-30 10:46:22,186 [Listener at 0.0.0.0/43687] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=91f8755a-a8ad-43c4-a78a-0f0d5c2239bc to datanode:4899e36a-708d-4b3d-8e89-fed0deb5942a
2022-06-30 10:46:22,187 [Listener at 0.0.0.0/43687] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=91f8755a-a8ad-43c4-a78a-0f0d5c2239bc to datanode:bdb85e00-2c14-4dd4-9f23-5c4072330f07
2022-06-30 10:46:22,188 [Listener at 0.0.0.0/43687] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=91f8755a-a8ad-43c4-a78a-0f0d5c2239bc to datanode:3d91e098-a2c0-4b5d-8d67-157e45ac98e9
2022-06-30 10:46:22,227 [Listener at 0.0.0.0/43687] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 91f8755a-a8ad-43c4-a78a-0f0d5c2239bc, Nodes: 4899e36a-708d-4b3d-8e89-fed0deb5942a{ip: 213.52.73.235, host: localhost-213.52.73.235, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}bdb85e00-2c14-4dd4-9f23-5c4072330f07{ip: 219.30.8.156, host: localhost-219.30.8.156, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}3d91e098-a2c0-4b5d-8d67-157e45ac98e9{ip: 120.191.232.111, host: localhost-120.191.232.111, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:22.183Z[Etc/UTC]].
2022-06-30 10:46:22,234 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: 91f8755a-a8ad-43c4-a78a-0f0d5c2239bc, Nodes: 4899e36a-708d-4b3d-8e89-fed0deb5942a{ip: 213.52.73.235, host: localhost-213.52.73.235, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}bdb85e00-2c14-4dd4-9f23-5c4072330f07{ip: 219.30.8.156, host: localhost-219.30.8.156, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}3d91e098-a2c0-4b5d-8d67-157e45ac98e9{ip: 120.191.232.111, host: localhost-120.191.232.111, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:22.183Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:22,237 [Listener at 0.0.0.0/43687] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=2160bf48-0942-4e7f-8500-3b880fa4785c to datanode:c5968184-c285-4a83-b0b6-cc5a187e9f9f
2022-06-30 10:46:22,237 [Listener at 0.0.0.0/43687] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=2160bf48-0942-4e7f-8500-3b880fa4785c to datanode:283b220c-eff4-4f14-a2be-f1a9a2072d20
2022-06-30 10:46:22,237 [Listener at 0.0.0.0/43687] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=2160bf48-0942-4e7f-8500-3b880fa4785c to datanode:56f2344f-8f80-49ac-9a06-5866005b58bc
2022-06-30 10:46:22,238 [Listener at 0.0.0.0/43687] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 2160bf48-0942-4e7f-8500-3b880fa4785c, Nodes: c5968184-c285-4a83-b0b6-cc5a187e9f9f{ip: 152.250.80.66, host: localhost-152.250.80.66, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}283b220c-eff4-4f14-a2be-f1a9a2072d20{ip: 52.187.180.78, host: localhost-52.187.180.78, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}56f2344f-8f80-49ac-9a06-5866005b58bc{ip: 219.234.176.6, host: localhost-219.234.176.6, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:22.237Z[Etc/UTC]].
2022-06-30 10:46:22,239 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: 2160bf48-0942-4e7f-8500-3b880fa4785c, Nodes: c5968184-c285-4a83-b0b6-cc5a187e9f9f{ip: 152.250.80.66, host: localhost-152.250.80.66, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}283b220c-eff4-4f14-a2be-f1a9a2072d20{ip: 52.187.180.78, host: localhost-52.187.180.78, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}56f2344f-8f80-49ac-9a06-5866005b58bc{ip: 219.234.176.6, host: localhost-219.234.176.6, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:22.237Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:22,255 [Listener at 0.0.0.0/43687] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-06-30 10:46:22,264 [Listener at 0.0.0.0/43687] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-06-30 10:46:22,265 [Listener at 0.0.0.0/43687] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-06-30 10:46:22,332 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(70)) - Close container Event triggered for container : #1
2022-06-30 10:46:22,337 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(70)) - Close container Event triggered for container : #2
2022-06-30 10:46:22,338 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(70)) - Close container Event triggered for container : #4
2022-06-30 10:46:22,338 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(70)) - Close container Event triggered for container : #3
2022-06-30 10:46:22,339 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(70)) - Close container Event triggered for container : #5
2022-06-30 10:46:22,339 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(70)) - Close container Event triggered for container : #6
2022-06-30 10:46:22,398 [Listener at 0.0.0.0/43687] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1514)) - Container Balancer is not running.
2022-06-30 10:46:22,399 [Listener at 0.0.0.0/43687] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1521)) - Stopping Replication Manager Service.
2022-06-30 10:46:22,399 [Listener at 0.0.0.0/43687] INFO  replication.ReplicationManager (ReplicationManager.java:stop(211)) - Stopping Replication Monitor Thread.
2022-06-30 10:46:22,401 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(321)) - Replication Monitor Thread is stopped
2022-06-30 10:46:22,401 [Listener at 0.0.0.0/43687] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1528)) - Stopping the Datanode Admin Monitor.
2022-06-30 10:46:22,402 [Listener at 0.0.0.0/43687] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1535)) - Stopping Lease Manager of the command watchers
2022-06-30 10:46:22,403 [Listener at 0.0.0.0/43687] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1538)) - Lease Manager of the command watchers stop failed
2022-06-30 10:46:22,403 [Listener at 0.0.0.0/43687] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1542)) - Stopping datanode service RPC server
2022-06-30 10:46:22,403 [Listener at 0.0.0.0/43687] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(408)) - Stopping the RPC server for DataNodes
2022-06-30 10:46:22,403 [Listener at 0.0.0.0/43687] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 39337
2022-06-30 10:46:22,404 [Listener at 0.0.0.0/43687] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1550)) - Stopping block service RPC server
2022-06-30 10:46:22,404 [Listener at 0.0.0.0/43687] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-06-30 10:46:22,404 [Listener at 0.0.0.0/43687] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 38155
2022-06-30 10:46:22,405 [Listener at 0.0.0.0/43687] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1557)) - Stopping the StorageContainerLocationProtocol RPC server
2022-06-30 10:46:22,405 [Listener at 0.0.0.0/43687] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(178)) - Stopping the RPC server for Client Protocol
2022-06-30 10:46:22,405 [Listener at 0.0.0.0/43687] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 43687
2022-06-30 10:46:22,405 [Listener at 0.0.0.0/43687] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1564)) - Stopping Storage Container Manager HTTP server.
2022-06-30 10:46:22,406 [Listener at 0.0.0.0/43687] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1567)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1565)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:195)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptAfterEachMethod(TimeoutExtension.java:108)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeAfterEachMethodAdapter$22(ClassBasedTestDescriptor.java:496)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAfterEachMethods$10(TestMethodTestDescriptor.java:240)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$13(TestMethodTestDescriptor.java:273)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$14(TestMethodTestDescriptor.java:273)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAllAfterMethodsOrCallbacks(TestMethodTestDescriptor.java:272)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAfterEachMethods(TestMethodTestDescriptor.java:238)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-06-30 10:46:22,413 [Listener at 0.0.0.0/43687] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1575)) - Stopping Block Manager Service.
2022-06-30 10:46:22,413 [Listener at 0.0.0.0/43687] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:22,413 [Listener at 0.0.0.0/43687] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:22,414 [Listener at 0.0.0.0/43687] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1602)) - Stopping SCM Event Queue.
2022-06-30 10:46:22,418 [Listener at 0.0.0.0/43687] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1613)) - Stopping SCM HA services.
2022-06-30 10:46:22,418 [Listener at 0.0.0.0/43687] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2022-06-30 10:46:22,419 [RatisPipelineUtilsThread - 0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(179)) - RatisPipelineUtilsThread is interrupted.
2022-06-30 10:46:22,421 [Listener at 0.0.0.0/43687] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(126)) - Stopping BackgroundPipelineScrubber Service.
2022-06-30 10:46:22,421 [BackgroundPipelineScrubberThread] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(110)) - BackgroundPipelineScrubber is interrupted, exit
2022-06-30 10:46:22,422 [Listener at 0.0.0.0/43687] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1623)) - Stopping SCM MetadataStore.
]]></system-out>
  </testcase>
  <testcase name="testMultipleBlockAllocation" classname="org.apache.hadoop.hdds.scm.block.TestBlockManager" time="1.393">
    <error type="java.util.concurrent.TimeoutException"><![CDATA[java.util.concurrent.TimeoutException: 
Timed out waiting for condition. Thread diagnostics:
Timestamp: 2022-06-30 10:46:23,820

"ReplicationMonitor" daemon prio=5 tid=38 timed_waiting
java.lang.Thread.State: TIMED_WAITING
        at java.lang.Object.wait(Native Method)
        at org.apache.hadoop.hdds.scm.container.replication.ReplicationManager.run(ReplicationManager.java:317)
        at org.apache.hadoop.hdds.scm.container.replication.ReplicationManager$$Lambda$370/1900971551.run(Unknown Source)
        at java.lang.Thread.run(Thread.java:750)
"ExpiredContainerReplicaOpScrubberThread" daemon prio=5 tid=37 timed_waiting
java.lang.Thread.State: TIMED_WAITING
        at java.lang.Object.wait(Native Method)
        at org.apache.hadoop.hdds.scm.ha.BackgroundSCMService.run(BackgroundSCMService.java:105)
        at org.apache.hadoop.hdds.scm.ha.BackgroundSCMService$$Lambda$351/848961421.run(Unknown Source)
        at java.lang.Thread.run(Thread.java:750)
"EventQueue-DatanodeCommandForDatanodeCommandHandler"  prio=5 tid=52 in Object.wait()
java.lang.Thread.State: WAITING (on object monitor)
        at sun.misc.Unsafe.park(Native Method)
        at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)
        at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
        at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
        at java.lang.Thread.run(Thread.java:750)
"IPC Server idle connection scanner for port 39167" daemon prio=5 tid=42 in Object.wait()
java.lang.Thread.State: WAITING (on object monitor)
        at java.lang.Object.wait(Native Method)
        at java.lang.Object.wait(Object.java:502)
        at java.util.TimerThread.mainLoop(Timer.java:526)
        at java.util.TimerThread.run(Timer.java:505)
"BackgroundPipelineScrubberThread" daemon prio=5 tid=36 timed_waiting
java.lang.Thread.State: TIMED_WAITING
        at java.lang.Object.wait(Native Method)
        at org.apache.hadoop.hdds.scm.ha.BackgroundSCMService.run(BackgroundSCMService.java:105)
        at org.apache.hadoop.hdds.scm.ha.BackgroundSCMService$$Lambda$351/848961421.run(Unknown Source)
        at java.lang.Thread.run(Thread.java:750)
"IPC Server idle connection scanner for port 43687" daemon prio=5 tid=30 in Object.wait()
java.lang.Thread.State: WAITING (on object monitor)
        at java.lang.Object.wait(Native Method)
        at java.lang.Object.wait(Object.java:502)
        at java.util.TimerThread.mainLoop(Timer.java:526)
        at java.util.TimerThread.run(Timer.java:505)
"surefire-forkedjvm-command-thread" daemon prio=5 tid=10 runnable
java.lang.Thread.State: RUNNABLE
        at java.io.FileInputStream.readBytes(Native Method)
        at java.io.FileInputStream.read(FileInputStream.java:255)
        at java.io.BufferedInputStream.read1(BufferedInputStream.java:284)
        at java.io.BufferedInputStream.read(BufferedInputStream.java:345)
        at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
        at java.io.BufferedInputStream.read1(BufferedInputStream.java:286)
        at java.io.BufferedInputStream.read(BufferedInputStream.java:345)
        at org.apache.maven.surefire.api.util.internal.Channels$3.readImpl(Channels.java:214)
        at org.apache.maven.surefire.api.util.internal.AbstractNoninterruptibleReadableChannel.read(AbstractNoninterruptibleReadableChannel.java:54)
        at org.apache.maven.surefire.booter.spi.LegacyMasterProcessChannelDecoder.decode(LegacyMasterProcessChannelDecoder.java:80)
        at org.apache.maven.surefire.booter.CommandReader$CommandRunnable.run(CommandReader.java:343)
        at java.lang.Thread.run(Thread.java:750)
"IPC Server idle connection scanner for port 38201" daemon prio=5 tid=46 in Object.wait()
java.lang.Thread.State: WAITING (on object monitor)
        at java.lang.Object.wait(Native Method)
        at java.lang.Object.wait(Object.java:502)
        at java.util.TimerThread.mainLoop(Timer.java:526)
        at java.util.TimerThread.run(Timer.java:505)
"Socket Reader #1 for port 0"  prio=5 tid=49 runnable
java.lang.Thread.State: RUNNABLE
        at sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)
        at sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:269)
        at sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:93)
        at sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:86)
        at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:97)
        at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:101)
        at org.apache.hadoop.ipc.Server$Listener$Reader.doRunLoop(Server.java:1288)
        at org.apache.hadoop.ipc.Server$Listener$Reader.run(Server.java:1267)
"junit-jupiter-timeout-watcher"  prio=10 tid=32 timed_waiting
java.lang.Thread.State: TIMED_WAITING
        at sun.misc.Unsafe.park(Native Method)
        at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078)
        at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1093)
        at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:809)
        at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
        at java.lang.Thread.run(Thread.java:750)
"ExpiredContainerReplicaOpScrubberThread" daemon prio=5 tid=16 timed_waiting
java.lang.Thread.State: TIMED_WAITING
        at java.lang.Object.wait(Native Method)
        at org.apache.hadoop.hdds.scm.ha.BackgroundSCMService.run(BackgroundSCMService.java:105)
        at org.apache.hadoop.hdds.scm.ha.BackgroundSCMService$$Lambda$351/848961421.run(Unknown Source)
        at java.lang.Thread.run(Thread.java:750)
"DatanodeAdminManager-0" daemon prio=5 tid=39 timed_waiting
java.lang.Thread.State: TIMED_WAITING
        at sun.misc.Unsafe.park(Native Method)
        at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078)
        at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1093)
        at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:809)
        at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
        at java.lang.Thread.run(Thread.java:750)
"Socket Reader #1 for port 0"  prio=5 tid=41 runnable
java.lang.Thread.State: RUNNABLE
        at sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)
        at sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:269)
        at sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:93)
        at sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:86)
        at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:97)
        at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:101)
        at org.apache.hadoop.ipc.Server$Listener$Reader.doRunLoop(Server.java:1288)
        at org.apache.hadoop.ipc.Server$Listener$Reader.run(Server.java:1267)
"process reaper" daemon prio=10 tid=12 timed_waiting
java.lang.Thread.State: TIMED_WAITING
        at sun.misc.Unsafe.park(Native Method)
        at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215)
        at java.util.concurrent.SynchronousQueue$TransferStack.awaitFulfill(SynchronousQueue.java:460)
        at java.util.concurrent.SynchronousQueue$TransferStack.transfer(SynchronousQueue.java:362)
        at java.util.concurrent.SynchronousQueue.poll(SynchronousQueue.java:941)
        at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
        at java.lang.Thread.run(Thread.java:750)
"Listener at 0.0.0.0/42617"  prio=5 tid=1 runnable
java.lang.Thread.State: RUNNABLE
        at java.lang.Thread.dumpThreads(Native Method)
        at java.lang.Thread.getAllStackTraces(Thread.java:1615)
        at org.apache.ozone.test.TimedOutTestsListener.buildThreadDump(TimedOutTestsListener.java:93)
        at org.apache.ozone.test.TimedOutTestsListener.buildThreadDiagnosticString(TimedOutTestsListener.java:79)
        at org.apache.ozone.test.GenericTestUtils.waitFor(GenericTestUtils.java:226)
        at org.apache.hadoop.hdds.scm.block.TestBlockManager.testMultipleBlockAllocation(TestBlockManager.java:510)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
        at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
        at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
        at org.junit.jupiter.engine.extension.TimeoutInvocation.proceed(TimeoutInvocation.java:46)
        at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
        at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
        at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
        at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor$$Lambda$130/989892772.apply(Unknown Source)
        at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
        at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall$$Lambda$131/1658699134.apply(Unknown Source)
        at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
        at org.junit.jupiter.engine.execution.ExecutableInvoker$$Lambda$286/519979933.apply(Unknown Source)
        at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
        at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
        at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
        at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
        at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
        at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
        at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:214)
        at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor$$Lambda$390/2126273510.execute(Unknown Source)
        at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
        at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:210)
        at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:135)
        at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask$$Lambda$227/1898155970.execute(Unknown Source)
        at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask$$Lambda$226/262445056.invoke(Unknown Source)
        at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask$$Lambda$225/1992550266.execute(Unknown Source)
        at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
        at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService$$Lambda$231/198499365.accept(Unknown Source)
        at java.util.ArrayList.forEach(ArrayList.java:1259)
        at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask$$Lambda$227/1898155970.execute(Unknown Source)
        at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask$$Lambda$226/262445056.invoke(Unknown Source)
        at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask$$Lambda$225/1992550266.execute(Unknown Source)
        at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
        at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService$$Lambda$231/198499365.accept(Unknown Source)
        at java.util.ArrayList.forEach(ArrayList.java:1259)
        at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask$$Lambda$227/1898155970.execute(Unknown Source)
        at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask$$Lambda$226/262445056.invoke(Unknown Source)
        at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask$$Lambda$225/1992550266.execute(Unknown Source)
        at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
        at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
        at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
        at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
        at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
        at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
        at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
        at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
        at org.junit.platform.launcher.core.EngineExecutionOrchestrator$$Lambda$179/1810899357.accept(Unknown Source)
        at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
        at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
        at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
        at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
        at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
        at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
        at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
        at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
        at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
        at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
        at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
        at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
        at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
"Socket Reader #1 for port 0"  prio=5 tid=45 runnable
java.lang.Thread.State: RUNNABLE
        at sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)
        at sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:269)
        at sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:93)
        at sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:86)
        at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:97)
        at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:101)
        at org.apache.hadoop.ipc.Server$Listener$Reader.doRunLoop(Server.java:1288)
        at org.apache.hadoop.ipc.Server$Listener$Reader.run(Server.java:1267)
"Finalizer" daemon prio=8 tid=3 in Object.wait()
java.lang.Thread.State: WAITING (on object monitor)
        at java.lang.Object.wait(Native Method)
        at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:144)
        at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:165)
        at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:216)
"IPC Server idle connection scanner for port 38155" daemon prio=5 tid=26 in Object.wait()
java.lang.Thread.State: WAITING (on object monitor)
        at java.lang.Object.wait(Native Method)
        at java.lang.Object.wait(Object.java:502)
        at java.util.TimerThread.mainLoop(Timer.java:526)
        at java.util.TimerThread.run(Timer.java:505)
"Reference Handler" daemon prio=10 tid=2 in Object.wait()
java.lang.Thread.State: WAITING (on object monitor)
        at java.lang.Object.wait(Native Method)
        at java.lang.Object.wait(Object.java:502)
        at java.lang.ref.Reference.tryHandlePending(Reference.java:191)
        at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:153)
"IPC Server idle connection scanner for port 39337" daemon prio=5 tid=22 in Object.wait()
java.lang.Thread.State: WAITING (on object monitor)
        at java.lang.Object.wait(Native Method)
        at java.lang.Object.wait(Object.java:502)
        at java.util.TimerThread.mainLoop(Timer.java:526)
        at java.util.TimerThread.run(Timer.java:505)
"RatisPipelineUtilsThread - 0"  prio=5 tid=35 timed_waiting
java.lang.Thread.State: TIMED_WAITING
        at java.lang.Object.wait(Native Method)
        at org.apache.hadoop.hdds.scm.pipeline.BackgroundPipelineCreator.run(BackgroundPipelineCreator.java:175)
        at org.apache.hadoop.hdds.scm.pipeline.BackgroundPipelineCreator$$Lambda$348/1905114489.run(Unknown Source)
        at java.lang.Thread.run(Thread.java:750)
"Signal Dispatcher" daemon prio=9 tid=4 runnable
java.lang.Thread.State: RUNNABLE
"IPC Server idle connection scanner for port 42617" daemon prio=5 tid=50 in Object.wait()
java.lang.Thread.State: WAITING (on object monitor)
        at java.lang.Object.wait(Native Method)
        at java.lang.Object.wait(Object.java:502)
        at java.util.TimerThread.mainLoop(Timer.java:526)
        at java.util.TimerThread.run(Timer.java:505)


	at org.apache.ozone.test.GenericTestUtils.waitFor(GenericTestUtils.java:226)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.testMultipleBlockAllocation(TestBlockManager.java:510)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutInvocation.proceed(TimeoutInvocation.java:46)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:214)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:210)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:135)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
]]></error>
    <system-out><![CDATA[2022-06-30 10:46:22,469 [Listener at 0.0.0.0/43687] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:22,469 [Listener at 0.0.0.0/43687] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:22,485 [Listener at 0.0.0.0/43687] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:22,486 [Listener at 0.0.0.0/43687] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:22,492 [Listener at 0.0.0.0/43687] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/dee3bd4e-2968-4b1d-a334-b17994e081c5
2022-06-30 10:46:22,495 [Listener at 0.0.0.0/43687] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/76d91b62-12c2-4cd1-a82c-e2d22cad96bf
2022-06-30 10:46:22,495 [Listener at 0.0.0.0/43687] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/4356dda8-f3ee-410f-8b0c-35a55d3eda3a
2022-06-30 10:46:22,495 [Listener at 0.0.0.0/43687] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/f108a371-09d0-43ff-9b7c-bdc8114f9ee8
2022-06-30 10:46:22,495 [Listener at 0.0.0.0/43687] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/1f9342d2-934d-4b2f-90cb-1359f465b0dd
2022-06-30 10:46:22,496 [Listener at 0.0.0.0/43687] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/b3297ab9-95d7-40cf-b167-df19a770802f
2022-06-30 10:46:22,549 [Listener at 0.0.0.0/43687] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/9eb06676-c0f5-4295-b0c6-b66f0ad53f8f
2022-06-30 10:46:22,549 [Listener at 0.0.0.0/43687] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/698e5e40-6734-4b81-bc4c-6c3eb72ea041
2022-06-30 10:46:22,550 [Listener at 0.0.0.0/43687] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/3bc34e57-2145-47dc-9703-3054ecca72be
2022-06-30 10:46:22,550 [Listener at 0.0.0.0/43687] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/dbc82436-3a35-48b1-954a-3ed8eb7b2244
2022-06-30 10:46:22,550 [Listener at 0.0.0.0/43687] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:22,551 [Listener at 0.0.0.0/43687] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:22,675 [Listener at 0.0.0.0/43687] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:22,675 [Listener at 0.0.0.0/43687] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-06-30 10:46:22,676 [Listener at 0.0.0.0/43687] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:22,677 [Listener at 0.0.0.0/43687] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2022-06-30 10:46:22,679 [Listener at 0.0.0.0/43687] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2022-06-30 10:46:22,680 [Listener at 0.0.0.0/43687] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(68)) - Starting BackgroundPipelineScrubber Service.
2022-06-30 10:46:22,681 [Listener at 0.0.0.0/43687] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-06-30 10:46:22,681 [Listener at 0.0.0.0/43687] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2022-06-30 10:46:22,681 [Listener at 0.0.0.0/43687] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:22,682 [Listener at 0.0.0.0/43687] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-06-30 10:46:22,683 [Listener at 0.0.0.0/43687] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-06-30 10:46:22,683 [Listener at 0.0.0.0/43687] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-06-30 10:46:22,683 [Listener at 0.0.0.0/43687] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:22,686 [Listener at 0.0.0.0/43687] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:22,687 [Listener at 0.0.0.0/43687] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(209)) - ServiceID for StorageContainerManager is null
2022-06-30 10:46:22,687 [Listener at 0.0.0.0/43687] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(214)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-06-30 10:46:22,688 [Listener at 0.0.0.0/43687] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:22,688 [Listener at 0.0.0.0/43687] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:22,690 [Listener at 0.0.0.0/43687] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(82)) - Initializing Layout version manager with metadata layout = DATANODE_SCHEMA_V3 (version = 4), software layout = DATANODE_SCHEMA_V3 (version = 4)
2022-06-30 10:46:22,690 [Listener at 0.0.0.0/43687] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:87)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.initializeSystemManagers(StorageContainerManager.java:587)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:371)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:536)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:644)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptBeforeEachMethod(TimeoutExtension.java:76)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeBeforeEachMethodAdapter$21(ClassBasedTestDescriptor.java:491)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeEachMethods$3(TestMethodTestDescriptor.java:171)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeMethodsOrCallbacksUntilExceptionOccurs$6(TestMethodTestDescriptor.java:199)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeMethodsOrCallbacksUntilExceptionOccurs(TestMethodTestDescriptor.java:199)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeEachMethods(TestMethodTestDescriptor.java:168)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 85 more
2022-06-30 10:46:22,744 [Listener at 0.0.0.0/43687] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 51 ms to scan 6 urls, producing 128 keys and 304 values 
2022-06-30 10:46:22,745 [Listener at 0.0.0.0/43687] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-06-30 10:46:22,746 [Listener at 0.0.0.0/43687] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-06-30 10:46:22,746 [Listener at 0.0.0.0/43687] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(374)) - upgrade containerId to 0
2022-06-30 10:46:22,746 [Listener at 0.0.0.0/43687] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:22,746 [Listener at 0.0.0.0/43687] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-06-30 10:46:22,747 [Listener at 0.0.0.0/43687] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(68)) - Starting ExpiredContainerReplicaOpScrubber Service.
2022-06-30 10:46:22,747 [Listener at 0.0.0.0/43687] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2022-06-30 10:46:22,747 [Listener at 0.0.0.0/43687] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-06-30 10:46:22,748 [Listener at 0.0.0.0/43687] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-06-30 10:46:22,748 [Listener at 0.0.0.0/43687] INFO  replication.ReplicationManager (ReplicationManager.java:start(178)) - Starting Replication Monitor Thread.
2022-06-30 10:46:22,749 [Listener at 0.0.0.0/43687] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-06-30 10:46:22,749 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(227)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-06-30 10:46:22,750 [Listener at 0.0.0.0/43687] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:22,754 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:22,755 [Listener at 0.0.0.0/39167] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:22,756 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:22,756 [Listener at 0.0.0.0/38201] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:22,757 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:22,795 [Listener at 0.0.0.0/42617] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2022-06-30 10:46:22,796 [Listener at 0.0.0.0/42617] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(401)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-06-30 10:46:22,797 [Listener at 0.0.0.0/42617] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(228)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-06-30 10:46:22,798 [Listener at 0.0.0.0/42617] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=347bb7c7-60a8-4d94-818d-21061dd78f4b to datanode:4356dda8-f3ee-410f-8b0c-35a55d3eda3a
2022-06-30 10:46:22,800 [Listener at 0.0.0.0/42617] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=347bb7c7-60a8-4d94-818d-21061dd78f4b to datanode:9eb06676-c0f5-4295-b0c6-b66f0ad53f8f
2022-06-30 10:46:22,800 [Listener at 0.0.0.0/42617] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=347bb7c7-60a8-4d94-818d-21061dd78f4b to datanode:f108a371-09d0-43ff-9b7c-bdc8114f9ee8
2022-06-30 10:46:22,801 [Listener at 0.0.0.0/42617] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 347bb7c7-60a8-4d94-818d-21061dd78f4b, Nodes: 4356dda8-f3ee-410f-8b0c-35a55d3eda3a{ip: 190.40.16.94, host: localhost-190.40.16.94, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}9eb06676-c0f5-4295-b0c6-b66f0ad53f8f{ip: 177.16.177.64, host: localhost-177.16.177.64, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}f108a371-09d0-43ff-9b7c-bdc8114f9ee8{ip: 99.235.78.166, host: localhost-99.235.78.166, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:22.798Z[Etc/UTC]].
2022-06-30 10:46:22,802 [Listener at 0.0.0.0/42617] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=ab9398ce-678c-4f89-846c-955020f3d397 to datanode:b3297ab9-95d7-40cf-b167-df19a770802f
2022-06-30 10:46:22,802 [Listener at 0.0.0.0/42617] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=ab9398ce-678c-4f89-846c-955020f3d397 to datanode:76d91b62-12c2-4cd1-a82c-e2d22cad96bf
2022-06-30 10:46:22,802 [Listener at 0.0.0.0/42617] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=ab9398ce-678c-4f89-846c-955020f3d397 to datanode:dee3bd4e-2968-4b1d-a334-b17994e081c5
2022-06-30 10:46:22,803 [Listener at 0.0.0.0/42617] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: ab9398ce-678c-4f89-846c-955020f3d397, Nodes: b3297ab9-95d7-40cf-b167-df19a770802f{ip: 189.197.156.183, host: localhost-189.197.156.183, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}76d91b62-12c2-4cd1-a82c-e2d22cad96bf{ip: 201.233.254.230, host: localhost-201.233.254.230, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}dee3bd4e-2968-4b1d-a334-b17994e081c5{ip: 51.157.172.167, host: localhost-51.157.172.167, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:22.802Z[Etc/UTC]].
2022-06-30 10:46:22,804 [Listener at 0.0.0.0/42617] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: ab9398ce-678c-4f89-846c-955020f3d397, Nodes: b3297ab9-95d7-40cf-b167-df19a770802f{ip: 189.197.156.183, host: localhost-189.197.156.183, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}76d91b62-12c2-4cd1-a82c-e2d22cad96bf{ip: 201.233.254.230, host: localhost-201.233.254.230, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}dee3bd4e-2968-4b1d-a334-b17994e081c5{ip: 51.157.172.167, host: localhost-51.157.172.167, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:22.802Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:22,804 [Listener at 0.0.0.0/42617] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: 347bb7c7-60a8-4d94-818d-21061dd78f4b, Nodes: 4356dda8-f3ee-410f-8b0c-35a55d3eda3a{ip: 190.40.16.94, host: localhost-190.40.16.94, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}9eb06676-c0f5-4295-b0c6-b66f0ad53f8f{ip: 177.16.177.64, host: localhost-177.16.177.64, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}f108a371-09d0-43ff-9b7c-bdc8114f9ee8{ip: 99.235.78.166, host: localhost-99.235.78.166, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:22.798Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:22,805 [Listener at 0.0.0.0/42617] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-06-30 10:46:22,806 [Listener at 0.0.0.0/42617] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-06-30 10:46:22,806 [Listener at 0.0.0.0/42617] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-06-30 10:46:23,825 [Listener at 0.0.0.0/42617] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1514)) - Container Balancer is not running.
2022-06-30 10:46:23,825 [Listener at 0.0.0.0/42617] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1521)) - Stopping Replication Manager Service.
2022-06-30 10:46:23,825 [Listener at 0.0.0.0/42617] INFO  replication.ReplicationManager (ReplicationManager.java:stop(211)) - Stopping Replication Monitor Thread.
2022-06-30 10:46:23,825 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(321)) - Replication Monitor Thread is stopped
2022-06-30 10:46:23,825 [Listener at 0.0.0.0/42617] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1528)) - Stopping the Datanode Admin Monitor.
2022-06-30 10:46:23,826 [Listener at 0.0.0.0/42617] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1535)) - Stopping Lease Manager of the command watchers
2022-06-30 10:46:23,826 [Listener at 0.0.0.0/42617] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1538)) - Lease Manager of the command watchers stop failed
2022-06-30 10:46:23,826 [Listener at 0.0.0.0/42617] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1542)) - Stopping datanode service RPC server
2022-06-30 10:46:23,826 [Listener at 0.0.0.0/42617] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(408)) - Stopping the RPC server for DataNodes
2022-06-30 10:46:23,826 [Listener at 0.0.0.0/42617] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 39167
2022-06-30 10:46:23,826 [Listener at 0.0.0.0/42617] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1550)) - Stopping block service RPC server
2022-06-30 10:46:23,827 [Listener at 0.0.0.0/42617] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-06-30 10:46:23,827 [Listener at 0.0.0.0/42617] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 38201
2022-06-30 10:46:23,827 [Listener at 0.0.0.0/42617] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1557)) - Stopping the StorageContainerLocationProtocol RPC server
2022-06-30 10:46:23,827 [Listener at 0.0.0.0/42617] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(178)) - Stopping the RPC server for Client Protocol
2022-06-30 10:46:23,827 [Listener at 0.0.0.0/42617] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 42617
2022-06-30 10:46:23,828 [Listener at 0.0.0.0/42617] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1564)) - Stopping Storage Container Manager HTTP server.
2022-06-30 10:46:23,828 [Listener at 0.0.0.0/42617] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1567)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1565)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:195)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptAfterEachMethod(TimeoutExtension.java:108)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeAfterEachMethodAdapter$22(ClassBasedTestDescriptor.java:496)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAfterEachMethods$10(TestMethodTestDescriptor.java:240)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$13(TestMethodTestDescriptor.java:273)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$14(TestMethodTestDescriptor.java:273)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAllAfterMethodsOrCallbacks(TestMethodTestDescriptor.java:272)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAfterEachMethods(TestMethodTestDescriptor.java:238)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-06-30 10:46:23,829 [Listener at 0.0.0.0/42617] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1575)) - Stopping Block Manager Service.
2022-06-30 10:46:23,829 [Listener at 0.0.0.0/42617] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:23,829 [Listener at 0.0.0.0/42617] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:23,829 [Listener at 0.0.0.0/42617] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1602)) - Stopping SCM Event Queue.
2022-06-30 10:46:23,829 [Listener at 0.0.0.0/42617] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1613)) - Stopping SCM HA services.
2022-06-30 10:46:23,830 [Listener at 0.0.0.0/42617] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2022-06-30 10:46:23,830 [RatisPipelineUtilsThread - 0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(179)) - RatisPipelineUtilsThread is interrupted.
2022-06-30 10:46:23,832 [Listener at 0.0.0.0/42617] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(126)) - Stopping BackgroundPipelineScrubber Service.
2022-06-30 10:46:23,832 [BackgroundPipelineScrubberThread] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(110)) - BackgroundPipelineScrubber is interrupted, exit
2022-06-30 10:46:23,832 [Listener at 0.0.0.0/42617] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1623)) - Stopping SCM MetadataStore.
]]></system-out>
  </testcase>
  <testcase name="testAllocateBlockWithExclusion" classname="org.apache.hadoop.hdds.scm.block.TestBlockManager" time="0.29">
    <system-out><![CDATA[2022-06-30 10:46:23,869 [Listener at 0.0.0.0/42617] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:23,869 [Listener at 0.0.0.0/42617] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:23,885 [Listener at 0.0.0.0/42617] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:23,885 [Listener at 0.0.0.0/42617] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:23,887 [Listener at 0.0.0.0/42617] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/b66ff138-6edb-4fb0-b543-8f6556dbe0ad
2022-06-30 10:46:23,887 [Listener at 0.0.0.0/42617] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/b66fca59-dc52-4932-b506-ab8c55d2f324
2022-06-30 10:46:23,887 [Listener at 0.0.0.0/42617] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/0c1988a6-3b6b-446c-9129-93d25fb58ef9
2022-06-30 10:46:23,888 [Listener at 0.0.0.0/42617] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/fa16fbfa-26af-4c13-a9f1-a314e606841b
2022-06-30 10:46:23,888 [Listener at 0.0.0.0/42617] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/2ffa728f-d7b1-4de9-a1c2-fcc234bdbb4a
2022-06-30 10:46:23,888 [Listener at 0.0.0.0/42617] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/ab428d71-a376-49d6-9f07-0f0cabcda0ae
2022-06-30 10:46:23,888 [Listener at 0.0.0.0/42617] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/0ea17ade-7e5b-4a85-ab98-e2755f4e4462
2022-06-30 10:46:23,888 [Listener at 0.0.0.0/42617] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/f43c521b-0f31-43b1-a2e2-91869d281ebb
2022-06-30 10:46:23,889 [Listener at 0.0.0.0/42617] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/12cd72a1-dbee-4902-95ce-84b8312ce98a
2022-06-30 10:46:23,889 [Listener at 0.0.0.0/42617] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/26b3544d-31ba-4802-b23c-8d0add8fd8cc
2022-06-30 10:46:23,889 [Listener at 0.0.0.0/42617] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:23,890 [Listener at 0.0.0.0/42617] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:23,994 [Listener at 0.0.0.0/42617] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:23,994 [Listener at 0.0.0.0/42617] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-06-30 10:46:23,995 [Listener at 0.0.0.0/42617] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:23,999 [Listener at 0.0.0.0/42617] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2022-06-30 10:46:23,999 [Listener at 0.0.0.0/42617] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2022-06-30 10:46:24,006 [Listener at 0.0.0.0/42617] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(68)) - Starting BackgroundPipelineScrubber Service.
2022-06-30 10:46:24,007 [Listener at 0.0.0.0/42617] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-06-30 10:46:24,007 [Listener at 0.0.0.0/42617] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2022-06-30 10:46:24,007 [Listener at 0.0.0.0/42617] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:24,008 [Listener at 0.0.0.0/42617] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-06-30 10:46:24,008 [Listener at 0.0.0.0/42617] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-06-30 10:46:24,009 [Listener at 0.0.0.0/42617] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-06-30 10:46:24,009 [Listener at 0.0.0.0/42617] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:24,014 [Listener at 0.0.0.0/42617] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:24,014 [Listener at 0.0.0.0/42617] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(209)) - ServiceID for StorageContainerManager is null
2022-06-30 10:46:24,014 [Listener at 0.0.0.0/42617] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(214)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-06-30 10:46:24,015 [Listener at 0.0.0.0/42617] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:24,016 [Listener at 0.0.0.0/42617] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:24,017 [Listener at 0.0.0.0/42617] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(82)) - Initializing Layout version manager with metadata layout = DATANODE_SCHEMA_V3 (version = 4), software layout = DATANODE_SCHEMA_V3 (version = 4)
2022-06-30 10:46:24,017 [Listener at 0.0.0.0/42617] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:87)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.initializeSystemManagers(StorageContainerManager.java:587)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:371)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:536)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:644)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptBeforeEachMethod(TimeoutExtension.java:76)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeBeforeEachMethodAdapter$21(ClassBasedTestDescriptor.java:491)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeEachMethods$3(TestMethodTestDescriptor.java:171)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeMethodsOrCallbacksUntilExceptionOccurs$6(TestMethodTestDescriptor.java:199)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeMethodsOrCallbacksUntilExceptionOccurs(TestMethodTestDescriptor.java:199)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeEachMethods(TestMethodTestDescriptor.java:168)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 85 more
2022-06-30 10:46:24,052 [Listener at 0.0.0.0/42617] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 33 ms to scan 6 urls, producing 128 keys and 304 values 
2022-06-30 10:46:24,054 [Listener at 0.0.0.0/42617] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-06-30 10:46:24,054 [Listener at 0.0.0.0/42617] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-06-30 10:46:24,055 [Listener at 0.0.0.0/42617] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(374)) - upgrade containerId to 0
2022-06-30 10:46:24,055 [Listener at 0.0.0.0/42617] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:24,055 [Listener at 0.0.0.0/42617] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-06-30 10:46:24,055 [Listener at 0.0.0.0/42617] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(68)) - Starting ExpiredContainerReplicaOpScrubber Service.
2022-06-30 10:46:24,055 [Listener at 0.0.0.0/42617] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2022-06-30 10:46:24,055 [Listener at 0.0.0.0/42617] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-06-30 10:46:24,056 [Listener at 0.0.0.0/42617] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-06-30 10:46:24,057 [Listener at 0.0.0.0/42617] INFO  replication.ReplicationManager (ReplicationManager.java:start(178)) - Starting Replication Monitor Thread.
2022-06-30 10:46:24,057 [Listener at 0.0.0.0/42617] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-06-30 10:46:24,058 [Listener at 0.0.0.0/42617] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:24,058 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:24,062 [Listener at 0.0.0.0/42623] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:24,063 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(227)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-06-30 10:46:24,063 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:24,064 [Listener at 0.0.0.0/35539] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:24,066 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:24,079 [Listener at 0.0.0.0/34541] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2022-06-30 10:46:24,079 [Listener at 0.0.0.0/34541] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(401)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-06-30 10:46:24,080 [Listener at 0.0.0.0/34541] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(228)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-06-30 10:46:24,082 [Listener at 0.0.0.0/34541] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=5a76d16c-3aa7-4159-87e9-e35c59708d5b to datanode:ab428d71-a376-49d6-9f07-0f0cabcda0ae
2022-06-30 10:46:24,086 [Listener at 0.0.0.0/34541] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=5a76d16c-3aa7-4159-87e9-e35c59708d5b to datanode:b66ff138-6edb-4fb0-b543-8f6556dbe0ad
2022-06-30 10:46:24,086 [Listener at 0.0.0.0/34541] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=5a76d16c-3aa7-4159-87e9-e35c59708d5b to datanode:b66fca59-dc52-4932-b506-ab8c55d2f324
2022-06-30 10:46:24,087 [Listener at 0.0.0.0/34541] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 5a76d16c-3aa7-4159-87e9-e35c59708d5b, Nodes: ab428d71-a376-49d6-9f07-0f0cabcda0ae{ip: 107.244.135.112, host: localhost-107.244.135.112, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b66ff138-6edb-4fb0-b543-8f6556dbe0ad{ip: 205.156.149.102, host: localhost-205.156.149.102, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b66fca59-dc52-4932-b506-ab8c55d2f324{ip: 191.210.198.176, host: localhost-191.210.198.176, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.082Z[Etc/UTC]].
2022-06-30 10:46:24,089 [Listener at 0.0.0.0/34541] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=1f09b971-beda-4e45-a3df-24a6b6ccf705 to datanode:2ffa728f-d7b1-4de9-a1c2-fcc234bdbb4a
2022-06-30 10:46:24,089 [Listener at 0.0.0.0/34541] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=1f09b971-beda-4e45-a3df-24a6b6ccf705 to datanode:f43c521b-0f31-43b1-a2e2-91869d281ebb
2022-06-30 10:46:24,089 [Listener at 0.0.0.0/34541] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=1f09b971-beda-4e45-a3df-24a6b6ccf705 to datanode:b66ff138-6edb-4fb0-b543-8f6556dbe0ad
2022-06-30 10:46:24,091 [Listener at 0.0.0.0/34541] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 1f09b971-beda-4e45-a3df-24a6b6ccf705, Nodes: 2ffa728f-d7b1-4de9-a1c2-fcc234bdbb4a{ip: 52.191.195.39, host: localhost-52.191.195.39, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}f43c521b-0f31-43b1-a2e2-91869d281ebb{ip: 114.81.36.131, host: localhost-114.81.36.131, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b66ff138-6edb-4fb0-b543-8f6556dbe0ad{ip: 205.156.149.102, host: localhost-205.156.149.102, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.089Z[Etc/UTC]].
2022-06-30 10:46:24,093 [Listener at 0.0.0.0/34541] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=a2b3c73a-08b4-436a-a2a4-10d6c69512fc to datanode:f43c521b-0f31-43b1-a2e2-91869d281ebb
2022-06-30 10:46:24,093 [Listener at 0.0.0.0/34541] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=a2b3c73a-08b4-436a-a2a4-10d6c69512fc to datanode:b66fca59-dc52-4932-b506-ab8c55d2f324
2022-06-30 10:46:24,093 [Listener at 0.0.0.0/34541] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=a2b3c73a-08b4-436a-a2a4-10d6c69512fc to datanode:0c1988a6-3b6b-446c-9129-93d25fb58ef9
2022-06-30 10:46:24,094 [Listener at 0.0.0.0/34541] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: a2b3c73a-08b4-436a-a2a4-10d6c69512fc, Nodes: f43c521b-0f31-43b1-a2e2-91869d281ebb{ip: 114.81.36.131, host: localhost-114.81.36.131, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b66fca59-dc52-4932-b506-ab8c55d2f324{ip: 191.210.198.176, host: localhost-191.210.198.176, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}0c1988a6-3b6b-446c-9129-93d25fb58ef9{ip: 174.78.63.188, host: localhost-174.78.63.188, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.093Z[Etc/UTC]].
2022-06-30 10:46:24,095 [Listener at 0.0.0.0/34541] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=ac019718-23fb-4aeb-9f63-ffeec4a14589 to datanode:0c1988a6-3b6b-446c-9129-93d25fb58ef9
2022-06-30 10:46:24,095 [Listener at 0.0.0.0/34541] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=ac019718-23fb-4aeb-9f63-ffeec4a14589 to datanode:ab428d71-a376-49d6-9f07-0f0cabcda0ae
2022-06-30 10:46:24,095 [Listener at 0.0.0.0/34541] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=ac019718-23fb-4aeb-9f63-ffeec4a14589 to datanode:2ffa728f-d7b1-4de9-a1c2-fcc234bdbb4a
2022-06-30 10:46:24,096 [Listener at 0.0.0.0/34541] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: ac019718-23fb-4aeb-9f63-ffeec4a14589, Nodes: 0c1988a6-3b6b-446c-9129-93d25fb58ef9{ip: 174.78.63.188, host: localhost-174.78.63.188, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}ab428d71-a376-49d6-9f07-0f0cabcda0ae{ip: 107.244.135.112, host: localhost-107.244.135.112, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}2ffa728f-d7b1-4de9-a1c2-fcc234bdbb4a{ip: 52.191.195.39, host: localhost-52.191.195.39, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.095Z[Etc/UTC]].
2022-06-30 10:46:24,098 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: 5a76d16c-3aa7-4159-87e9-e35c59708d5b, Nodes: ab428d71-a376-49d6-9f07-0f0cabcda0ae{ip: 107.244.135.112, host: localhost-107.244.135.112, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b66ff138-6edb-4fb0-b543-8f6556dbe0ad{ip: 205.156.149.102, host: localhost-205.156.149.102, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b66fca59-dc52-4932-b506-ab8c55d2f324{ip: 191.210.198.176, host: localhost-191.210.198.176, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.082Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:24,099 [Listener at 0.0.0.0/34541] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: 1f09b971-beda-4e45-a3df-24a6b6ccf705, Nodes: 2ffa728f-d7b1-4de9-a1c2-fcc234bdbb4a{ip: 52.191.195.39, host: localhost-52.191.195.39, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}f43c521b-0f31-43b1-a2e2-91869d281ebb{ip: 114.81.36.131, host: localhost-114.81.36.131, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b66ff138-6edb-4fb0-b543-8f6556dbe0ad{ip: 205.156.149.102, host: localhost-205.156.149.102, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.089Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:24,100 [Listener at 0.0.0.0/34541] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: a2b3c73a-08b4-436a-a2a4-10d6c69512fc, Nodes: f43c521b-0f31-43b1-a2e2-91869d281ebb{ip: 114.81.36.131, host: localhost-114.81.36.131, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b66fca59-dc52-4932-b506-ab8c55d2f324{ip: 191.210.198.176, host: localhost-191.210.198.176, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}0c1988a6-3b6b-446c-9129-93d25fb58ef9{ip: 174.78.63.188, host: localhost-174.78.63.188, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.093Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:24,101 [Listener at 0.0.0.0/34541] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: ac019718-23fb-4aeb-9f63-ffeec4a14589, Nodes: 0c1988a6-3b6b-446c-9129-93d25fb58ef9{ip: 174.78.63.188, host: localhost-174.78.63.188, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}ab428d71-a376-49d6-9f07-0f0cabcda0ae{ip: 107.244.135.112, host: localhost-107.244.135.112, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}2ffa728f-d7b1-4de9-a1c2-fcc234bdbb4a{ip: 52.191.195.39, host: localhost-52.191.195.39, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.095Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:24,107 [Listener at 0.0.0.0/34541] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-06-30 10:46:24,108 [Listener at 0.0.0.0/34541] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-06-30 10:46:24,108 [Listener at 0.0.0.0/34541] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-06-30 10:46:24,115 [Listener at 0.0.0.0/34541] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1514)) - Container Balancer is not running.
2022-06-30 10:46:24,115 [Listener at 0.0.0.0/34541] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1521)) - Stopping Replication Manager Service.
2022-06-30 10:46:24,115 [Listener at 0.0.0.0/34541] INFO  replication.ReplicationManager (ReplicationManager.java:stop(211)) - Stopping Replication Monitor Thread.
2022-06-30 10:46:24,115 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(321)) - Replication Monitor Thread is stopped
2022-06-30 10:46:24,115 [Listener at 0.0.0.0/34541] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1528)) - Stopping the Datanode Admin Monitor.
2022-06-30 10:46:24,116 [Listener at 0.0.0.0/34541] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1535)) - Stopping Lease Manager of the command watchers
2022-06-30 10:46:24,116 [Listener at 0.0.0.0/34541] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1538)) - Lease Manager of the command watchers stop failed
2022-06-30 10:46:24,116 [Listener at 0.0.0.0/34541] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1542)) - Stopping datanode service RPC server
2022-06-30 10:46:24,117 [Listener at 0.0.0.0/34541] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(408)) - Stopping the RPC server for DataNodes
2022-06-30 10:46:24,117 [Listener at 0.0.0.0/34541] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 42623
2022-06-30 10:46:24,118 [Listener at 0.0.0.0/34541] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1550)) - Stopping block service RPC server
2022-06-30 10:46:24,118 [Listener at 0.0.0.0/34541] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-06-30 10:46:24,118 [Listener at 0.0.0.0/34541] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 35539
2022-06-30 10:46:24,118 [Listener at 0.0.0.0/34541] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1557)) - Stopping the StorageContainerLocationProtocol RPC server
2022-06-30 10:46:24,118 [Listener at 0.0.0.0/34541] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(178)) - Stopping the RPC server for Client Protocol
2022-06-30 10:46:24,118 [Listener at 0.0.0.0/34541] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 34541
2022-06-30 10:46:24,119 [Listener at 0.0.0.0/34541] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1564)) - Stopping Storage Container Manager HTTP server.
2022-06-30 10:46:24,119 [Listener at 0.0.0.0/34541] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1567)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1565)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:195)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptAfterEachMethod(TimeoutExtension.java:108)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeAfterEachMethodAdapter$22(ClassBasedTestDescriptor.java:496)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAfterEachMethods$10(TestMethodTestDescriptor.java:240)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$13(TestMethodTestDescriptor.java:273)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$14(TestMethodTestDescriptor.java:273)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAllAfterMethodsOrCallbacks(TestMethodTestDescriptor.java:272)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAfterEachMethods(TestMethodTestDescriptor.java:238)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-06-30 10:46:24,126 [Listener at 0.0.0.0/34541] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1575)) - Stopping Block Manager Service.
2022-06-30 10:46:24,126 [Listener at 0.0.0.0/34541] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:24,126 [Listener at 0.0.0.0/34541] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:24,126 [Listener at 0.0.0.0/34541] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1602)) - Stopping SCM Event Queue.
2022-06-30 10:46:24,128 [Listener at 0.0.0.0/34541] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1613)) - Stopping SCM HA services.
2022-06-30 10:46:24,128 [Listener at 0.0.0.0/34541] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2022-06-30 10:46:24,128 [RatisPipelineUtilsThread - 0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(179)) - RatisPipelineUtilsThread is interrupted.
2022-06-30 10:46:24,128 [Listener at 0.0.0.0/34541] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(126)) - Stopping BackgroundPipelineScrubber Service.
2022-06-30 10:46:24,128 [BackgroundPipelineScrubberThread] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(110)) - BackgroundPipelineScrubber is interrupted, exit
2022-06-30 10:46:24,130 [Listener at 0.0.0.0/34541] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1623)) - Stopping SCM MetadataStore.
]]></system-out>
  </testcase>
  <testcase name="testBlockDistributionWithMultipleRaftLogDisks" classname="org.apache.hadoop.hdds.scm.block.TestBlockManager" time="0.292">
    <system-out><![CDATA[2022-06-30 10:46:24,157 [Listener at 0.0.0.0/34541] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:24,157 [Listener at 0.0.0.0/34541] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:24,168 [Listener at 0.0.0.0/34541] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:24,168 [Listener at 0.0.0.0/34541] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:24,169 [Listener at 0.0.0.0/34541] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/5fb87827-fc2d-437b-b2ab-6835d85d017e
2022-06-30 10:46:24,170 [Listener at 0.0.0.0/34541] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/ed80f174-89e4-43d6-8cc7-4210666d8c61
2022-06-30 10:46:24,170 [Listener at 0.0.0.0/34541] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/c7e5c96c-5c71-44bc-9cf5-7a6b280645b3
2022-06-30 10:46:24,170 [Listener at 0.0.0.0/34541] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/565b009a-a19a-49eb-9548-16ce0ec460cf
2022-06-30 10:46:24,170 [Listener at 0.0.0.0/34541] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/3befa2f1-98e0-4266-95d7-5ae68d0ae711
2022-06-30 10:46:24,170 [Listener at 0.0.0.0/34541] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/20149500-545f-4460-b12d-f39a3759df96
2022-06-30 10:46:24,171 [Listener at 0.0.0.0/34541] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/a92a636b-acce-41ee-bfb9-fb4b7c0688ff
2022-06-30 10:46:24,171 [Listener at 0.0.0.0/34541] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/bc9f0d42-26f9-4d99-9dcd-6a29f9bad129
2022-06-30 10:46:24,171 [Listener at 0.0.0.0/34541] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/26a9706d-8b77-4bce-8394-3cf51fb375f8
2022-06-30 10:46:24,171 [Listener at 0.0.0.0/34541] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/bac4a529-04af-4dd2-bbf9-055d0800b1e3
2022-06-30 10:46:24,171 [Listener at 0.0.0.0/34541] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:24,172 [Listener at 0.0.0.0/34541] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:24,300 [Listener at 0.0.0.0/34541] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:24,300 [Listener at 0.0.0.0/34541] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-06-30 10:46:24,300 [Listener at 0.0.0.0/34541] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:24,300 [Listener at 0.0.0.0/34541] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2022-06-30 10:46:24,301 [Listener at 0.0.0.0/34541] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2022-06-30 10:46:24,301 [Listener at 0.0.0.0/34541] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(68)) - Starting BackgroundPipelineScrubber Service.
2022-06-30 10:46:24,302 [Listener at 0.0.0.0/34541] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-06-30 10:46:24,302 [Listener at 0.0.0.0/34541] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2022-06-30 10:46:24,302 [Listener at 0.0.0.0/34541] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:24,304 [Listener at 0.0.0.0/34541] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-06-30 10:46:24,305 [Listener at 0.0.0.0/34541] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-06-30 10:46:24,305 [Listener at 0.0.0.0/34541] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-06-30 10:46:24,305 [Listener at 0.0.0.0/34541] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:24,307 [Listener at 0.0.0.0/34541] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:24,307 [Listener at 0.0.0.0/34541] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(209)) - ServiceID for StorageContainerManager is null
2022-06-30 10:46:24,307 [Listener at 0.0.0.0/34541] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(214)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-06-30 10:46:24,310 [Listener at 0.0.0.0/34541] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:24,311 [Listener at 0.0.0.0/34541] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:24,312 [Listener at 0.0.0.0/34541] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(82)) - Initializing Layout version manager with metadata layout = DATANODE_SCHEMA_V3 (version = 4), software layout = DATANODE_SCHEMA_V3 (version = 4)
2022-06-30 10:46:24,312 [Listener at 0.0.0.0/34541] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:87)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.initializeSystemManagers(StorageContainerManager.java:587)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:371)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:536)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:644)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptBeforeEachMethod(TimeoutExtension.java:76)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeBeforeEachMethodAdapter$21(ClassBasedTestDescriptor.java:491)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeEachMethods$3(TestMethodTestDescriptor.java:171)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeMethodsOrCallbacksUntilExceptionOccurs$6(TestMethodTestDescriptor.java:199)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeMethodsOrCallbacksUntilExceptionOccurs(TestMethodTestDescriptor.java:199)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeEachMethods(TestMethodTestDescriptor.java:168)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 85 more
2022-06-30 10:46:24,346 [Listener at 0.0.0.0/34541] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 32 ms to scan 6 urls, producing 128 keys and 304 values 
2022-06-30 10:46:24,348 [Listener at 0.0.0.0/34541] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-06-30 10:46:24,348 [Listener at 0.0.0.0/34541] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-06-30 10:46:24,349 [Listener at 0.0.0.0/34541] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(374)) - upgrade containerId to 0
2022-06-30 10:46:24,349 [Listener at 0.0.0.0/34541] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:24,349 [Listener at 0.0.0.0/34541] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-06-30 10:46:24,349 [Listener at 0.0.0.0/34541] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(68)) - Starting ExpiredContainerReplicaOpScrubber Service.
2022-06-30 10:46:24,352 [Listener at 0.0.0.0/34541] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2022-06-30 10:46:24,353 [Listener at 0.0.0.0/34541] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-06-30 10:46:24,353 [Listener at 0.0.0.0/34541] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-06-30 10:46:24,354 [Listener at 0.0.0.0/34541] INFO  replication.ReplicationManager (ReplicationManager.java:start(178)) - Starting Replication Monitor Thread.
2022-06-30 10:46:24,354 [Listener at 0.0.0.0/34541] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-06-30 10:46:24,355 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(227)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-06-30 10:46:24,355 [Listener at 0.0.0.0/34541] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:24,356 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:24,359 [Listener at 0.0.0.0/33841] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:24,361 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:24,362 [Listener at 0.0.0.0/37119] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:24,369 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:24,383 [Listener at 0.0.0.0/45295] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2022-06-30 10:46:24,383 [Listener at 0.0.0.0/45295] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(401)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-06-30 10:46:24,384 [Listener at 0.0.0.0/45295] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(228)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-06-30 10:46:24,391 [Listener at 0.0.0.0/45295] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=128fba98-479a-44e4-94e1-e41c7abc1210 to datanode:c7e5c96c-5c71-44bc-9cf5-7a6b280645b3
2022-06-30 10:46:24,392 [Listener at 0.0.0.0/45295] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=128fba98-479a-44e4-94e1-e41c7abc1210 to datanode:3befa2f1-98e0-4266-95d7-5ae68d0ae711
2022-06-30 10:46:24,392 [Listener at 0.0.0.0/45295] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=128fba98-479a-44e4-94e1-e41c7abc1210 to datanode:20149500-545f-4460-b12d-f39a3759df96
2022-06-30 10:46:24,393 [Listener at 0.0.0.0/45295] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 128fba98-479a-44e4-94e1-e41c7abc1210, Nodes: c7e5c96c-5c71-44bc-9cf5-7a6b280645b3{ip: 49.17.173.6, host: localhost-49.17.173.6, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}3befa2f1-98e0-4266-95d7-5ae68d0ae711{ip: 21.217.127.169, host: localhost-21.217.127.169, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}20149500-545f-4460-b12d-f39a3759df96{ip: 61.191.51.176, host: localhost-61.191.51.176, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.391Z[Etc/UTC]].
2022-06-30 10:46:24,394 [Listener at 0.0.0.0/45295] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: 128fba98-479a-44e4-94e1-e41c7abc1210, Nodes: c7e5c96c-5c71-44bc-9cf5-7a6b280645b3{ip: 49.17.173.6, host: localhost-49.17.173.6, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}3befa2f1-98e0-4266-95d7-5ae68d0ae711{ip: 21.217.127.169, host: localhost-21.217.127.169, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}20149500-545f-4460-b12d-f39a3759df96{ip: 61.191.51.176, host: localhost-61.191.51.176, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.391Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:24,403 [pool-107-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-06-30 10:46:24,404 [pool-107-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-06-30 10:46:24,404 [pool-107-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-06-30 10:46:24,417 [Listener at 0.0.0.0/45295] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1514)) - Container Balancer is not running.
2022-06-30 10:46:24,418 [Listener at 0.0.0.0/45295] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1521)) - Stopping Replication Manager Service.
2022-06-30 10:46:24,418 [Listener at 0.0.0.0/45295] INFO  replication.ReplicationManager (ReplicationManager.java:stop(211)) - Stopping Replication Monitor Thread.
2022-06-30 10:46:24,418 [Listener at 0.0.0.0/45295] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1528)) - Stopping the Datanode Admin Monitor.
2022-06-30 10:46:24,418 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(321)) - Replication Monitor Thread is stopped
2022-06-30 10:46:24,418 [Listener at 0.0.0.0/45295] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1535)) - Stopping Lease Manager of the command watchers
2022-06-30 10:46:24,418 [Listener at 0.0.0.0/45295] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1538)) - Lease Manager of the command watchers stop failed
2022-06-30 10:46:24,418 [Listener at 0.0.0.0/45295] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1542)) - Stopping datanode service RPC server
2022-06-30 10:46:24,418 [Listener at 0.0.0.0/45295] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(408)) - Stopping the RPC server for DataNodes
2022-06-30 10:46:24,418 [Listener at 0.0.0.0/45295] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 33841
2022-06-30 10:46:24,421 [Listener at 0.0.0.0/45295] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1550)) - Stopping block service RPC server
2022-06-30 10:46:24,421 [Listener at 0.0.0.0/45295] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-06-30 10:46:24,421 [Listener at 0.0.0.0/45295] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 37119
2022-06-30 10:46:24,422 [Listener at 0.0.0.0/45295] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1557)) - Stopping the StorageContainerLocationProtocol RPC server
2022-06-30 10:46:24,422 [Listener at 0.0.0.0/45295] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(178)) - Stopping the RPC server for Client Protocol
2022-06-30 10:46:24,422 [Listener at 0.0.0.0/45295] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 45295
2022-06-30 10:46:24,422 [Listener at 0.0.0.0/45295] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1564)) - Stopping Storage Container Manager HTTP server.
2022-06-30 10:46:24,422 [Listener at 0.0.0.0/45295] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1567)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1565)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:195)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptAfterEachMethod(TimeoutExtension.java:108)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeAfterEachMethodAdapter$22(ClassBasedTestDescriptor.java:496)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAfterEachMethods$10(TestMethodTestDescriptor.java:240)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$13(TestMethodTestDescriptor.java:273)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$14(TestMethodTestDescriptor.java:273)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAllAfterMethodsOrCallbacks(TestMethodTestDescriptor.java:272)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAfterEachMethods(TestMethodTestDescriptor.java:238)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-06-30 10:46:24,423 [Listener at 0.0.0.0/45295] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1575)) - Stopping Block Manager Service.
2022-06-30 10:46:24,423 [Listener at 0.0.0.0/45295] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:24,423 [Listener at 0.0.0.0/45295] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:24,423 [Listener at 0.0.0.0/45295] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1602)) - Stopping SCM Event Queue.
2022-06-30 10:46:24,424 [Listener at 0.0.0.0/45295] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1613)) - Stopping SCM HA services.
2022-06-30 10:46:24,424 [Listener at 0.0.0.0/45295] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2022-06-30 10:46:24,424 [RatisPipelineUtilsThread - 0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(179)) - RatisPipelineUtilsThread is interrupted.
2022-06-30 10:46:24,424 [Listener at 0.0.0.0/45295] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(126)) - Stopping BackgroundPipelineScrubber Service.
2022-06-30 10:46:24,425 [BackgroundPipelineScrubberThread] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(110)) - BackgroundPipelineScrubber is interrupted, exit
2022-06-30 10:46:24,425 [Listener at 0.0.0.0/45295] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1623)) - Stopping SCM MetadataStore.
]]></system-out>
  </testcase>
  <testcase name="testAllocateBlockInParallel" classname="org.apache.hadoop.hdds.scm.block.TestBlockManager" time="0.389">
    <system-out><![CDATA[2022-06-30 10:46:24,449 [Listener at 0.0.0.0/45295] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:24,449 [Listener at 0.0.0.0/45295] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:24,474 [Listener at 0.0.0.0/45295] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:24,475 [Listener at 0.0.0.0/45295] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:24,476 [Listener at 0.0.0.0/45295] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/0cd9646a-294e-413a-91f8-1697923240b1
2022-06-30 10:46:24,477 [Listener at 0.0.0.0/45295] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/b2c21eeb-7e98-4128-9b7b-82b4d7b39460
2022-06-30 10:46:24,477 [Listener at 0.0.0.0/45295] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/e2149a54-840d-409a-9d27-6c4ab47b32eb
2022-06-30 10:46:24,477 [Listener at 0.0.0.0/45295] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/d58522d3-47a5-4e66-a2b8-734d4d7c1953
2022-06-30 10:46:24,477 [Listener at 0.0.0.0/45295] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/f2c34e7b-10fd-43f6-a633-b28d58863ed8
2022-06-30 10:46:24,477 [Listener at 0.0.0.0/45295] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/e74954f9-b70f-425d-aea8-7352e7ed957c
2022-06-30 10:46:24,477 [Listener at 0.0.0.0/45295] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/17bef93c-93c4-4a3a-8aac-042738043ad2
2022-06-30 10:46:24,477 [Listener at 0.0.0.0/45295] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/3f67784f-7498-47fa-89ba-23daf6a27d10
2022-06-30 10:46:24,478 [Listener at 0.0.0.0/45295] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/8202bce9-d7d5-4867-942a-89723428b452
2022-06-30 10:46:24,478 [Listener at 0.0.0.0/45295] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/783c0eaf-493b-493b-90c4-4843cff2d1ff
2022-06-30 10:46:24,478 [Listener at 0.0.0.0/45295] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:24,479 [Listener at 0.0.0.0/45295] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:24,588 [Listener at 0.0.0.0/45295] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:24,589 [Listener at 0.0.0.0/45295] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-06-30 10:46:24,589 [Listener at 0.0.0.0/45295] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:24,589 [Listener at 0.0.0.0/45295] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2022-06-30 10:46:24,590 [Listener at 0.0.0.0/45295] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2022-06-30 10:46:24,590 [Listener at 0.0.0.0/45295] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(68)) - Starting BackgroundPipelineScrubber Service.
2022-06-30 10:46:24,590 [Listener at 0.0.0.0/45295] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-06-30 10:46:24,591 [Listener at 0.0.0.0/45295] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2022-06-30 10:46:24,591 [Listener at 0.0.0.0/45295] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:24,592 [Listener at 0.0.0.0/45295] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-06-30 10:46:24,592 [Listener at 0.0.0.0/45295] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-06-30 10:46:24,592 [Listener at 0.0.0.0/45295] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-06-30 10:46:24,592 [Listener at 0.0.0.0/45295] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:24,593 [Listener at 0.0.0.0/45295] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:24,594 [Listener at 0.0.0.0/45295] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(209)) - ServiceID for StorageContainerManager is null
2022-06-30 10:46:24,594 [Listener at 0.0.0.0/45295] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(214)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-06-30 10:46:24,595 [Listener at 0.0.0.0/45295] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:24,595 [Listener at 0.0.0.0/45295] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:24,596 [Listener at 0.0.0.0/45295] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(82)) - Initializing Layout version manager with metadata layout = DATANODE_SCHEMA_V3 (version = 4), software layout = DATANODE_SCHEMA_V3 (version = 4)
2022-06-30 10:46:24,597 [Listener at 0.0.0.0/45295] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:87)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.initializeSystemManagers(StorageContainerManager.java:587)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:371)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:536)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:644)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptBeforeEachMethod(TimeoutExtension.java:76)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeBeforeEachMethodAdapter$21(ClassBasedTestDescriptor.java:491)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeEachMethods$3(TestMethodTestDescriptor.java:171)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeMethodsOrCallbacksUntilExceptionOccurs$6(TestMethodTestDescriptor.java:199)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeMethodsOrCallbacksUntilExceptionOccurs(TestMethodTestDescriptor.java:199)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeEachMethods(TestMethodTestDescriptor.java:168)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 85 more
2022-06-30 10:46:24,630 [Listener at 0.0.0.0/45295] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 31 ms to scan 6 urls, producing 128 keys and 304 values 
2022-06-30 10:46:24,631 [Listener at 0.0.0.0/45295] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-06-30 10:46:24,631 [Listener at 0.0.0.0/45295] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-06-30 10:46:24,632 [Listener at 0.0.0.0/45295] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(374)) - upgrade containerId to 0
2022-06-30 10:46:24,632 [Listener at 0.0.0.0/45295] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:24,632 [Listener at 0.0.0.0/45295] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-06-30 10:46:24,632 [Listener at 0.0.0.0/45295] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(68)) - Starting ExpiredContainerReplicaOpScrubber Service.
2022-06-30 10:46:24,632 [Listener at 0.0.0.0/45295] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2022-06-30 10:46:24,632 [Listener at 0.0.0.0/45295] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-06-30 10:46:24,633 [Listener at 0.0.0.0/45295] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-06-30 10:46:24,634 [Listener at 0.0.0.0/45295] INFO  replication.ReplicationManager (ReplicationManager.java:start(178)) - Starting Replication Monitor Thread.
2022-06-30 10:46:24,634 [Listener at 0.0.0.0/45295] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-06-30 10:46:24,638 [Listener at 0.0.0.0/45295] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:24,639 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(227)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-06-30 10:46:24,640 [Listener at 0.0.0.0/33407] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:24,639 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:24,645 [Listener at 0.0.0.0/37033] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:24,645 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:24,650 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:24,661 [Listener at 0.0.0.0/43367] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2022-06-30 10:46:24,662 [Listener at 0.0.0.0/43367] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(401)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-06-30 10:46:24,663 [Listener at 0.0.0.0/43367] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(228)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-06-30 10:46:24,667 [pool-142-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=826c8b2d-be2e-497e-8ebe-51dfeb0b9422 to datanode:e2149a54-840d-409a-9d27-6c4ab47b32eb
2022-06-30 10:46:24,674 [pool-142-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=826c8b2d-be2e-497e-8ebe-51dfeb0b9422 to datanode:3f67784f-7498-47fa-89ba-23daf6a27d10
2022-06-30 10:46:24,674 [pool-142-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=826c8b2d-be2e-497e-8ebe-51dfeb0b9422 to datanode:d58522d3-47a5-4e66-a2b8-734d4d7c1953
2022-06-30 10:46:24,675 [pool-142-thread-1] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 826c8b2d-be2e-497e-8ebe-51dfeb0b9422, Nodes: e2149a54-840d-409a-9d27-6c4ab47b32eb{ip: 129.133.85.239, host: localhost-129.133.85.239, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}3f67784f-7498-47fa-89ba-23daf6a27d10{ip: 246.135.96.160, host: localhost-246.135.96.160, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}d58522d3-47a5-4e66-a2b8-734d4d7c1953{ip: 128.126.34.161, host: localhost-128.126.34.161, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.667Z[Etc/UTC]].
2022-06-30 10:46:24,679 [pool-144-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=3945faa4-edc5-4cf6-91ad-a3efb4efb9e5 to datanode:e2149a54-840d-409a-9d27-6c4ab47b32eb
2022-06-30 10:46:24,679 [pool-144-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=3945faa4-edc5-4cf6-91ad-a3efb4efb9e5 to datanode:e74954f9-b70f-425d-aea8-7352e7ed957c
2022-06-30 10:46:24,679 [pool-144-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=3945faa4-edc5-4cf6-91ad-a3efb4efb9e5 to datanode:0cd9646a-294e-413a-91f8-1697923240b1
2022-06-30 10:46:24,681 [pool-144-thread-1] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 3945faa4-edc5-4cf6-91ad-a3efb4efb9e5, Nodes: e2149a54-840d-409a-9d27-6c4ab47b32eb{ip: 129.133.85.239, host: localhost-129.133.85.239, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}e74954f9-b70f-425d-aea8-7352e7ed957c{ip: 192.67.215.201, host: localhost-192.67.215.201, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}0cd9646a-294e-413a-91f8-1697923240b1{ip: 14.222.76.184, host: localhost-14.222.76.184, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.679Z[Etc/UTC]].
2022-06-30 10:46:24,682 [pool-145-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=e09af6a5-4dae-405f-8f2d-c30e47cf34dc to datanode:d58522d3-47a5-4e66-a2b8-734d4d7c1953
2022-06-30 10:46:24,682 [pool-145-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=e09af6a5-4dae-405f-8f2d-c30e47cf34dc to datanode:b2c21eeb-7e98-4128-9b7b-82b4d7b39460
2022-06-30 10:46:24,682 [pool-145-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=e09af6a5-4dae-405f-8f2d-c30e47cf34dc to datanode:0cd9646a-294e-413a-91f8-1697923240b1
2022-06-30 10:46:24,683 [pool-145-thread-1] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: e09af6a5-4dae-405f-8f2d-c30e47cf34dc, Nodes: d58522d3-47a5-4e66-a2b8-734d4d7c1953{ip: 128.126.34.161, host: localhost-128.126.34.161, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b2c21eeb-7e98-4128-9b7b-82b4d7b39460{ip: 243.101.233.180, host: localhost-243.101.233.180, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}0cd9646a-294e-413a-91f8-1697923240b1{ip: 14.222.76.184, host: localhost-14.222.76.184, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.682Z[Etc/UTC]].
2022-06-30 10:46:24,684 [pool-146-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=1c364003-b330-43ce-8396-c44396017944 to datanode:f2c34e7b-10fd-43f6-a633-b28d58863ed8
2022-06-30 10:46:24,684 [pool-146-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=1c364003-b330-43ce-8396-c44396017944 to datanode:b2c21eeb-7e98-4128-9b7b-82b4d7b39460
2022-06-30 10:46:24,684 [pool-146-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=1c364003-b330-43ce-8396-c44396017944 to datanode:3f67784f-7498-47fa-89ba-23daf6a27d10
2022-06-30 10:46:24,685 [pool-146-thread-1] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 1c364003-b330-43ce-8396-c44396017944, Nodes: f2c34e7b-10fd-43f6-a633-b28d58863ed8{ip: 190.137.43.92, host: localhost-190.137.43.92, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b2c21eeb-7e98-4128-9b7b-82b4d7b39460{ip: 243.101.233.180, host: localhost-243.101.233.180, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}3f67784f-7498-47fa-89ba-23daf6a27d10{ip: 246.135.96.160, host: localhost-246.135.96.160, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.684Z[Etc/UTC]].
2022-06-30 10:46:24,686 [pool-147-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=70d76dab-63fd-4372-9a2f-9f948187b7c9 to datanode:17bef93c-93c4-4a3a-8aac-042738043ad2
2022-06-30 10:46:24,686 [pool-147-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=70d76dab-63fd-4372-9a2f-9f948187b7c9 to datanode:e74954f9-b70f-425d-aea8-7352e7ed957c
2022-06-30 10:46:24,686 [pool-147-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=70d76dab-63fd-4372-9a2f-9f948187b7c9 to datanode:f2c34e7b-10fd-43f6-a633-b28d58863ed8
2022-06-30 10:46:24,687 [pool-147-thread-1] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 70d76dab-63fd-4372-9a2f-9f948187b7c9, Nodes: 17bef93c-93c4-4a3a-8aac-042738043ad2{ip: 242.82.79.216, host: localhost-242.82.79.216, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}e74954f9-b70f-425d-aea8-7352e7ed957c{ip: 192.67.215.201, host: localhost-192.67.215.201, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}f2c34e7b-10fd-43f6-a633-b28d58863ed8{ip: 190.137.43.92, host: localhost-190.137.43.92, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.686Z[Etc/UTC]].
2022-06-30 10:46:24,688 [pool-148-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(121)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:223)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:166)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:89)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:217)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:193)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:115)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:57)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:257)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-06-30 10:46:24,689 [pool-149-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(121)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:223)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:166)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:89)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:217)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:193)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:115)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:57)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:257)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-06-30 10:46:24,690 [pool-150-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(121)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:223)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:166)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:89)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:217)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:193)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:115)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:57)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:257)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-06-30 10:46:24,691 [pool-151-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(121)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:223)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:166)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:89)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:217)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:193)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:115)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:57)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:257)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-06-30 10:46:24,692 [pool-152-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(121)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:223)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:166)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:89)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:217)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:193)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:115)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:57)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:257)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-06-30 10:46:24,693 [pool-153-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(121)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:223)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:166)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:89)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:217)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:193)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:115)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:57)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:257)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-06-30 10:46:24,694 [pool-154-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(121)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:223)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:166)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:89)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:217)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:193)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:115)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:57)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:257)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-06-30 10:46:24,695 [pool-155-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(121)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:223)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:166)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:89)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:217)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:193)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:115)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:57)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:257)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-06-30 10:46:24,697 [pool-157-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(121)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:223)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:166)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:89)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:217)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:193)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:115)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:57)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:257)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-06-30 10:46:24,697 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: 826c8b2d-be2e-497e-8ebe-51dfeb0b9422, Nodes: e2149a54-840d-409a-9d27-6c4ab47b32eb{ip: 129.133.85.239, host: localhost-129.133.85.239, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}3f67784f-7498-47fa-89ba-23daf6a27d10{ip: 246.135.96.160, host: localhost-246.135.96.160, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}d58522d3-47a5-4e66-a2b8-734d4d7c1953{ip: 128.126.34.161, host: localhost-128.126.34.161, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.667Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:24,699 [pool-143-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(121)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:223)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:166)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:89)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:217)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:193)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:115)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:57)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:257)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-06-30 10:46:24,699 [pool-158-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(121)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:223)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:166)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:89)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:217)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:193)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:115)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:57)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:257)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-06-30 10:46:24,700 [pool-160-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(121)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:223)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:166)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:89)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:217)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:193)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:115)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:57)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:257)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-06-30 10:46:24,701 [pool-159-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(121)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:223)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:166)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:89)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:217)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:193)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:115)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:57)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:257)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-06-30 10:46:24,702 [pool-161-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-06-30 10:46:24,703 [pool-156-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(121)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:223)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:166)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:89)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:217)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:193)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:115)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:57)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:257)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-06-30 10:46:24,703 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: 3945faa4-edc5-4cf6-91ad-a3efb4efb9e5, Nodes: e2149a54-840d-409a-9d27-6c4ab47b32eb{ip: 129.133.85.239, host: localhost-129.133.85.239, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}e74954f9-b70f-425d-aea8-7352e7ed957c{ip: 192.67.215.201, host: localhost-192.67.215.201, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}0cd9646a-294e-413a-91f8-1697923240b1{ip: 14.222.76.184, host: localhost-14.222.76.184, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.679Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:24,704 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: e09af6a5-4dae-405f-8f2d-c30e47cf34dc, Nodes: d58522d3-47a5-4e66-a2b8-734d4d7c1953{ip: 128.126.34.161, host: localhost-128.126.34.161, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b2c21eeb-7e98-4128-9b7b-82b4d7b39460{ip: 243.101.233.180, host: localhost-243.101.233.180, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}0cd9646a-294e-413a-91f8-1697923240b1{ip: 14.222.76.184, host: localhost-14.222.76.184, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.682Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:24,705 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: 1c364003-b330-43ce-8396-c44396017944, Nodes: f2c34e7b-10fd-43f6-a633-b28d58863ed8{ip: 190.137.43.92, host: localhost-190.137.43.92, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b2c21eeb-7e98-4128-9b7b-82b4d7b39460{ip: 243.101.233.180, host: localhost-243.101.233.180, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}3f67784f-7498-47fa-89ba-23daf6a27d10{ip: 246.135.96.160, host: localhost-246.135.96.160, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.684Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:24,705 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: 70d76dab-63fd-4372-9a2f-9f948187b7c9, Nodes: 17bef93c-93c4-4a3a-8aac-042738043ad2{ip: 242.82.79.216, host: localhost-242.82.79.216, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}e74954f9-b70f-425d-aea8-7352e7ed957c{ip: 192.67.215.201, host: localhost-192.67.215.201, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}f2c34e7b-10fd-43f6-a633-b28d58863ed8{ip: 190.137.43.92, host: localhost-190.137.43.92, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:24.686Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:24,706 [pool-161-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-06-30 10:46:24,706 [pool-161-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-06-30 10:46:24,804 [Listener at 0.0.0.0/43367] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1514)) - Container Balancer is not running.
2022-06-30 10:46:24,804 [Listener at 0.0.0.0/43367] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1521)) - Stopping Replication Manager Service.
2022-06-30 10:46:24,804 [Listener at 0.0.0.0/43367] INFO  replication.ReplicationManager (ReplicationManager.java:stop(211)) - Stopping Replication Monitor Thread.
2022-06-30 10:46:24,805 [Listener at 0.0.0.0/43367] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1528)) - Stopping the Datanode Admin Monitor.
2022-06-30 10:46:24,805 [Listener at 0.0.0.0/43367] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1535)) - Stopping Lease Manager of the command watchers
2022-06-30 10:46:24,805 [Listener at 0.0.0.0/43367] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1538)) - Lease Manager of the command watchers stop failed
2022-06-30 10:46:24,805 [Listener at 0.0.0.0/43367] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1542)) - Stopping datanode service RPC server
2022-06-30 10:46:24,805 [Listener at 0.0.0.0/43367] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(408)) - Stopping the RPC server for DataNodes
2022-06-30 10:46:24,805 [Listener at 0.0.0.0/43367] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 33407
2022-06-30 10:46:24,805 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(321)) - Replication Monitor Thread is stopped
2022-06-30 10:46:24,806 [Listener at 0.0.0.0/43367] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1550)) - Stopping block service RPC server
2022-06-30 10:46:24,806 [Listener at 0.0.0.0/43367] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-06-30 10:46:24,806 [Listener at 0.0.0.0/43367] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 37033
2022-06-30 10:46:24,807 [Listener at 0.0.0.0/43367] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1557)) - Stopping the StorageContainerLocationProtocol RPC server
2022-06-30 10:46:24,807 [Listener at 0.0.0.0/43367] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(178)) - Stopping the RPC server for Client Protocol
2022-06-30 10:46:24,807 [Listener at 0.0.0.0/43367] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 43367
2022-06-30 10:46:24,807 [Listener at 0.0.0.0/43367] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1564)) - Stopping Storage Container Manager HTTP server.
2022-06-30 10:46:24,807 [Listener at 0.0.0.0/43367] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1567)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1565)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:195)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptAfterEachMethod(TimeoutExtension.java:108)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeAfterEachMethodAdapter$22(ClassBasedTestDescriptor.java:496)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAfterEachMethods$10(TestMethodTestDescriptor.java:240)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$13(TestMethodTestDescriptor.java:273)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$14(TestMethodTestDescriptor.java:273)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAllAfterMethodsOrCallbacks(TestMethodTestDescriptor.java:272)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAfterEachMethods(TestMethodTestDescriptor.java:238)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-06-30 10:46:24,814 [Listener at 0.0.0.0/43367] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1575)) - Stopping Block Manager Service.
2022-06-30 10:46:24,815 [Listener at 0.0.0.0/43367] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:24,815 [Listener at 0.0.0.0/43367] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:24,815 [Listener at 0.0.0.0/43367] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1602)) - Stopping SCM Event Queue.
2022-06-30 10:46:24,815 [Listener at 0.0.0.0/43367] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1613)) - Stopping SCM HA services.
2022-06-30 10:46:24,815 [Listener at 0.0.0.0/43367] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2022-06-30 10:46:24,815 [RatisPipelineUtilsThread - 0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(179)) - RatisPipelineUtilsThread is interrupted.
2022-06-30 10:46:24,816 [BackgroundPipelineScrubberThread] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(110)) - BackgroundPipelineScrubber is interrupted, exit
2022-06-30 10:46:24,816 [Listener at 0.0.0.0/43367] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(126)) - Stopping BackgroundPipelineScrubber Service.
2022-06-30 10:46:24,816 [Listener at 0.0.0.0/43367] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1623)) - Stopping SCM MetadataStore.
]]></system-out>
  </testcase>
  <testcase name="testBlockAllocationWithNoAvailablePipelines" classname="org.apache.hadoop.hdds.scm.block.TestBlockManager" time="0.368">
    <system-out><![CDATA[2022-06-30 10:46:24,841 [Listener at 0.0.0.0/43367] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:24,842 [Listener at 0.0.0.0/43367] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:24,853 [Listener at 0.0.0.0/43367] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:24,853 [Listener at 0.0.0.0/43367] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:24,854 [Listener at 0.0.0.0/43367] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/d4336969-e33f-41b9-943b-1c4562b98806
2022-06-30 10:46:24,854 [Listener at 0.0.0.0/43367] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/1d38ec5a-1384-48aa-b58d-a8f571f247e5
2022-06-30 10:46:24,855 [Listener at 0.0.0.0/43367] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/ff126477-dcb7-4caf-9380-120c489c55a0
2022-06-30 10:46:24,855 [Listener at 0.0.0.0/43367] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/aeb3621b-61f4-41bd-a21d-47722fad6dba
2022-06-30 10:46:24,855 [Listener at 0.0.0.0/43367] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/9989f395-34fd-4008-8924-42a78e79a478
2022-06-30 10:46:24,855 [Listener at 0.0.0.0/43367] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/08e0b6a7-b170-48ea-b8c7-3b6162ece0b9
2022-06-30 10:46:24,855 [Listener at 0.0.0.0/43367] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/2fd59467-d06d-4dbf-bfde-53e8b86cf949
2022-06-30 10:46:24,855 [Listener at 0.0.0.0/43367] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/e92206a1-a207-4666-9717-25f97df8dadb
2022-06-30 10:46:24,855 [Listener at 0.0.0.0/43367] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/98d6e931-6eb6-48a5-ac11-012abc696dcb
2022-06-30 10:46:24,856 [Listener at 0.0.0.0/43367] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/7741ed73-a76e-4c74-a831-abae4a223df0
2022-06-30 10:46:24,856 [Listener at 0.0.0.0/43367] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:24,856 [Listener at 0.0.0.0/43367] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:24,972 [Listener at 0.0.0.0/43367] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:24,972 [Listener at 0.0.0.0/43367] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-06-30 10:46:24,972 [Listener at 0.0.0.0/43367] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:24,972 [Listener at 0.0.0.0/43367] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2022-06-30 10:46:24,973 [Listener at 0.0.0.0/43367] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2022-06-30 10:46:24,973 [Listener at 0.0.0.0/43367] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(68)) - Starting BackgroundPipelineScrubber Service.
2022-06-30 10:46:24,973 [Listener at 0.0.0.0/43367] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-06-30 10:46:24,973 [Listener at 0.0.0.0/43367] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2022-06-30 10:46:24,974 [Listener at 0.0.0.0/43367] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:24,974 [Listener at 0.0.0.0/43367] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-06-30 10:46:24,975 [Listener at 0.0.0.0/43367] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-06-30 10:46:24,975 [Listener at 0.0.0.0/43367] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-06-30 10:46:24,975 [Listener at 0.0.0.0/43367] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:24,993 [Listener at 0.0.0.0/43367] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:24,994 [Listener at 0.0.0.0/43367] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(209)) - ServiceID for StorageContainerManager is null
2022-06-30 10:46:24,994 [Listener at 0.0.0.0/43367] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(214)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-06-30 10:46:24,995 [Listener at 0.0.0.0/43367] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:24,995 [Listener at 0.0.0.0/43367] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:24,999 [Listener at 0.0.0.0/43367] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(82)) - Initializing Layout version manager with metadata layout = DATANODE_SCHEMA_V3 (version = 4), software layout = DATANODE_SCHEMA_V3 (version = 4)
2022-06-30 10:46:24,999 [Listener at 0.0.0.0/43367] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:87)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.initializeSystemManagers(StorageContainerManager.java:587)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:371)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:536)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:644)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptBeforeEachMethod(TimeoutExtension.java:76)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeBeforeEachMethodAdapter$21(ClassBasedTestDescriptor.java:491)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeEachMethods$3(TestMethodTestDescriptor.java:171)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeMethodsOrCallbacksUntilExceptionOccurs$6(TestMethodTestDescriptor.java:199)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeMethodsOrCallbacksUntilExceptionOccurs(TestMethodTestDescriptor.java:199)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeEachMethods(TestMethodTestDescriptor.java:168)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 85 more
2022-06-30 10:46:25,035 [Listener at 0.0.0.0/43367] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 34 ms to scan 6 urls, producing 128 keys and 304 values 
2022-06-30 10:46:25,040 [Listener at 0.0.0.0/43367] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-06-30 10:46:25,041 [Listener at 0.0.0.0/43367] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-06-30 10:46:25,041 [Listener at 0.0.0.0/43367] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(374)) - upgrade containerId to 0
2022-06-30 10:46:25,041 [Listener at 0.0.0.0/43367] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:25,041 [Listener at 0.0.0.0/43367] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-06-30 10:46:25,042 [Listener at 0.0.0.0/43367] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(68)) - Starting ExpiredContainerReplicaOpScrubber Service.
2022-06-30 10:46:25,042 [Listener at 0.0.0.0/43367] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2022-06-30 10:46:25,042 [Listener at 0.0.0.0/43367] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-06-30 10:46:25,043 [Listener at 0.0.0.0/43367] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-06-30 10:46:25,043 [Listener at 0.0.0.0/43367] INFO  replication.ReplicationManager (ReplicationManager.java:start(178)) - Starting Replication Monitor Thread.
2022-06-30 10:46:25,045 [Listener at 0.0.0.0/43367] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-06-30 10:46:25,046 [Listener at 0.0.0.0/43367] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:25,047 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(227)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-06-30 10:46:25,047 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:25,048 [Listener at 0.0.0.0/40377] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:25,050 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:25,051 [Listener at 0.0.0.0/39885] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:25,054 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:25,066 [Listener at 0.0.0.0/36387] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2022-06-30 10:46:25,067 [Listener at 0.0.0.0/36387] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(401)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-06-30 10:46:25,067 [Listener at 0.0.0.0/36387] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(228)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-06-30 10:46:25,068 [Listener at 0.0.0.0/36387] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=5e791dbb-362b-4892-83a2-71a3665d82ab to datanode:1d38ec5a-1384-48aa-b58d-a8f571f247e5
2022-06-30 10:46:25,068 [Listener at 0.0.0.0/36387] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=5e791dbb-362b-4892-83a2-71a3665d82ab to datanode:aeb3621b-61f4-41bd-a21d-47722fad6dba
2022-06-30 10:46:25,069 [Listener at 0.0.0.0/36387] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=5e791dbb-362b-4892-83a2-71a3665d82ab to datanode:9989f395-34fd-4008-8924-42a78e79a478
2022-06-30 10:46:25,069 [Listener at 0.0.0.0/36387] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 5e791dbb-362b-4892-83a2-71a3665d82ab, Nodes: 1d38ec5a-1384-48aa-b58d-a8f571f247e5{ip: 192.11.200.17, host: localhost-192.11.200.17, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}aeb3621b-61f4-41bd-a21d-47722fad6dba{ip: 42.178.251.101, host: localhost-42.178.251.101, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}9989f395-34fd-4008-8924-42a78e79a478{ip: 53.190.223.251, host: localhost-53.190.223.251, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:25.068Z[Etc/UTC]].
2022-06-30 10:46:25,070 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: 5e791dbb-362b-4892-83a2-71a3665d82ab, Nodes: 1d38ec5a-1384-48aa-b58d-a8f571f247e5{ip: 192.11.200.17, host: localhost-192.11.200.17, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}aeb3621b-61f4-41bd-a21d-47722fad6dba{ip: 42.178.251.101, host: localhost-42.178.251.101, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}9989f395-34fd-4008-8924-42a78e79a478{ip: 53.190.223.251, host: localhost-53.190.223.251, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:25.068Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:25,170 [Listener at 0.0.0.0/36387] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-06-30 10:46:25,171 [Listener at 0.0.0.0/36387] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-06-30 10:46:25,172 [Listener at 0.0.0.0/36387] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-06-30 10:46:25,172 [Listener at 0.0.0.0/36387] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1514)) - Container Balancer is not running.
2022-06-30 10:46:25,172 [Listener at 0.0.0.0/36387] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1521)) - Stopping Replication Manager Service.
2022-06-30 10:46:25,172 [Listener at 0.0.0.0/36387] INFO  replication.ReplicationManager (ReplicationManager.java:stop(211)) - Stopping Replication Monitor Thread.
2022-06-30 10:46:25,172 [Listener at 0.0.0.0/36387] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1528)) - Stopping the Datanode Admin Monitor.
2022-06-30 10:46:25,172 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(321)) - Replication Monitor Thread is stopped
2022-06-30 10:46:25,173 [Listener at 0.0.0.0/36387] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1535)) - Stopping Lease Manager of the command watchers
2022-06-30 10:46:25,173 [Listener at 0.0.0.0/36387] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1538)) - Lease Manager of the command watchers stop failed
2022-06-30 10:46:25,173 [Listener at 0.0.0.0/36387] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1542)) - Stopping datanode service RPC server
2022-06-30 10:46:25,173 [Listener at 0.0.0.0/36387] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(408)) - Stopping the RPC server for DataNodes
2022-06-30 10:46:25,173 [Listener at 0.0.0.0/36387] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 40377
2022-06-30 10:46:25,174 [Listener at 0.0.0.0/36387] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1550)) - Stopping block service RPC server
2022-06-30 10:46:25,174 [Listener at 0.0.0.0/36387] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-06-30 10:46:25,174 [Listener at 0.0.0.0/36387] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 39885
2022-06-30 10:46:25,174 [Listener at 0.0.0.0/36387] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1557)) - Stopping the StorageContainerLocationProtocol RPC server
2022-06-30 10:46:25,174 [Listener at 0.0.0.0/36387] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(178)) - Stopping the RPC server for Client Protocol
2022-06-30 10:46:25,174 [Listener at 0.0.0.0/36387] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 36387
2022-06-30 10:46:25,178 [Listener at 0.0.0.0/36387] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1564)) - Stopping Storage Container Manager HTTP server.
2022-06-30 10:46:25,178 [Listener at 0.0.0.0/36387] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1567)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1565)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:195)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptAfterEachMethod(TimeoutExtension.java:108)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeAfterEachMethodAdapter$22(ClassBasedTestDescriptor.java:496)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAfterEachMethods$10(TestMethodTestDescriptor.java:240)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$13(TestMethodTestDescriptor.java:273)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$14(TestMethodTestDescriptor.java:273)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAllAfterMethodsOrCallbacks(TestMethodTestDescriptor.java:272)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAfterEachMethods(TestMethodTestDescriptor.java:238)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-06-30 10:46:25,178 [Listener at 0.0.0.0/36387] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1575)) - Stopping Block Manager Service.
2022-06-30 10:46:25,178 [Listener at 0.0.0.0/36387] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:25,178 [Listener at 0.0.0.0/36387] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:25,179 [Listener at 0.0.0.0/36387] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1602)) - Stopping SCM Event Queue.
2022-06-30 10:46:25,179 [Listener at 0.0.0.0/36387] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1613)) - Stopping SCM HA services.
2022-06-30 10:46:25,179 [Listener at 0.0.0.0/36387] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2022-06-30 10:46:25,180 [RatisPipelineUtilsThread - 0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(179)) - RatisPipelineUtilsThread is interrupted.
2022-06-30 10:46:25,180 [BackgroundPipelineScrubberThread] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(110)) - BackgroundPipelineScrubber is interrupted, exit
2022-06-30 10:46:25,180 [Listener at 0.0.0.0/36387] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(126)) - Stopping BackgroundPipelineScrubber Service.
2022-06-30 10:46:25,180 [Listener at 0.0.0.0/36387] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1623)) - Stopping SCM MetadataStore.
]]></system-out>
  </testcase>
  <testcase name="testAllocateOversizedBlock" classname="org.apache.hadoop.hdds.scm.block.TestBlockManager" time="0.232">
    <system-out><![CDATA[2022-06-30 10:46:25,207 [Listener at 0.0.0.0/36387] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:25,207 [Listener at 0.0.0.0/36387] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:25,217 [Listener at 0.0.0.0/36387] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:25,217 [Listener at 0.0.0.0/36387] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:25,219 [Listener at 0.0.0.0/36387] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/8771ef82-6c40-46e2-a717-8bd383652649
2022-06-30 10:46:25,219 [Listener at 0.0.0.0/36387] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/18a89242-6c3a-4cbe-b197-893e27fe729e
2022-06-30 10:46:25,219 [Listener at 0.0.0.0/36387] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/776ddb72-641b-4698-9914-c16cdf87aae6
2022-06-30 10:46:25,219 [Listener at 0.0.0.0/36387] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/6e6edb8a-8e2f-42ed-a7f2-5776e284993d
2022-06-30 10:46:25,219 [Listener at 0.0.0.0/36387] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/f50b5689-3634-4e3e-b3e9-a45ff67d0077
2022-06-30 10:46:25,220 [Listener at 0.0.0.0/36387] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/c5d770ef-fc10-421f-a51c-6e608b74cdd9
2022-06-30 10:46:25,220 [Listener at 0.0.0.0/36387] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/6fee78de-bb41-45e1-8790-494869d9df35
2022-06-30 10:46:25,220 [Listener at 0.0.0.0/36387] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/88f2884c-e587-4372-a774-6f58674d6b71
2022-06-30 10:46:25,220 [Listener at 0.0.0.0/36387] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/e6ba3b1b-d23f-406b-9d6a-76907f975449
2022-06-30 10:46:25,220 [Listener at 0.0.0.0/36387] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/3e0506fe-89a5-47bd-8dc7-b13c48843f09
2022-06-30 10:46:25,220 [Listener at 0.0.0.0/36387] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:25,221 [Listener at 0.0.0.0/36387] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:25,347 [Listener at 0.0.0.0/36387] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:25,348 [Listener at 0.0.0.0/36387] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-06-30 10:46:25,348 [Listener at 0.0.0.0/36387] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:25,348 [Listener at 0.0.0.0/36387] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2022-06-30 10:46:25,349 [Listener at 0.0.0.0/36387] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2022-06-30 10:46:25,349 [Listener at 0.0.0.0/36387] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(68)) - Starting BackgroundPipelineScrubber Service.
2022-06-30 10:46:25,349 [Listener at 0.0.0.0/36387] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-06-30 10:46:25,349 [Listener at 0.0.0.0/36387] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2022-06-30 10:46:25,349 [Listener at 0.0.0.0/36387] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:25,350 [Listener at 0.0.0.0/36387] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-06-30 10:46:25,350 [Listener at 0.0.0.0/36387] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-06-30 10:46:25,351 [Listener at 0.0.0.0/36387] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-06-30 10:46:25,351 [Listener at 0.0.0.0/36387] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:25,352 [Listener at 0.0.0.0/36387] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:25,353 [Listener at 0.0.0.0/36387] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(209)) - ServiceID for StorageContainerManager is null
2022-06-30 10:46:25,353 [Listener at 0.0.0.0/36387] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(214)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-06-30 10:46:25,354 [Listener at 0.0.0.0/36387] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:25,354 [Listener at 0.0.0.0/36387] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:25,359 [Listener at 0.0.0.0/36387] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(82)) - Initializing Layout version manager with metadata layout = DATANODE_SCHEMA_V3 (version = 4), software layout = DATANODE_SCHEMA_V3 (version = 4)
2022-06-30 10:46:25,359 [Listener at 0.0.0.0/36387] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:87)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.initializeSystemManagers(StorageContainerManager.java:587)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:371)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:536)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:644)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptBeforeEachMethod(TimeoutExtension.java:76)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeBeforeEachMethodAdapter$21(ClassBasedTestDescriptor.java:491)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeEachMethods$3(TestMethodTestDescriptor.java:171)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeMethodsOrCallbacksUntilExceptionOccurs$6(TestMethodTestDescriptor.java:199)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeMethodsOrCallbacksUntilExceptionOccurs(TestMethodTestDescriptor.java:199)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeEachMethods(TestMethodTestDescriptor.java:168)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 85 more
2022-06-30 10:46:25,390 [Listener at 0.0.0.0/36387] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 30 ms to scan 6 urls, producing 128 keys and 304 values 
2022-06-30 10:46:25,392 [Listener at 0.0.0.0/36387] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-06-30 10:46:25,392 [Listener at 0.0.0.0/36387] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-06-30 10:46:25,392 [Listener at 0.0.0.0/36387] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(374)) - upgrade containerId to 0
2022-06-30 10:46:25,392 [Listener at 0.0.0.0/36387] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:25,392 [Listener at 0.0.0.0/36387] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-06-30 10:46:25,393 [Listener at 0.0.0.0/36387] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(68)) - Starting ExpiredContainerReplicaOpScrubber Service.
2022-06-30 10:46:25,393 [Listener at 0.0.0.0/36387] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2022-06-30 10:46:25,393 [Listener at 0.0.0.0/36387] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-06-30 10:46:25,394 [Listener at 0.0.0.0/36387] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-06-30 10:46:25,394 [Listener at 0.0.0.0/36387] INFO  replication.ReplicationManager (ReplicationManager.java:start(178)) - Starting Replication Monitor Thread.
2022-06-30 10:46:25,394 [Listener at 0.0.0.0/36387] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-06-30 10:46:25,395 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(227)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-06-30 10:46:25,395 [Listener at 0.0.0.0/36387] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:25,396 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:25,396 [Listener at 0.0.0.0/44627] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:25,397 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:25,398 [Listener at 0.0.0.0/40853] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:25,398 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:25,410 [Listener at 0.0.0.0/42133] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2022-06-30 10:46:25,410 [Listener at 0.0.0.0/42133] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(401)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-06-30 10:46:25,410 [Listener at 0.0.0.0/42133] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(228)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-06-30 10:46:25,412 [Listener at 0.0.0.0/42133] WARN  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(171)) - Invalid block size requested : 6442450944
2022-06-30 10:46:25,412 [Listener at 0.0.0.0/42133] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1514)) - Container Balancer is not running.
2022-06-30 10:46:25,412 [Listener at 0.0.0.0/42133] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1521)) - Stopping Replication Manager Service.
2022-06-30 10:46:25,412 [Listener at 0.0.0.0/42133] INFO  replication.ReplicationManager (ReplicationManager.java:stop(211)) - Stopping Replication Monitor Thread.
2022-06-30 10:46:25,413 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(321)) - Replication Monitor Thread is stopped
2022-06-30 10:46:25,413 [Listener at 0.0.0.0/42133] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1528)) - Stopping the Datanode Admin Monitor.
2022-06-30 10:46:25,413 [Listener at 0.0.0.0/42133] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1535)) - Stopping Lease Manager of the command watchers
2022-06-30 10:46:25,414 [Listener at 0.0.0.0/42133] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1538)) - Lease Manager of the command watchers stop failed
2022-06-30 10:46:25,414 [Listener at 0.0.0.0/42133] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1542)) - Stopping datanode service RPC server
2022-06-30 10:46:25,414 [Listener at 0.0.0.0/42133] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(408)) - Stopping the RPC server for DataNodes
2022-06-30 10:46:25,414 [Listener at 0.0.0.0/42133] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 44627
2022-06-30 10:46:25,414 [Listener at 0.0.0.0/42133] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1550)) - Stopping block service RPC server
2022-06-30 10:46:25,414 [Listener at 0.0.0.0/42133] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-06-30 10:46:25,414 [Listener at 0.0.0.0/42133] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 40853
2022-06-30 10:46:25,415 [Listener at 0.0.0.0/42133] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1557)) - Stopping the StorageContainerLocationProtocol RPC server
2022-06-30 10:46:25,415 [Listener at 0.0.0.0/42133] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(178)) - Stopping the RPC server for Client Protocol
2022-06-30 10:46:25,415 [Listener at 0.0.0.0/42133] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 42133
2022-06-30 10:46:25,415 [Listener at 0.0.0.0/42133] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1564)) - Stopping Storage Container Manager HTTP server.
2022-06-30 10:46:25,415 [Listener at 0.0.0.0/42133] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1567)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1565)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:195)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptAfterEachMethod(TimeoutExtension.java:108)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeAfterEachMethodAdapter$22(ClassBasedTestDescriptor.java:496)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAfterEachMethods$10(TestMethodTestDescriptor.java:240)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$13(TestMethodTestDescriptor.java:273)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$14(TestMethodTestDescriptor.java:273)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAllAfterMethodsOrCallbacks(TestMethodTestDescriptor.java:272)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAfterEachMethods(TestMethodTestDescriptor.java:238)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-06-30 10:46:25,416 [Listener at 0.0.0.0/42133] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1575)) - Stopping Block Manager Service.
2022-06-30 10:46:25,416 [Listener at 0.0.0.0/42133] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:25,416 [Listener at 0.0.0.0/42133] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:25,416 [Listener at 0.0.0.0/42133] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1602)) - Stopping SCM Event Queue.
2022-06-30 10:46:25,416 [Listener at 0.0.0.0/42133] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1613)) - Stopping SCM HA services.
2022-06-30 10:46:25,416 [Listener at 0.0.0.0/42133] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2022-06-30 10:46:25,417 [RatisPipelineUtilsThread - 0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(179)) - RatisPipelineUtilsThread is interrupted.
2022-06-30 10:46:25,418 [BackgroundPipelineScrubberThread] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(110)) - BackgroundPipelineScrubber is interrupted, exit
2022-06-30 10:46:25,418 [Listener at 0.0.0.0/42133] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(126)) - Stopping BackgroundPipelineScrubber Service.
2022-06-30 10:46:25,418 [Listener at 0.0.0.0/42133] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1623)) - Stopping SCM MetadataStore.
]]></system-out>
  </testcase>
  <testcase name="testAllocateBlockFailureInSafeMode" classname="org.apache.hadoop.hdds.scm.block.TestBlockManager" time="0.229">
    <system-out><![CDATA[2022-06-30 10:46:25,439 [Listener at 0.0.0.0/42133] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:25,439 [Listener at 0.0.0.0/42133] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:25,450 [Listener at 0.0.0.0/42133] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:25,450 [Listener at 0.0.0.0/42133] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:25,451 [Listener at 0.0.0.0/42133] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/2f447bd8-f966-4284-a251-1f76b0514607
2022-06-30 10:46:25,451 [Listener at 0.0.0.0/42133] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/fbb73ea8-a219-43eb-813f-3020425e9de9
2022-06-30 10:46:25,451 [Listener at 0.0.0.0/42133] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/cff2a048-f766-45c9-bcea-d81b92a486a4
2022-06-30 10:46:25,452 [Listener at 0.0.0.0/42133] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/d04ee240-a7a0-45c9-ac18-517472130bc8
2022-06-30 10:46:25,452 [Listener at 0.0.0.0/42133] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/e8296528-789d-470c-ada9-494e91c30c70
2022-06-30 10:46:25,452 [Listener at 0.0.0.0/42133] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/371b1f0f-28ca-4c78-92d8-32ac91300ea1
2022-06-30 10:46:25,452 [Listener at 0.0.0.0/42133] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/72ae4512-7973-4820-85de-a80b1384c6ff
2022-06-30 10:46:25,452 [Listener at 0.0.0.0/42133] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/1821db62-0d77-4112-b399-efeb474d6834
2022-06-30 10:46:25,452 [Listener at 0.0.0.0/42133] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/70e45509-3a8e-48fb-8173-75691e5ccb28
2022-06-30 10:46:25,452 [Listener at 0.0.0.0/42133] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/728862b4-4f32-42bf-9cf1-83b58f0eeb00
2022-06-30 10:46:25,452 [Listener at 0.0.0.0/42133] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:25,453 [Listener at 0.0.0.0/42133] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:25,567 [Listener at 0.0.0.0/42133] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:25,567 [Listener at 0.0.0.0/42133] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-06-30 10:46:25,567 [Listener at 0.0.0.0/42133] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:25,568 [Listener at 0.0.0.0/42133] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2022-06-30 10:46:25,568 [Listener at 0.0.0.0/42133] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2022-06-30 10:46:25,568 [Listener at 0.0.0.0/42133] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(68)) - Starting BackgroundPipelineScrubber Service.
2022-06-30 10:46:25,569 [Listener at 0.0.0.0/42133] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-06-30 10:46:25,569 [Listener at 0.0.0.0/42133] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2022-06-30 10:46:25,569 [Listener at 0.0.0.0/42133] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:25,570 [Listener at 0.0.0.0/42133] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-06-30 10:46:25,570 [Listener at 0.0.0.0/42133] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-06-30 10:46:25,570 [Listener at 0.0.0.0/42133] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-06-30 10:46:25,571 [Listener at 0.0.0.0/42133] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:25,572 [Listener at 0.0.0.0/42133] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:25,572 [Listener at 0.0.0.0/42133] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(209)) - ServiceID for StorageContainerManager is null
2022-06-30 10:46:25,572 [Listener at 0.0.0.0/42133] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(214)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-06-30 10:46:25,573 [Listener at 0.0.0.0/42133] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:25,573 [Listener at 0.0.0.0/42133] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:25,575 [Listener at 0.0.0.0/42133] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(82)) - Initializing Layout version manager with metadata layout = DATANODE_SCHEMA_V3 (version = 4), software layout = DATANODE_SCHEMA_V3 (version = 4)
2022-06-30 10:46:25,575 [Listener at 0.0.0.0/42133] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:87)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.initializeSystemManagers(StorageContainerManager.java:587)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:371)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:536)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:644)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptBeforeEachMethod(TimeoutExtension.java:76)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeBeforeEachMethodAdapter$21(ClassBasedTestDescriptor.java:491)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeEachMethods$3(TestMethodTestDescriptor.java:171)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeMethodsOrCallbacksUntilExceptionOccurs$6(TestMethodTestDescriptor.java:199)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeMethodsOrCallbacksUntilExceptionOccurs(TestMethodTestDescriptor.java:199)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeEachMethods(TestMethodTestDescriptor.java:168)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 85 more
2022-06-30 10:46:25,608 [Listener at 0.0.0.0/42133] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 31 ms to scan 6 urls, producing 128 keys and 304 values 
2022-06-30 10:46:25,609 [Listener at 0.0.0.0/42133] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-06-30 10:46:25,610 [Listener at 0.0.0.0/42133] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-06-30 10:46:25,610 [Listener at 0.0.0.0/42133] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(374)) - upgrade containerId to 0
2022-06-30 10:46:25,610 [Listener at 0.0.0.0/42133] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:25,610 [Listener at 0.0.0.0/42133] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-06-30 10:46:25,610 [Listener at 0.0.0.0/42133] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(68)) - Starting ExpiredContainerReplicaOpScrubber Service.
2022-06-30 10:46:25,612 [Listener at 0.0.0.0/42133] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2022-06-30 10:46:25,612 [Listener at 0.0.0.0/42133] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-06-30 10:46:25,613 [Listener at 0.0.0.0/42133] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-06-30 10:46:25,613 [Listener at 0.0.0.0/42133] INFO  replication.ReplicationManager (ReplicationManager.java:start(178)) - Starting Replication Monitor Thread.
2022-06-30 10:46:25,613 [Listener at 0.0.0.0/42133] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-06-30 10:46:25,614 [Listener at 0.0.0.0/42133] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:25,616 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(227)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-06-30 10:46:25,617 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:25,617 [Listener at 0.0.0.0/34485] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:25,622 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:25,625 [Listener at 0.0.0.0/44527] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:25,625 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:25,638 [Listener at 0.0.0.0/36201] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2022-06-30 10:46:25,638 [Listener at 0.0.0.0/36201] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(401)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-06-30 10:46:25,639 [Listener at 0.0.0.0/36201] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(228)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-06-30 10:46:25,639 [Listener at 0.0.0.0/36201] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(228)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=true, preCheckPassed=true}.
2022-06-30 10:46:25,640 [Listener at 0.0.0.0/36201] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1514)) - Container Balancer is not running.
2022-06-30 10:46:25,640 [Listener at 0.0.0.0/36201] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1521)) - Stopping Replication Manager Service.
2022-06-30 10:46:25,640 [Listener at 0.0.0.0/36201] INFO  replication.ReplicationManager (ReplicationManager.java:stop(211)) - Stopping Replication Monitor Thread.
2022-06-30 10:46:25,640 [Listener at 0.0.0.0/36201] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1528)) - Stopping the Datanode Admin Monitor.
2022-06-30 10:46:25,640 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(321)) - Replication Monitor Thread is stopped
2022-06-30 10:46:25,641 [Listener at 0.0.0.0/36201] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1535)) - Stopping Lease Manager of the command watchers
2022-06-30 10:46:25,642 [Listener at 0.0.0.0/36201] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1538)) - Lease Manager of the command watchers stop failed
2022-06-30 10:46:25,642 [Listener at 0.0.0.0/36201] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1542)) - Stopping datanode service RPC server
2022-06-30 10:46:25,642 [Listener at 0.0.0.0/36201] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(408)) - Stopping the RPC server for DataNodes
2022-06-30 10:46:25,642 [Listener at 0.0.0.0/36201] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 34485
2022-06-30 10:46:25,642 [Listener at 0.0.0.0/36201] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1550)) - Stopping block service RPC server
2022-06-30 10:46:25,642 [Listener at 0.0.0.0/36201] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-06-30 10:46:25,643 [Listener at 0.0.0.0/36201] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 44527
2022-06-30 10:46:25,643 [Listener at 0.0.0.0/36201] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1557)) - Stopping the StorageContainerLocationProtocol RPC server
2022-06-30 10:46:25,643 [Listener at 0.0.0.0/36201] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(178)) - Stopping the RPC server for Client Protocol
2022-06-30 10:46:25,643 [Listener at 0.0.0.0/36201] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 36201
2022-06-30 10:46:25,643 [Listener at 0.0.0.0/36201] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1564)) - Stopping Storage Container Manager HTTP server.
2022-06-30 10:46:25,643 [Listener at 0.0.0.0/36201] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1567)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1565)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:195)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptAfterEachMethod(TimeoutExtension.java:108)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeAfterEachMethodAdapter$22(ClassBasedTestDescriptor.java:496)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAfterEachMethods$10(TestMethodTestDescriptor.java:240)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$13(TestMethodTestDescriptor.java:273)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$14(TestMethodTestDescriptor.java:273)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAllAfterMethodsOrCallbacks(TestMethodTestDescriptor.java:272)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAfterEachMethods(TestMethodTestDescriptor.java:238)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-06-30 10:46:25,644 [Listener at 0.0.0.0/36201] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1575)) - Stopping Block Manager Service.
2022-06-30 10:46:25,644 [Listener at 0.0.0.0/36201] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:25,644 [Listener at 0.0.0.0/36201] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:25,644 [Listener at 0.0.0.0/36201] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1602)) - Stopping SCM Event Queue.
2022-06-30 10:46:25,644 [Listener at 0.0.0.0/36201] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1613)) - Stopping SCM HA services.
2022-06-30 10:46:25,645 [Listener at 0.0.0.0/36201] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2022-06-30 10:46:25,645 [RatisPipelineUtilsThread - 0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(179)) - RatisPipelineUtilsThread is interrupted.
2022-06-30 10:46:25,645 [Listener at 0.0.0.0/36201] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(126)) - Stopping BackgroundPipelineScrubber Service.
2022-06-30 10:46:25,645 [BackgroundPipelineScrubberThread] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(110)) - BackgroundPipelineScrubber is interrupted, exit
2022-06-30 10:46:25,646 [Listener at 0.0.0.0/36201] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1623)) - Stopping SCM MetadataStore.
]]></system-out>
  </testcase>
  <testcase name="testAllocateBlock" classname="org.apache.hadoop.hdds.scm.block.TestBlockManager" time="0.262">
    <system-out><![CDATA[2022-06-30 10:46:25,689 [Listener at 0.0.0.0/36201] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:25,689 [Listener at 0.0.0.0/36201] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:25,700 [Listener at 0.0.0.0/36201] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:25,700 [Listener at 0.0.0.0/36201] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:25,701 [Listener at 0.0.0.0/36201] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/50fc75c9-08d3-4e47-9b25-02e66dda286c
2022-06-30 10:46:25,702 [Listener at 0.0.0.0/36201] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/29b6956b-8494-491a-9148-cb62d2aa9c53
2022-06-30 10:46:25,702 [Listener at 0.0.0.0/36201] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/1b2d907e-b3f8-4461-bb68-56f00e86b560
2022-06-30 10:46:25,702 [Listener at 0.0.0.0/36201] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/b24dabc5-145b-414a-93b5-8f992da6bf76
2022-06-30 10:46:25,702 [Listener at 0.0.0.0/36201] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/63e4a040-f3b1-4c5d-b4c9-a25c2cb9d316
2022-06-30 10:46:25,702 [Listener at 0.0.0.0/36201] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/0acdf2f5-9785-44c9-930f-403f3b201521
2022-06-30 10:46:25,702 [Listener at 0.0.0.0/36201] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/d942d495-fc36-493d-a22e-82df42bf19e6
2022-06-30 10:46:25,703 [Listener at 0.0.0.0/36201] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/4bd1b897-c7b1-412b-8c8f-41eb67d54226
2022-06-30 10:46:25,703 [Listener at 0.0.0.0/36201] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/387afa6b-b65e-45e2-b1ef-14f8a914449f
2022-06-30 10:46:25,703 [Listener at 0.0.0.0/36201] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/664b465e-a220-425c-ad6a-d38fba1e3a8e
2022-06-30 10:46:25,703 [Listener at 0.0.0.0/36201] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:25,704 [Listener at 0.0.0.0/36201] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:25,820 [Listener at 0.0.0.0/36201] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:25,820 [Listener at 0.0.0.0/36201] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-06-30 10:46:25,821 [Listener at 0.0.0.0/36201] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:25,821 [Listener at 0.0.0.0/36201] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2022-06-30 10:46:25,822 [Listener at 0.0.0.0/36201] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2022-06-30 10:46:25,822 [Listener at 0.0.0.0/36201] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(68)) - Starting BackgroundPipelineScrubber Service.
2022-06-30 10:46:25,822 [Listener at 0.0.0.0/36201] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-06-30 10:46:25,822 [Listener at 0.0.0.0/36201] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2022-06-30 10:46:25,823 [Listener at 0.0.0.0/36201] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:25,823 [Listener at 0.0.0.0/36201] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-06-30 10:46:25,823 [Listener at 0.0.0.0/36201] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-06-30 10:46:25,824 [Listener at 0.0.0.0/36201] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-06-30 10:46:25,824 [Listener at 0.0.0.0/36201] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:25,825 [Listener at 0.0.0.0/36201] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:25,825 [Listener at 0.0.0.0/36201] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(209)) - ServiceID for StorageContainerManager is null
2022-06-30 10:46:25,826 [Listener at 0.0.0.0/36201] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(214)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-06-30 10:46:25,826 [Listener at 0.0.0.0/36201] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:25,827 [Listener at 0.0.0.0/36201] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:25,828 [Listener at 0.0.0.0/36201] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(82)) - Initializing Layout version manager with metadata layout = DATANODE_SCHEMA_V3 (version = 4), software layout = DATANODE_SCHEMA_V3 (version = 4)
2022-06-30 10:46:25,828 [Listener at 0.0.0.0/36201] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:87)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.initializeSystemManagers(StorageContainerManager.java:587)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:371)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:536)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:644)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptBeforeEachMethod(TimeoutExtension.java:76)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeBeforeEachMethodAdapter$21(ClassBasedTestDescriptor.java:491)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeEachMethods$3(TestMethodTestDescriptor.java:171)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeMethodsOrCallbacksUntilExceptionOccurs$6(TestMethodTestDescriptor.java:199)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeMethodsOrCallbacksUntilExceptionOccurs(TestMethodTestDescriptor.java:199)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeEachMethods(TestMethodTestDescriptor.java:168)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 85 more
2022-06-30 10:46:25,859 [Listener at 0.0.0.0/36201] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 30 ms to scan 6 urls, producing 128 keys and 304 values 
2022-06-30 10:46:25,860 [Listener at 0.0.0.0/36201] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-06-30 10:46:25,860 [Listener at 0.0.0.0/36201] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-06-30 10:46:25,860 [Listener at 0.0.0.0/36201] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(374)) - upgrade containerId to 0
2022-06-30 10:46:25,860 [Listener at 0.0.0.0/36201] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:25,861 [Listener at 0.0.0.0/36201] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-06-30 10:46:25,861 [Listener at 0.0.0.0/36201] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(68)) - Starting ExpiredContainerReplicaOpScrubber Service.
2022-06-30 10:46:25,861 [Listener at 0.0.0.0/36201] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2022-06-30 10:46:25,862 [Listener at 0.0.0.0/36201] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-06-30 10:46:25,863 [Listener at 0.0.0.0/36201] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-06-30 10:46:25,863 [Listener at 0.0.0.0/36201] INFO  replication.ReplicationManager (ReplicationManager.java:start(178)) - Starting Replication Monitor Thread.
2022-06-30 10:46:25,864 [Listener at 0.0.0.0/36201] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-06-30 10:46:25,864 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(227)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-06-30 10:46:25,864 [Listener at 0.0.0.0/36201] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:25,865 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:25,866 [Listener at 0.0.0.0/35045] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:25,870 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:25,871 [Listener at 0.0.0.0/45911] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:25,872 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:25,890 [Listener at 0.0.0.0/43561] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2022-06-30 10:46:25,891 [Listener at 0.0.0.0/43561] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(401)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-06-30 10:46:25,892 [Listener at 0.0.0.0/43561] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(228)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-06-30 10:46:25,897 [Listener at 0.0.0.0/43561] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=5302dcac-12d6-4fbe-9d05-1467018924f4 to datanode:50fc75c9-08d3-4e47-9b25-02e66dda286c
2022-06-30 10:46:25,900 [Listener at 0.0.0.0/43561] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=5302dcac-12d6-4fbe-9d05-1467018924f4 to datanode:63e4a040-f3b1-4c5d-b4c9-a25c2cb9d316
2022-06-30 10:46:25,900 [Listener at 0.0.0.0/43561] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=5302dcac-12d6-4fbe-9d05-1467018924f4 to datanode:29b6956b-8494-491a-9148-cb62d2aa9c53
2022-06-30 10:46:25,901 [Listener at 0.0.0.0/43561] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 5302dcac-12d6-4fbe-9d05-1467018924f4, Nodes: 50fc75c9-08d3-4e47-9b25-02e66dda286c{ip: 149.210.209.155, host: localhost-149.210.209.155, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}63e4a040-f3b1-4c5d-b4c9-a25c2cb9d316{ip: 23.55.138.46, host: localhost-23.55.138.46, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}29b6956b-8494-491a-9148-cb62d2aa9c53{ip: 222.221.183.135, host: localhost-222.221.183.135, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:25.897Z[Etc/UTC]].
2022-06-30 10:46:25,901 [Listener at 0.0.0.0/43561] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: 5302dcac-12d6-4fbe-9d05-1467018924f4, Nodes: 50fc75c9-08d3-4e47-9b25-02e66dda286c{ip: 149.210.209.155, host: localhost-149.210.209.155, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}63e4a040-f3b1-4c5d-b4c9-a25c2cb9d316{ip: 23.55.138.46, host: localhost-23.55.138.46, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}29b6956b-8494-491a-9148-cb62d2aa9c53{ip: 222.221.183.135, host: localhost-222.221.183.135, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:25.897Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:25,902 [Listener at 0.0.0.0/43561] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-06-30 10:46:25,903 [Listener at 0.0.0.0/43561] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-06-30 10:46:25,903 [Listener at 0.0.0.0/43561] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-06-30 10:46:25,903 [Listener at 0.0.0.0/43561] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1514)) - Container Balancer is not running.
2022-06-30 10:46:25,903 [Listener at 0.0.0.0/43561] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1521)) - Stopping Replication Manager Service.
2022-06-30 10:46:25,903 [Listener at 0.0.0.0/43561] INFO  replication.ReplicationManager (ReplicationManager.java:stop(211)) - Stopping Replication Monitor Thread.
2022-06-30 10:46:25,904 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(321)) - Replication Monitor Thread is stopped
2022-06-30 10:46:25,905 [Listener at 0.0.0.0/43561] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1528)) - Stopping the Datanode Admin Monitor.
2022-06-30 10:46:25,905 [Listener at 0.0.0.0/43561] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1535)) - Stopping Lease Manager of the command watchers
2022-06-30 10:46:25,906 [Listener at 0.0.0.0/43561] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1538)) - Lease Manager of the command watchers stop failed
2022-06-30 10:46:25,906 [Listener at 0.0.0.0/43561] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1542)) - Stopping datanode service RPC server
2022-06-30 10:46:25,906 [Listener at 0.0.0.0/43561] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(408)) - Stopping the RPC server for DataNodes
2022-06-30 10:46:25,906 [Listener at 0.0.0.0/43561] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 35045
2022-06-30 10:46:25,906 [Listener at 0.0.0.0/43561] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1550)) - Stopping block service RPC server
2022-06-30 10:46:25,906 [Listener at 0.0.0.0/43561] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-06-30 10:46:25,907 [Listener at 0.0.0.0/43561] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 45911
2022-06-30 10:46:25,907 [Listener at 0.0.0.0/43561] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1557)) - Stopping the StorageContainerLocationProtocol RPC server
2022-06-30 10:46:25,907 [Listener at 0.0.0.0/43561] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(178)) - Stopping the RPC server for Client Protocol
2022-06-30 10:46:25,907 [Listener at 0.0.0.0/43561] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 43561
2022-06-30 10:46:25,907 [Listener at 0.0.0.0/43561] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1564)) - Stopping Storage Container Manager HTTP server.
2022-06-30 10:46:25,908 [Listener at 0.0.0.0/43561] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1567)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1565)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:195)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptAfterEachMethod(TimeoutExtension.java:108)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeAfterEachMethodAdapter$22(ClassBasedTestDescriptor.java:496)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAfterEachMethods$10(TestMethodTestDescriptor.java:240)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$13(TestMethodTestDescriptor.java:273)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$14(TestMethodTestDescriptor.java:273)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAllAfterMethodsOrCallbacks(TestMethodTestDescriptor.java:272)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAfterEachMethods(TestMethodTestDescriptor.java:238)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-06-30 10:46:25,908 [Listener at 0.0.0.0/43561] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1575)) - Stopping Block Manager Service.
2022-06-30 10:46:25,908 [Listener at 0.0.0.0/43561] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:25,908 [Listener at 0.0.0.0/43561] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:25,908 [Listener at 0.0.0.0/43561] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1602)) - Stopping SCM Event Queue.
2022-06-30 10:46:25,909 [Listener at 0.0.0.0/43561] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1613)) - Stopping SCM HA services.
2022-06-30 10:46:25,909 [Listener at 0.0.0.0/43561] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2022-06-30 10:46:25,909 [RatisPipelineUtilsThread - 0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(179)) - RatisPipelineUtilsThread is interrupted.
2022-06-30 10:46:25,909 [Listener at 0.0.0.0/43561] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(126)) - Stopping BackgroundPipelineScrubber Service.
2022-06-30 10:46:25,909 [BackgroundPipelineScrubberThread] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(110)) - BackgroundPipelineScrubber is interrupted, exit
2022-06-30 10:46:25,910 [Listener at 0.0.0.0/43561] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1623)) - Stopping SCM MetadataStore.
]]></system-out>
  </testcase>
  <testcase name="testBlockDistributionWithMultipleDisks" classname="org.apache.hadoop.hdds.scm.block.TestBlockManager" time="0.251">
    <system-out><![CDATA[2022-06-30 10:46:25,935 [Listener at 0.0.0.0/43561] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:25,936 [Listener at 0.0.0.0/43561] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:25,949 [Listener at 0.0.0.0/43561] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:25,949 [Listener at 0.0.0.0/43561] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:25,954 [Listener at 0.0.0.0/43561] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/717cf82f-dbaa-488f-bbf0-0d75a37b41a7
2022-06-30 10:46:25,954 [Listener at 0.0.0.0/43561] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/1cf8963d-680c-4bcd-b260-39d2d248d6f6
2022-06-30 10:46:25,955 [Listener at 0.0.0.0/43561] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/4ce7b6d5-1e72-448b-a688-af8c75f7519c
2022-06-30 10:46:25,955 [Listener at 0.0.0.0/43561] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/73fe4916-e205-422d-8c15-27857a975f42
2022-06-30 10:46:25,955 [Listener at 0.0.0.0/43561] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/74fe4574-9078-4015-a80c-3ffdcde07d87
2022-06-30 10:46:25,956 [Listener at 0.0.0.0/43561] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/5cd52c43-45a5-4ddd-b8d3-083ce0fd6848
2022-06-30 10:46:25,956 [Listener at 0.0.0.0/43561] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/284df39a-4151-4b39-933d-94024d10ca10
2022-06-30 10:46:25,956 [Listener at 0.0.0.0/43561] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/734efcc0-729b-4b2b-947f-6bacc974a67b
2022-06-30 10:46:25,956 [Listener at 0.0.0.0/43561] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/a20b7bc1-10e9-409a-ac73-d9ce54ade6e2
2022-06-30 10:46:25,956 [Listener at 0.0.0.0/43561] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/073b659c-5b6d-44d7-a6e7-a119a2791997
2022-06-30 10:46:25,957 [Listener at 0.0.0.0/43561] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:25,958 [Listener at 0.0.0.0/43561] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:26,074 [Listener at 0.0.0.0/43561] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:26,074 [Listener at 0.0.0.0/43561] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-06-30 10:46:26,075 [Listener at 0.0.0.0/43561] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:26,075 [Listener at 0.0.0.0/43561] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2022-06-30 10:46:26,075 [Listener at 0.0.0.0/43561] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2022-06-30 10:46:26,076 [Listener at 0.0.0.0/43561] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(68)) - Starting BackgroundPipelineScrubber Service.
2022-06-30 10:46:26,076 [Listener at 0.0.0.0/43561] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-06-30 10:46:26,076 [Listener at 0.0.0.0/43561] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2022-06-30 10:46:26,076 [Listener at 0.0.0.0/43561] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:26,077 [Listener at 0.0.0.0/43561] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-06-30 10:46:26,077 [Listener at 0.0.0.0/43561] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-06-30 10:46:26,077 [Listener at 0.0.0.0/43561] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-06-30 10:46:26,077 [Listener at 0.0.0.0/43561] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:26,079 [Listener at 0.0.0.0/43561] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:26,079 [Listener at 0.0.0.0/43561] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(209)) - ServiceID for StorageContainerManager is null
2022-06-30 10:46:26,080 [Listener at 0.0.0.0/43561] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(214)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-06-30 10:46:26,080 [Listener at 0.0.0.0/43561] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:26,081 [Listener at 0.0.0.0/43561] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:26,082 [Listener at 0.0.0.0/43561] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(82)) - Initializing Layout version manager with metadata layout = DATANODE_SCHEMA_V3 (version = 4), software layout = DATANODE_SCHEMA_V3 (version = 4)
2022-06-30 10:46:26,082 [Listener at 0.0.0.0/43561] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:87)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.initializeSystemManagers(StorageContainerManager.java:587)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:371)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:536)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:644)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptBeforeEachMethod(TimeoutExtension.java:76)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeBeforeEachMethodAdapter$21(ClassBasedTestDescriptor.java:491)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeEachMethods$3(TestMethodTestDescriptor.java:171)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeMethodsOrCallbacksUntilExceptionOccurs$6(TestMethodTestDescriptor.java:199)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeMethodsOrCallbacksUntilExceptionOccurs(TestMethodTestDescriptor.java:199)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeEachMethods(TestMethodTestDescriptor.java:168)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 85 more
2022-06-30 10:46:26,112 [Listener at 0.0.0.0/43561] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 29 ms to scan 6 urls, producing 128 keys and 304 values 
2022-06-30 10:46:26,114 [Listener at 0.0.0.0/43561] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-06-30 10:46:26,114 [Listener at 0.0.0.0/43561] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-06-30 10:46:26,114 [Listener at 0.0.0.0/43561] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(374)) - upgrade containerId to 0
2022-06-30 10:46:26,114 [Listener at 0.0.0.0/43561] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:26,114 [Listener at 0.0.0.0/43561] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-06-30 10:46:26,115 [Listener at 0.0.0.0/43561] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(68)) - Starting ExpiredContainerReplicaOpScrubber Service.
2022-06-30 10:46:26,115 [Listener at 0.0.0.0/43561] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2022-06-30 10:46:26,115 [Listener at 0.0.0.0/43561] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-06-30 10:46:26,116 [Listener at 0.0.0.0/43561] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-06-30 10:46:26,116 [Listener at 0.0.0.0/43561] INFO  replication.ReplicationManager (ReplicationManager.java:start(178)) - Starting Replication Monitor Thread.
2022-06-30 10:46:26,116 [Listener at 0.0.0.0/43561] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-06-30 10:46:26,117 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(227)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-06-30 10:46:26,117 [Listener at 0.0.0.0/43561] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:26,117 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:26,118 [Listener at 0.0.0.0/39037] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:26,118 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:26,119 [Listener at 0.0.0.0/38973] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:26,120 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:26,134 [Listener at 0.0.0.0/37477] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2022-06-30 10:46:26,134 [Listener at 0.0.0.0/37477] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(401)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-06-30 10:46:26,134 [Listener at 0.0.0.0/37477] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(228)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-06-30 10:46:26,135 [Listener at 0.0.0.0/37477] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=6d39abb0-1cab-4384-972e-a3374f7d1218 to datanode:4ce7b6d5-1e72-448b-a688-af8c75f7519c
2022-06-30 10:46:26,143 [Listener at 0.0.0.0/37477] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=6d39abb0-1cab-4384-972e-a3374f7d1218 to datanode:717cf82f-dbaa-488f-bbf0-0d75a37b41a7
2022-06-30 10:46:26,143 [Listener at 0.0.0.0/37477] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=6d39abb0-1cab-4384-972e-a3374f7d1218 to datanode:284df39a-4151-4b39-933d-94024d10ca10
2022-06-30 10:46:26,144 [Listener at 0.0.0.0/37477] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 6d39abb0-1cab-4384-972e-a3374f7d1218, Nodes: 4ce7b6d5-1e72-448b-a688-af8c75f7519c{ip: 184.193.3.83, host: localhost-184.193.3.83, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}717cf82f-dbaa-488f-bbf0-0d75a37b41a7{ip: 44.151.35.64, host: localhost-44.151.35.64, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}284df39a-4151-4b39-933d-94024d10ca10{ip: 70.49.194.112, host: localhost-70.49.194.112, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:26.135Z[Etc/UTC]].
2022-06-30 10:46:26,144 [Listener at 0.0.0.0/37477] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: 6d39abb0-1cab-4384-972e-a3374f7d1218, Nodes: 4ce7b6d5-1e72-448b-a688-af8c75f7519c{ip: 184.193.3.83, host: localhost-184.193.3.83, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}717cf82f-dbaa-488f-bbf0-0d75a37b41a7{ip: 44.151.35.64, host: localhost-44.151.35.64, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}284df39a-4151-4b39-933d-94024d10ca10{ip: 70.49.194.112, host: localhost-70.49.194.112, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:26.135Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:26,147 [pool-292-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-06-30 10:46:26,148 [pool-292-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-06-30 10:46:26,148 [pool-292-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-06-30 10:46:26,159 [Listener at 0.0.0.0/37477] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1514)) - Container Balancer is not running.
2022-06-30 10:46:26,162 [Listener at 0.0.0.0/37477] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1521)) - Stopping Replication Manager Service.
2022-06-30 10:46:26,162 [Listener at 0.0.0.0/37477] INFO  replication.ReplicationManager (ReplicationManager.java:stop(211)) - Stopping Replication Monitor Thread.
2022-06-30 10:46:26,163 [Listener at 0.0.0.0/37477] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1528)) - Stopping the Datanode Admin Monitor.
2022-06-30 10:46:26,163 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(321)) - Replication Monitor Thread is stopped
2022-06-30 10:46:26,163 [Listener at 0.0.0.0/37477] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1535)) - Stopping Lease Manager of the command watchers
2022-06-30 10:46:26,163 [Listener at 0.0.0.0/37477] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1538)) - Lease Manager of the command watchers stop failed
2022-06-30 10:46:26,163 [Listener at 0.0.0.0/37477] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1542)) - Stopping datanode service RPC server
2022-06-30 10:46:26,163 [Listener at 0.0.0.0/37477] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(408)) - Stopping the RPC server for DataNodes
2022-06-30 10:46:26,163 [Listener at 0.0.0.0/37477] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 39037
2022-06-30 10:46:26,164 [Listener at 0.0.0.0/37477] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1550)) - Stopping block service RPC server
2022-06-30 10:46:26,164 [Listener at 0.0.0.0/37477] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-06-30 10:46:26,164 [Listener at 0.0.0.0/37477] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 38973
2022-06-30 10:46:26,164 [Listener at 0.0.0.0/37477] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1557)) - Stopping the StorageContainerLocationProtocol RPC server
2022-06-30 10:46:26,164 [Listener at 0.0.0.0/37477] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(178)) - Stopping the RPC server for Client Protocol
2022-06-30 10:46:26,164 [Listener at 0.0.0.0/37477] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 37477
2022-06-30 10:46:26,165 [Listener at 0.0.0.0/37477] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1564)) - Stopping Storage Container Manager HTTP server.
2022-06-30 10:46:26,165 [Listener at 0.0.0.0/37477] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1567)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1565)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:195)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptAfterEachMethod(TimeoutExtension.java:108)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeAfterEachMethodAdapter$22(ClassBasedTestDescriptor.java:496)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAfterEachMethods$10(TestMethodTestDescriptor.java:240)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$13(TestMethodTestDescriptor.java:273)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$14(TestMethodTestDescriptor.java:273)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAllAfterMethodsOrCallbacks(TestMethodTestDescriptor.java:272)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAfterEachMethods(TestMethodTestDescriptor.java:238)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-06-30 10:46:26,165 [Listener at 0.0.0.0/37477] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1575)) - Stopping Block Manager Service.
2022-06-30 10:46:26,165 [Listener at 0.0.0.0/37477] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:26,165 [Listener at 0.0.0.0/37477] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:26,165 [Listener at 0.0.0.0/37477] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1602)) - Stopping SCM Event Queue.
2022-06-30 10:46:26,166 [Listener at 0.0.0.0/37477] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1613)) - Stopping SCM HA services.
2022-06-30 10:46:26,166 [Listener at 0.0.0.0/37477] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2022-06-30 10:46:26,166 [RatisPipelineUtilsThread - 0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(179)) - RatisPipelineUtilsThread is interrupted.
2022-06-30 10:46:26,166 [Listener at 0.0.0.0/37477] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(126)) - Stopping BackgroundPipelineScrubber Service.
2022-06-30 10:46:26,166 [BackgroundPipelineScrubberThread] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(110)) - BackgroundPipelineScrubber is interrupted, exit
2022-06-30 10:46:26,166 [Listener at 0.0.0.0/37477] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1623)) - Stopping SCM MetadataStore.
]]></system-out>
  </testcase>
  <testcase name="testBlockDistribution" classname="org.apache.hadoop.hdds.scm.block.TestBlockManager" time="0.24">
    <system-out><![CDATA[2022-06-30 10:46:26,188 [Listener at 0.0.0.0/37477] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:26,188 [Listener at 0.0.0.0/37477] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:26,197 [Listener at 0.0.0.0/37477] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:26,197 [Listener at 0.0.0.0/37477] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:26,198 [Listener at 0.0.0.0/37477] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/fa8d005f-d219-4ff5-97c4-0a168bc29025
2022-06-30 10:46:26,199 [Listener at 0.0.0.0/37477] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/b1806146-a49a-4ab0-ac04-de1ac8d089fb
2022-06-30 10:46:26,199 [Listener at 0.0.0.0/37477] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/66b2babe-8701-4459-b3d0-5ebd6a2c21f2
2022-06-30 10:46:26,199 [Listener at 0.0.0.0/37477] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/f2af6ecf-97c8-4482-874f-0b9161df47bc
2022-06-30 10:46:26,199 [Listener at 0.0.0.0/37477] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/abead839-7c2d-45cd-a713-03adca7d9129
2022-06-30 10:46:26,199 [Listener at 0.0.0.0/37477] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/4a95b920-ff78-49aa-b079-0c88ece7f07a
2022-06-30 10:46:26,199 [Listener at 0.0.0.0/37477] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/9d0e6154-fa36-46f1-ba0d-9dcb9003f9b6
2022-06-30 10:46:26,199 [Listener at 0.0.0.0/37477] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/25138556-6809-4a62-9274-af711909068f
2022-06-30 10:46:26,200 [Listener at 0.0.0.0/37477] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/7800a5e3-9c0c-4db9-bfe4-9bbb021a3ebe
2022-06-30 10:46:26,200 [Listener at 0.0.0.0/37477] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/aa44c13a-a2df-4964-9279-56dcaf7b4b14
2022-06-30 10:46:26,200 [Listener at 0.0.0.0/37477] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:26,201 [Listener at 0.0.0.0/37477] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:26,320 [Listener at 0.0.0.0/37477] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:26,320 [Listener at 0.0.0.0/37477] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-06-30 10:46:26,321 [Listener at 0.0.0.0/37477] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:26,321 [Listener at 0.0.0.0/37477] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2022-06-30 10:46:26,321 [Listener at 0.0.0.0/37477] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2022-06-30 10:46:26,322 [Listener at 0.0.0.0/37477] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(68)) - Starting BackgroundPipelineScrubber Service.
2022-06-30 10:46:26,322 [Listener at 0.0.0.0/37477] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-06-30 10:46:26,322 [Listener at 0.0.0.0/37477] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2022-06-30 10:46:26,322 [Listener at 0.0.0.0/37477] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:26,323 [Listener at 0.0.0.0/37477] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-06-30 10:46:26,323 [Listener at 0.0.0.0/37477] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-06-30 10:46:26,323 [Listener at 0.0.0.0/37477] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-06-30 10:46:26,323 [Listener at 0.0.0.0/37477] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:26,325 [Listener at 0.0.0.0/37477] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:26,325 [Listener at 0.0.0.0/37477] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(209)) - ServiceID for StorageContainerManager is null
2022-06-30 10:46:26,325 [Listener at 0.0.0.0/37477] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(214)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-06-30 10:46:26,326 [Listener at 0.0.0.0/37477] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:26,326 [Listener at 0.0.0.0/37477] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:26,327 [Listener at 0.0.0.0/37477] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(82)) - Initializing Layout version manager with metadata layout = DATANODE_SCHEMA_V3 (version = 4), software layout = DATANODE_SCHEMA_V3 (version = 4)
2022-06-30 10:46:26,328 [Listener at 0.0.0.0/37477] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:87)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.initializeSystemManagers(StorageContainerManager.java:587)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:371)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:536)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:644)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptBeforeEachMethod(TimeoutExtension.java:76)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeBeforeEachMethodAdapter$21(ClassBasedTestDescriptor.java:491)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeEachMethods$3(TestMethodTestDescriptor.java:171)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeMethodsOrCallbacksUntilExceptionOccurs$6(TestMethodTestDescriptor.java:199)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeMethodsOrCallbacksUntilExceptionOccurs(TestMethodTestDescriptor.java:199)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeEachMethods(TestMethodTestDescriptor.java:168)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 85 more
2022-06-30 10:46:26,359 [Listener at 0.0.0.0/37477] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 29 ms to scan 6 urls, producing 128 keys and 304 values 
2022-06-30 10:46:26,360 [Listener at 0.0.0.0/37477] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-06-30 10:46:26,360 [Listener at 0.0.0.0/37477] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-06-30 10:46:26,360 [Listener at 0.0.0.0/37477] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(374)) - upgrade containerId to 0
2022-06-30 10:46:26,360 [Listener at 0.0.0.0/37477] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:26,361 [Listener at 0.0.0.0/37477] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-06-30 10:46:26,361 [Listener at 0.0.0.0/37477] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(68)) - Starting ExpiredContainerReplicaOpScrubber Service.
2022-06-30 10:46:26,361 [Listener at 0.0.0.0/37477] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2022-06-30 10:46:26,361 [Listener at 0.0.0.0/37477] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-06-30 10:46:26,362 [Listener at 0.0.0.0/37477] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-06-30 10:46:26,362 [Listener at 0.0.0.0/37477] INFO  replication.ReplicationManager (ReplicationManager.java:start(178)) - Starting Replication Monitor Thread.
2022-06-30 10:46:26,364 [Listener at 0.0.0.0/37477] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-06-30 10:46:26,364 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(227)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-06-30 10:46:26,365 [Listener at 0.0.0.0/37477] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:26,365 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:26,367 [Listener at 0.0.0.0/42061] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:26,370 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:26,372 [Listener at 0.0.0.0/34217] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:26,374 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:26,388 [Listener at 0.0.0.0/44947] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2022-06-30 10:46:26,389 [Listener at 0.0.0.0/44947] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(401)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-06-30 10:46:26,389 [Listener at 0.0.0.0/44947] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(228)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-06-30 10:46:26,390 [Listener at 0.0.0.0/44947] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=f2d790c1-4831-4414-a824-f53bce14a176 to datanode:abead839-7c2d-45cd-a713-03adca7d9129
2022-06-30 10:46:26,390 [Listener at 0.0.0.0/44947] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=f2d790c1-4831-4414-a824-f53bce14a176 to datanode:9d0e6154-fa36-46f1-ba0d-9dcb9003f9b6
2022-06-30 10:46:26,390 [Listener at 0.0.0.0/44947] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=f2d790c1-4831-4414-a824-f53bce14a176 to datanode:66b2babe-8701-4459-b3d0-5ebd6a2c21f2
2022-06-30 10:46:26,391 [Listener at 0.0.0.0/44947] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: f2d790c1-4831-4414-a824-f53bce14a176, Nodes: abead839-7c2d-45cd-a713-03adca7d9129{ip: 119.234.91.97, host: localhost-119.234.91.97, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}9d0e6154-fa36-46f1-ba0d-9dcb9003f9b6{ip: 181.75.4.99, host: localhost-181.75.4.99, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}66b2babe-8701-4459-b3d0-5ebd6a2c21f2{ip: 15.29.181.119, host: localhost-15.29.181.119, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:26.390Z[Etc/UTC]].
2022-06-30 10:46:26,391 [Listener at 0.0.0.0/44947] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: f2d790c1-4831-4414-a824-f53bce14a176, Nodes: abead839-7c2d-45cd-a713-03adca7d9129{ip: 119.234.91.97, host: localhost-119.234.91.97, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}9d0e6154-fa36-46f1-ba0d-9dcb9003f9b6{ip: 181.75.4.99, host: localhost-181.75.4.99, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}66b2babe-8701-4459-b3d0-5ebd6a2c21f2{ip: 15.29.181.119, host: localhost-15.29.181.119, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:26.390Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:26,393 [pool-327-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-06-30 10:46:26,395 [pool-327-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-06-30 10:46:26,395 [pool-327-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-06-30 10:46:26,400 [Listener at 0.0.0.0/44947] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1514)) - Container Balancer is not running.
2022-06-30 10:46:26,400 [Listener at 0.0.0.0/44947] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1521)) - Stopping Replication Manager Service.
2022-06-30 10:46:26,400 [Listener at 0.0.0.0/44947] INFO  replication.ReplicationManager (ReplicationManager.java:stop(211)) - Stopping Replication Monitor Thread.
2022-06-30 10:46:26,400 [Listener at 0.0.0.0/44947] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1528)) - Stopping the Datanode Admin Monitor.
2022-06-30 10:46:26,400 [Listener at 0.0.0.0/44947] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1535)) - Stopping Lease Manager of the command watchers
2022-06-30 10:46:26,401 [Listener at 0.0.0.0/44947] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1538)) - Lease Manager of the command watchers stop failed
2022-06-30 10:46:26,401 [Listener at 0.0.0.0/44947] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1542)) - Stopping datanode service RPC server
2022-06-30 10:46:26,401 [Listener at 0.0.0.0/44947] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(408)) - Stopping the RPC server for DataNodes
2022-06-30 10:46:26,401 [Listener at 0.0.0.0/44947] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 42061
2022-06-30 10:46:26,401 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(321)) - Replication Monitor Thread is stopped
2022-06-30 10:46:26,402 [Listener at 0.0.0.0/44947] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1550)) - Stopping block service RPC server
2022-06-30 10:46:26,403 [Listener at 0.0.0.0/44947] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-06-30 10:46:26,403 [Listener at 0.0.0.0/44947] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 34217
2022-06-30 10:46:26,403 [Listener at 0.0.0.0/44947] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1557)) - Stopping the StorageContainerLocationProtocol RPC server
2022-06-30 10:46:26,403 [Listener at 0.0.0.0/44947] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(178)) - Stopping the RPC server for Client Protocol
2022-06-30 10:46:26,403 [Listener at 0.0.0.0/44947] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 44947
2022-06-30 10:46:26,403 [Listener at 0.0.0.0/44947] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1564)) - Stopping Storage Container Manager HTTP server.
2022-06-30 10:46:26,404 [Listener at 0.0.0.0/44947] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1567)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1565)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:195)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptAfterEachMethod(TimeoutExtension.java:108)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeAfterEachMethodAdapter$22(ClassBasedTestDescriptor.java:496)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAfterEachMethods$10(TestMethodTestDescriptor.java:240)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$13(TestMethodTestDescriptor.java:273)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$14(TestMethodTestDescriptor.java:273)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAllAfterMethodsOrCallbacks(TestMethodTestDescriptor.java:272)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAfterEachMethods(TestMethodTestDescriptor.java:238)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-06-30 10:46:26,404 [Listener at 0.0.0.0/44947] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1575)) - Stopping Block Manager Service.
2022-06-30 10:46:26,404 [Listener at 0.0.0.0/44947] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:26,404 [Listener at 0.0.0.0/44947] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:26,404 [Listener at 0.0.0.0/44947] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1602)) - Stopping SCM Event Queue.
2022-06-30 10:46:26,405 [Listener at 0.0.0.0/44947] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1613)) - Stopping SCM HA services.
2022-06-30 10:46:26,406 [Listener at 0.0.0.0/44947] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2022-06-30 10:46:26,406 [RatisPipelineUtilsThread - 0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(179)) - RatisPipelineUtilsThread is interrupted.
2022-06-30 10:46:26,406 [Listener at 0.0.0.0/44947] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(126)) - Stopping BackgroundPipelineScrubber Service.
2022-06-30 10:46:26,406 [BackgroundPipelineScrubberThread] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(110)) - BackgroundPipelineScrubber is interrupted, exit
2022-06-30 10:46:26,407 [Listener at 0.0.0.0/44947] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1623)) - Stopping SCM MetadataStore.
]]></system-out>
  </testcase>
  <testcase name="testAllocateBlockSucInSafeMode" classname="org.apache.hadoop.hdds.scm.block.TestBlockManager" time="0.345">
    <system-out><![CDATA[2022-06-30 10:46:26,434 [Listener at 0.0.0.0/44947] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:26,434 [Listener at 0.0.0.0/44947] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:26,444 [Listener at 0.0.0.0/44947] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:26,444 [Listener at 0.0.0.0/44947] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:26,447 [Listener at 0.0.0.0/44947] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/843e31e0-fc21-482b-a533-b54b38f153f6
2022-06-30 10:46:26,448 [Listener at 0.0.0.0/44947] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/aa006291-17ed-4b2b-a44e-8bcf06e568b5
2022-06-30 10:46:26,448 [Listener at 0.0.0.0/44947] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/e52a471f-3c3e-4afe-8f66-8d8d103aa787
2022-06-30 10:46:26,448 [Listener at 0.0.0.0/44947] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/c129a2be-5172-4163-8c26-ab61743aabe7
2022-06-30 10:46:26,448 [Listener at 0.0.0.0/44947] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/1a96dd11-4c1c-4152-ae68-94482390d171
2022-06-30 10:46:26,448 [Listener at 0.0.0.0/44947] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/9cd7419a-a70f-4e44-9d77-a31bf603d194
2022-06-30 10:46:26,448 [Listener at 0.0.0.0/44947] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/212fc562-99cf-4914-9ceb-caf80977099b
2022-06-30 10:46:26,449 [Listener at 0.0.0.0/44947] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/b2d4649f-382a-43a2-bd0b-7db891c7a2c4
2022-06-30 10:46:26,449 [Listener at 0.0.0.0/44947] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/756cc076-c94f-4fc4-9c1c-aa99430fb261
2022-06-30 10:46:26,449 [Listener at 0.0.0.0/44947] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/197a2a2c-2f67-419e-b701-b23829f8f639
2022-06-30 10:46:26,449 [Listener at 0.0.0.0/44947] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:26,450 [Listener at 0.0.0.0/44947] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:26,567 [Listener at 0.0.0.0/44947] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:26,567 [Listener at 0.0.0.0/44947] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-06-30 10:46:26,567 [Listener at 0.0.0.0/44947] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:26,568 [Listener at 0.0.0.0/44947] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2022-06-30 10:46:26,568 [Listener at 0.0.0.0/44947] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2022-06-30 10:46:26,568 [Listener at 0.0.0.0/44947] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(68)) - Starting BackgroundPipelineScrubber Service.
2022-06-30 10:46:26,568 [Listener at 0.0.0.0/44947] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-06-30 10:46:26,569 [Listener at 0.0.0.0/44947] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2022-06-30 10:46:26,569 [Listener at 0.0.0.0/44947] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-06-30 10:46:26,569 [Listener at 0.0.0.0/44947] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-06-30 10:46:26,570 [Listener at 0.0.0.0/44947] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-06-30 10:46:26,570 [Listener at 0.0.0.0/44947] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-06-30 10:46:26,570 [Listener at 0.0.0.0/44947] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:26,576 [Listener at 0.0.0.0/44947] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-06-30 10:46:26,576 [Listener at 0.0.0.0/44947] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(209)) - ServiceID for StorageContainerManager is null
2022-06-30 10:46:26,576 [Listener at 0.0.0.0/44947] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(214)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-06-30 10:46:26,577 [Listener at 0.0.0.0/44947] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-06-30 10:46:26,577 [Listener at 0.0.0.0/44947] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-06-30 10:46:26,578 [Listener at 0.0.0.0/44947] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(82)) - Initializing Layout version manager with metadata layout = DATANODE_SCHEMA_V3 (version = 4), software layout = DATANODE_SCHEMA_V3 (version = 4)
2022-06-30 10:46:26,578 [Listener at 0.0.0.0/44947] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:87)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.initializeSystemManagers(StorageContainerManager.java:587)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:371)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:536)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:644)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptBeforeEachMethod(TimeoutExtension.java:76)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeBeforeEachMethodAdapter$21(ClassBasedTestDescriptor.java:491)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeEachMethods$3(TestMethodTestDescriptor.java:171)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeBeforeMethodsOrCallbacksUntilExceptionOccurs$6(TestMethodTestDescriptor.java:199)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeMethodsOrCallbacksUntilExceptionOccurs(TestMethodTestDescriptor.java:199)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeBeforeEachMethods(TestMethodTestDescriptor.java:168)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 85 more
2022-06-30 10:46:26,614 [Listener at 0.0.0.0/44947] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 32 ms to scan 6 urls, producing 128 keys and 304 values 
2022-06-30 10:46:26,616 [Listener at 0.0.0.0/44947] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-06-30 10:46:26,616 [Listener at 0.0.0.0/44947] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-06-30 10:46:26,616 [Listener at 0.0.0.0/44947] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(374)) - upgrade containerId to 0
2022-06-30 10:46:26,616 [Listener at 0.0.0.0/44947] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-06-30 10:46:26,616 [Listener at 0.0.0.0/44947] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-06-30 10:46:26,616 [Listener at 0.0.0.0/44947] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(68)) - Starting ExpiredContainerReplicaOpScrubber Service.
2022-06-30 10:46:26,617 [Listener at 0.0.0.0/44947] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2022-06-30 10:46:26,617 [Listener at 0.0.0.0/44947] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-06-30 10:46:26,617 [Listener at 0.0.0.0/44947] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-06-30 10:46:26,618 [Listener at 0.0.0.0/44947] INFO  replication.ReplicationManager (ReplicationManager.java:start(178)) - Starting Replication Monitor Thread.
2022-06-30 10:46:26,621 [Listener at 0.0.0.0/44947] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-06-30 10:46:26,626 [Listener at 0.0.0.0/44947] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:26,627 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:26,628 [Listener at 0.0.0.0/35193] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:26,632 [Listener at 0.0.0.0/42099] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-06-30 10:46:26,632 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(227)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-06-30 10:46:26,632 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:26,635 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-06-30 10:46:26,646 [Listener at 0.0.0.0/40915] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2022-06-30 10:46:26,647 [Listener at 0.0.0.0/40915] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(401)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-06-30 10:46:26,647 [Listener at 0.0.0.0/40915] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(228)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-06-30 10:46:26,648 [Listener at 0.0.0.0/40915] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=60221bb7-d250-40f1-ab98-bd62e34acc5b to datanode:843e31e0-fc21-482b-a533-b54b38f153f6
2022-06-30 10:46:26,648 [Listener at 0.0.0.0/40915] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=60221bb7-d250-40f1-ab98-bd62e34acc5b to datanode:aa006291-17ed-4b2b-a44e-8bcf06e568b5
2022-06-30 10:46:26,648 [Listener at 0.0.0.0/40915] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(195)) - Sending CreatePipelineCommand for pipeline:PipelineID=60221bb7-d250-40f1-ab98-bd62e34acc5b to datanode:c129a2be-5172-4163-8c26-ab61743aabe7
2022-06-30 10:46:26,649 [Listener at 0.0.0.0/40915] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 60221bb7-d250-40f1-ab98-bd62e34acc5b, Nodes: 843e31e0-fc21-482b-a533-b54b38f153f6{ip: 85.29.37.129, host: localhost-85.29.37.129, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}aa006291-17ed-4b2b-a44e-8bcf06e568b5{ip: 149.121.170.43, host: localhost-149.121.170.43, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}c129a2be-5172-4163-8c26-ab61743aabe7{ip: 151.67.90.57, host: localhost-151.67.90.57, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:26.648Z[Etc/UTC]].
2022-06-30 10:46:26,649 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(358)) - Pipeline Pipeline[ Id: 60221bb7-d250-40f1-ab98-bd62e34acc5b, Nodes: 843e31e0-fc21-482b-a533-b54b38f153f6{ip: 85.29.37.129, host: localhost-85.29.37.129, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}aa006291-17ed-4b2b-a44e-8bcf06e568b5{ip: 149.121.170.43, host: localhost-149.121.170.43, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}c129a2be-5172-4163-8c26-ab61743aabe7{ip: 151.67.90.57, host: localhost-151.67.90.57, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-06-30T10:46:26.648Z[Etc/UTC]] moved to OPEN state
2022-06-30 10:46:26,750 [Listener at 0.0.0.0/40915] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-06-30 10:46:26,751 [Listener at 0.0.0.0/40915] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-06-30 10:46:26,751 [Listener at 0.0.0.0/40915] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-06-30 10:46:26,752 [Listener at 0.0.0.0/40915] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1514)) - Container Balancer is not running.
2022-06-30 10:46:26,752 [Listener at 0.0.0.0/40915] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1521)) - Stopping Replication Manager Service.
2022-06-30 10:46:26,752 [Listener at 0.0.0.0/40915] INFO  replication.ReplicationManager (ReplicationManager.java:stop(211)) - Stopping Replication Monitor Thread.
2022-06-30 10:46:26,752 [Listener at 0.0.0.0/40915] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1528)) - Stopping the Datanode Admin Monitor.
2022-06-30 10:46:26,752 [Listener at 0.0.0.0/40915] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1535)) - Stopping Lease Manager of the command watchers
2022-06-30 10:46:26,752 [Listener at 0.0.0.0/40915] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1538)) - Lease Manager of the command watchers stop failed
2022-06-30 10:46:26,752 [Listener at 0.0.0.0/40915] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1542)) - Stopping datanode service RPC server
2022-06-30 10:46:26,752 [Listener at 0.0.0.0/40915] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(408)) - Stopping the RPC server for DataNodes
2022-06-30 10:46:26,752 [Listener at 0.0.0.0/40915] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 35193
2022-06-30 10:46:26,752 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(321)) - Replication Monitor Thread is stopped
2022-06-30 10:46:26,753 [Listener at 0.0.0.0/40915] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1550)) - Stopping block service RPC server
2022-06-30 10:46:26,753 [Listener at 0.0.0.0/40915] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-06-30 10:46:26,753 [Listener at 0.0.0.0/40915] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 42099
2022-06-30 10:46:26,753 [Listener at 0.0.0.0/40915] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1557)) - Stopping the StorageContainerLocationProtocol RPC server
2022-06-30 10:46:26,754 [Listener at 0.0.0.0/40915] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(178)) - Stopping the RPC server for Client Protocol
2022-06-30 10:46:26,754 [Listener at 0.0.0.0/40915] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 40915
2022-06-30 10:46:26,754 [Listener at 0.0.0.0/40915] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1564)) - Stopping Storage Container Manager HTTP server.
2022-06-30 10:46:26,754 [Listener at 0.0.0.0/40915] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1567)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1565)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:195)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptAfterEachMethod(TimeoutExtension.java:108)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:506)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeAfterEachMethodAdapter$22(ClassBasedTestDescriptor.java:496)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAfterEachMethods$10(TestMethodTestDescriptor.java:240)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$13(TestMethodTestDescriptor.java:273)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$14(TestMethodTestDescriptor.java:273)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAllAfterMethodsOrCallbacks(TestMethodTestDescriptor.java:272)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAfterEachMethods(TestMethodTestDescriptor.java:238)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-06-30 10:46:26,754 [Listener at 0.0.0.0/40915] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1575)) - Stopping Block Manager Service.
2022-06-30 10:46:26,755 [Listener at 0.0.0.0/40915] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:26,755 [Listener at 0.0.0.0/40915] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-06-30 10:46:26,755 [Listener at 0.0.0.0/40915] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1602)) - Stopping SCM Event Queue.
2022-06-30 10:46:26,755 [Listener at 0.0.0.0/40915] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1613)) - Stopping SCM HA services.
2022-06-30 10:46:26,755 [Listener at 0.0.0.0/40915] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2022-06-30 10:46:26,755 [RatisPipelineUtilsThread - 0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(179)) - RatisPipelineUtilsThread is interrupted.
2022-06-30 10:46:26,755 [Listener at 0.0.0.0/40915] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(126)) - Stopping BackgroundPipelineScrubber Service.
2022-06-30 10:46:26,756 [BackgroundPipelineScrubberThread] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(110)) - BackgroundPipelineScrubber is interrupted, exit
2022-06-30 10:46:26,756 [Listener at 0.0.0.0/40915] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1623)) - Stopping SCM MetadataStore.
]]></system-out>
  </testcase>
</testsuite>