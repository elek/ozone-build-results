No '-XX:...' jvm parameters are set. Adding safer GC settings '-XX:ParallelGCThreads=8 -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=70 -XX:+CMSParallelRemarkEnabled' to the OZONE_OPTS
OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.
2022-07-12 20:58:20 INFO  StorageContainerManagerStarter:112 - STARTUP_MSG: 
/************************************************************
STARTUP_MSG: Starting StorageContainerManager
STARTUP_MSG:   host = scm-0/10.42.0.18
STARTUP_MSG:   args = []
STARTUP_MSG:   version = 1.3.0-SNAPSHOT
STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.30.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/jaxb-core-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/netty-codec-4.1.74.Final.jar:/opt/hadoop/share/ozone/lib/istack-commons-runtime-3.0.5.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.67.jar:/opt/hadoop/share/ozone/lib/hdds-interface-admin-1.3.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.13.2.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.4.43.v20210629.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/hadoop-shaded-protobuf_3_7-1.1.1.jar:/opt/hadoop/share/ozone/lib/ozone-annotation-processing-1.3.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hdds-container-service-1.3.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/okhttp-4.9.0.jar:/opt/hadoop/share/ozone/lib/netty-resolver-4.1.74.Final.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/j2objc-annotations-1.3.jar:/opt/hadoop/share/ozone/lib/picocli-4.6.1.jar:/opt/hadoop/share/ozone/lib/jackson-datatype-jsr310-2.13.2.jar:/opt/hadoop/share/ozone/lib/javassist-3.21.0-GA.jar:/opt/hadoop/share/ozone/lib/jaxb-api-2.3.0.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/netty-buffer-4.1.74.Final.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/hadoop-shaded-guava-1.1.1.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-2.3.0.jar:/opt/hadoop/share/ozone/lib/kotlin-stdlib-1.6.21.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.17.1.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.2.jar:/opt/hadoop/share/ozone/lib/accessors-smart-2.4.7.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/txw2-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.13.jar:/opt/hadoop/share/ozone/lib/guava-31.1-jre.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.8.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.29.5.jar:/opt/hadoop/share/ozone/lib/libthrift-0.14.1.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.26.jar:/opt/hadoop/share/ozone/lib/stax-ex-1.7.8.jar:/opt/hadoop/share/ozone/lib/error_prone_annotations-2.2.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.13.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.4.43.v20210629.jar:/opt/hadoop/share/ozone/lib/netty-tcnative-classes-2.0.48.Final.jar:/opt/hadoop/share/ozone/lib/ratis-common-2.3.0.jar:/opt/hadoop/share/ozone/lib/jaeger-client-1.6.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/commons-io-2.11.0.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.4.7.jar:/opt/hadoop/share/ozone/lib/hdds-interface-client-1.3.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-2.3.0.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.4.43.v20210629.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.13.2.jar:/opt/hadoop/share/ozone/lib/hdds-server-framework-1.3.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/hdds-common-1.3.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/reflections-0.9.11.jar:/opt/hadoop/share/ozone/lib/gson-2.9.0.jar:/opt/hadoop/share/ozone/lib/hdds-erasurecode-1.3.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.4.43.v20210629.jar:/opt/hadoop/share/ozone/lib/hdds-interface-server-1.3.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.3.1.jar:/opt/hadoop/share/ozone/lib/ratis-proto-2.3.0.jar:/opt/hadoop/share/ozone/lib/annotations-13.0.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.4.43.v20210629.jar:/opt/hadoop/share/ozone/lib/simpleclient_common-0.7.0.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-1.6.0.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.3.1.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.67.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-1.6.0.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.4.43.v20210629.jar:/opt/hadoop/share/ozone/lib/netty-handler-4.1.74.Final.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/ratis-netty-2.3.0.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/simpleclient_dropwizard-0.7.0.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.13.2.2.jar:/opt/hadoop/share/ozone/lib/simpleclient-0.7.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/failureaccess-1.0.1.jar:/opt/hadoop/share/ozone/lib/okio-2.8.0.jar:/opt/hadoop/share/ozone/lib/hdds-config-1.3.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.4.43.v20210629.jar:/opt/hadoop/share/ozone/lib/jakarta.activation-api-1.2.1.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.30.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.3.1.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-7.9.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.4.43.v20210629.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.33.0.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.4.43.v20210629.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-1.0.0.jar:/opt/hadoop/share/ozone/lib/kotlin-stdlib-common-1.6.21.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.33.0.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.21.jar:/opt/hadoop/share/ozone/lib/jaxb-runtime-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-server-api-2.3.0.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.33.0.jar:/opt/hadoop/share/ozone/lib/hdds-client-1.3.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hdds-hadoop-dependency-client-1.3.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.1.8.2.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/ratis-server-2.3.0.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.17.1.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.3.1.jar:/opt/hadoop/share/ozone/lib/checker-qual-3.12.0.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-1.6.0.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.3.1.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/FastInfoset-1.2.13.jar:/opt/hadoop/share/ozone/lib/ratis-client-2.3.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/netty-transport-4.1.74.Final.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/hdds-hadoop-dependency-server-1.3.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/netty-common-4.1.74.Final.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hdds-server-scm-1.3.0-SNAPSHOT.jar
STARTUP_MSG:   build = https://github.com/apache/ozone/e822caebe974211429dec40763e76473dacc22fa ; compiled by 'runner' on 2022-07-12T20:36Z
STARTUP_MSG:   java = 11.0.14.1
************************************************************/
2022-07-12 20:58:20 INFO  StorageContainerManagerStarter:90 - registered UNIX signal handlers for [TERM, HUP, INT]
2022-07-12 20:58:20 WARN  ServerUtils:148 - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-07-12 20:58:20 INFO  SCMHANodeDetails:209 - ServiceID for StorageContainerManager is null
2022-07-12 20:58:20 INFO  SCMHANodeDetails:214 - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-07-12 20:58:21 WARN  HAUtils:342 - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-07-12 20:58:21 WARN  DBStoreBuilder:145 - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-07-12 20:58:21 INFO  NodeSchemaLoader:129 - Loading schema from [file:/etc/hadoop/network-topology-default.xml, jar:file:/opt/hadoop/share/ozone/lib/hdds-common-1.3.0-SNAPSHOT.jar!/network-topology-default.xml]
2022-07-12 20:58:21 INFO  NodeSchemaLoader:176 - Loading network topology layer schema file
2022-07-12 20:58:21 INFO  MetricRegistries:64 - Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
2022-07-12 20:58:21 INFO  SCMRatisServerImpl:88 - starting Raft server for scm:b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27
2022-07-12 20:58:21 INFO  RaftServer:46 - raft.rpc.type = GRPC (default)
2022-07-12 20:58:22 INFO  GrpcConfigKeys:46 - raft.grpc.admin.port = -1 (default)
2022-07-12 20:58:22 INFO  GrpcConfigKeys:46 - raft.grpc.server.port = 9894 (custom)
2022-07-12 20:58:22 INFO  GrpcConfigKeys:46 - raft.grpc.client.port = -1 (default)
2022-07-12 20:58:22 INFO  GrpcConfigKeys:46 - raft.grpc.server.port = 9894 (custom)
2022-07-12 20:58:22 INFO  GrpcConfigKeys:46 - raft.grpc.server.port = 9894 (custom)
2022-07-12 20:58:22 INFO  GrpcService:46 - raft.grpc.message.size.max = 32m (=33554432) (custom)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2022-07-12 20:58:22 INFO  GrpcService:46 - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.rpc.request.timeout = 30000ms (custom)
2022-07-12 20:58:22 INFO  GrpcConfigKeys:46 - raft.grpc.server.async.request.thread.pool.cached = true (default)
2022-07-12 20:58:22 INFO  GrpcConfigKeys:46 - raft.grpc.server.async.request.thread.pool.size = 32 (default)
2022-07-12 20:58:22 INFO  DataStreamServerImpl:46 - raft.datastream.type = DISABLED (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.threadpool.proxy.cached = true (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.threadpool.proxy.size = 0 (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.rpc.slowness.timeout = 120000ms (custom)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.storage.dir = [/data/metadata/scm-ha] (custom)
2022-07-12 20:58:22 INFO  RaftServer:247 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27: found a subdirectory /data/metadata/scm-ha/165e4b8c-1d57-45b7-b19b-9cb3d421b865
2022-07-12 20:58:22 INFO  RaftServer:96 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27: addNew group-9CB3D421B865:[] returns group-9CB3D421B865:java.util.concurrent.CompletableFuture@3e850122[Not completed]
2022-07-12 20:58:22 INFO  RaftServer$Division:190 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27: new RaftServerImpl for group-9CB3D421B865:[] with SCMStateMachine:uninitialized
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.rpc.timeout.min = 5000ms (custom)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.rpc.timeout.max = 5200ms (custom)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.rpc.sleep.time = 25ms (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.rpc.slowness.timeout = 120000ms (custom)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.sleep.deviation.threshold = 300ms (default)
2022-07-12 20:58:22 INFO  RaftServer$Division:107 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865: ConfigurationManager, init=-1: [], old=null, confs=<EMPTY_MAP>
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.storage.dir = [/data/metadata/scm-ha] (custom)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.corruption.policy = EXCEPTION (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.storage.free-space.min = 0MB (=0) (default)
2022-07-12 20:58:22 INFO  RaftStorageDirectory:230 - Lock on /data/metadata/scm-ha/165e4b8c-1d57-45b7-b19b-9cb3d421b865/in_use.lock acquired by nodename 7@scm-0
2022-07-12 20:58:22 INFO  RaftStorage:110 - Read RaftStorageMetadata{term=1, votedFor=b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27} from /data/metadata/scm-ha/165e4b8c-1d57-45b7-b19b-9cb3d421b865/current/raft-meta
2022-07-12 20:58:22 INFO  RaftServer$Division:393 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865: set configuration 0: [b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27|rpc:scm-0:9894|admin:|client:|dataStream:|priority:0], old=null
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.notification.no-leader.timeout = 60s (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.use.memory = false (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.purge.gap = 1000000 (custom)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.statemachine.data.read.timeout = 1000ms (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.segment.size.max = 4194304 (custom)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.segment.cache.num.max = 2 (custom)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2022-07-12 20:58:22 INFO  SegmentedRaftLogWorker:187 - new b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /data/metadata/scm-ha/165e4b8c-1d57-45b7-b19b-9cb3d421b865
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.queue.element-limit = 4096 (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.segment.size.max = 4194304 (custom)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.preallocated.size = 4194304 (custom)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.force.sync.num = 128 (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.statemachine.data.sync = true (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.unsafe-flush.enabled = false (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.statemachine.data.caching.enabled = false (default)
2022-07-12 20:58:22 INFO  RaftServer$Division:393 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865: set configuration 0: [b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27|rpc:scm-0:9894|admin:|client:|dataStream:|priority:0], old=null
2022-07-12 20:58:22 INFO  LogSegment:173 - Successfully read 1 entries from segment file /data/metadata/scm-ha/165e4b8c-1d57-45b7-b19b-9cb3d421b865/current/log_inprogress_0
2022-07-12 20:58:22 INFO  SegmentedRaftLogWorker:135 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> 0
2022-07-12 20:58:22 INFO  SegmentedRaftLogWorker:135 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.snapshot.auto.trigger.enabled = true (custom)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.snapshot.auto.trigger.threshold = 1000 (custom)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.snapshot.retention.file.num = -1 (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.log.purge.upto.snapshot.index = false (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.retrycache.expirytime = 60000ms (default)
2022-07-12 20:58:22 INFO  RaftServerConfigKeys:46 - raft.server.retrycache.statistics.expirytime = 100?s (default)
2022-07-12 20:58:23 INFO  RaftServerConfigKeys:46 - raft.server.log.appender.install.snapshot.enabled = false (custom)
2022-07-12 20:58:23 INFO  RaftServerConfigKeys:46 - raft.server.threadpool.server.cached = true (default)
2022-07-12 20:58:23 INFO  RaftServerConfigKeys:46 - raft.server.threadpool.server.size = 0 (default)
2022-07-12 20:58:23 INFO  RaftServerConfigKeys:46 - raft.server.threadpool.client.cached = true (default)
2022-07-12 20:58:23 INFO  RaftServerConfigKeys:46 - raft.server.threadpool.client.size = 0 (default)
2022-07-12 20:58:23 INFO  SCMSnapshotProvider:66 - Initializing SCM Snapshot Provider
2022-07-12 20:58:23 WARN  ServerUtils:237 - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-07-12 20:58:23 WARN  SCMHAUtils:153 - SCM snapshot dir is not configured. Falling back to ozone.metadata.dirs config
2022-07-12 20:58:23 INFO  AbstractLayoutVersionManager:82 - Initializing Layout version manager with metadata layout = DATANODE_SCHEMA_V3 (version = 4), software layout = DATANODE_SCHEMA_V3 (version = 4)
2022-07-12 20:58:23 INFO  Reflections:232 - Reflections took 180 ms to scan 3 urls, producing 109 keys and 243 values 
2022-07-12 20:58:23 INFO  SequenceIdGenerator:349 - upgrade localId to 109611004723200000
2022-07-12 20:58:23 INFO  SequenceIdGenerator:359 - upgrade delTxnId to 0
2022-07-12 20:58:23 INFO  SequenceIdGenerator:376 - upgrade containerId to 0
2022-07-12 20:58:23 INFO  SequenceIdGenerator:220 - Init the HA SequenceIdGenerator.
2022-07-12 20:58:23 INFO  SCMNodeManager:149 - Entering startup safe mode.
2022-07-12 20:58:23 INFO  ContainerPlacementPolicyFactory:86 - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-07-12 20:58:23 INFO  PipelineStateManagerImpl:78 - No pipeline exists in current db
2022-07-12 20:58:23 INFO  LeaderChoosePolicyFactory:57 - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-07-12 20:58:23 INFO  ContainerPlacementPolicyFactory:86 - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2022-07-12 20:58:23 INFO  BackgroundPipelineCreator:127 - Starting RatisPipelineUtilsThread.
2022-07-12 20:58:23 INFO  BackgroundPipelineScrubber:68 - Starting BackgroundPipelineScrubber Service.
2022-07-12 20:58:23 INFO  SCMServiceManager:42 - Registering service BackgroundPipelineCreator.
2022-07-12 20:58:23 INFO  SCMServiceManager:42 - Registering service BackgroundPipelineScrubber.
2022-07-12 20:58:23 INFO  ExpiredContainerReplicaOpScrubber:68 - Starting ExpiredContainerReplicaOpScrubber Service.
2022-07-12 20:58:23 INFO  SCMServiceManager:42 - Registering service ExpiredContainerReplicaOpScrubber.
2022-07-12 20:58:23 INFO  PipelineChoosePolicyFactory:73 - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-07-12 20:58:23 INFO  SCMServiceManager:42 - Registering service SCMBlockDeletingService.
2022-07-12 20:58:23 INFO  ReplicationManager:186 - Starting Replication Monitor Thread.
2022-07-12 20:58:23 INFO  SCMServiceManager:42 - Registering service ReplicationManager.
2022-07-12 20:58:23 INFO  ReplicationManager:235 - Replication Manager is not ready to run until 300000ms after safemode exit
2022-07-12 20:58:23 INFO  ContainerSafeModeRule:89 - containers with one replica threshold count 0
2022-07-12 20:58:23 INFO  HealthyPipelineSafeModeRule:156 - Total pipeline count is 0, healthy pipeline threshold count is 1
2022-07-12 20:58:23 INFO  OneReplicaPipelineSafeModeRule:180 - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-07-12 20:58:23 WARN  NativeCodeLoader:60 - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2022-07-12 20:58:24 INFO  AuditLogger:120 - Refresh DebugCmdSet for SCMAudit to [].
2022-07-12 20:58:24 INFO  CallQueueManager:90 - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-07-12 20:58:24 INFO  Server:1265 - Starting Socket Reader #1 for port 9861
2022-07-12 20:58:24 INFO  AuditLogger:120 - Refresh DebugCmdSet for SCMAudit to [].
2022-07-12 20:58:24 INFO  CallQueueManager:90 - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-07-12 20:58:24 INFO  Server:1265 - Starting Socket Reader #1 for port 9863
2022-07-12 20:58:24 INFO  AuditLogger:120 - Refresh DebugCmdSet for SCMAudit to [].
2022-07-12 20:58:24 INFO  CallQueueManager:90 - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-07-12 20:58:24 INFO  Server:1265 - Starting Socket Reader #1 for port 9860
2022-07-12 20:58:25 INFO  SCMServiceManager:42 - Registering service ContainerBalancer.
2022-07-12 20:58:25 INFO  StorageContainerManager:401 - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-07-12 20:58:25 WARN  EventQueue:216 - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2022-07-12 20:58:25 INFO  SCMContext:228 - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=false}.
2022-07-12 20:58:25 INFO  StorageContainerManager:1422 - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:9860
2022-07-12 20:58:25 INFO  SCMRatisServerImpl:179 - starting ratis server 0.0.0.0:9894
2022-07-12 20:58:25 INFO  RaftServer$Division:310 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865: start as a follower, conf=0: [b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27|rpc:scm-0:9894|admin:|client:|dataStream:|priority:0], old=null
2022-07-12 20:58:25 INFO  RaftServer$Division:299 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865: changes role from      null to FOLLOWER at term 1 for startAsFollower
2022-07-12 20:58:25 INFO  RoleInfo:139 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27: start b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865-FollowerState
2022-07-12 20:58:25 INFO  JmxRegister:44 - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9CB3D421B865,id=b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27
2022-07-12 20:58:25 INFO  RaftServer:382 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27: start RPC server
2022-07-12 20:58:25 INFO  GrpcService:260 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27: GrpcService started, listening on 9894
2022-07-12 20:58:25 INFO  SCMHAManagerImpl:121 -  scm role is FOLLOWER peers [b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27|rpc:scm-0:9894|admin:|client:|dataStream:|priority:0]
2022-07-12 20:58:25 INFO  InterSCMGrpcService:94 - Starting SCM Grpc Service at port 9895
2022-07-12 20:58:25 INFO  JvmPauseMonitor:103 - JvmPauseMonitor-b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27: Started
2022-07-12 20:58:25 INFO  MetricsConfig:120 - Loaded properties from hadoop-metrics2.properties
2022-07-12 20:58:25 INFO  MetricsSystemImpl:378 - Scheduled Metric snapshot period at 10 second(s).
2022-07-12 20:58:25 INFO  MetricsSystemImpl:191 - StorageContainerManager metrics system started
2022-07-12 20:58:25 INFO  SCMClientProtocolServer:170 - RPC server for Client  is listening at /0.0.0.0:9860
2022-07-12 20:58:25 INFO  Server:1507 - IPC Server Responder: starting
2022-07-12 20:58:25 INFO  Server:1344 - IPC Server listener on 9860: starting
2022-07-12 20:58:25 INFO  StorageContainerManager:1437 - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:9863
2022-07-12 20:58:25 INFO  SCMBlockProtocolServer:152 - RPC server for Block Protocol is listening at /0.0.0.0:9863
2022-07-12 20:58:25 INFO  Server:1507 - IPC Server Responder: starting
2022-07-12 20:58:25 INFO  Server:1344 - IPC Server listener on 9863: starting
2022-07-12 20:58:25 INFO  JvmPauseMonitor:188 - Starting JVM pause monitor
2022-07-12 20:58:25 INFO  BaseHttpServer:209 - Starting Web-server for scm at: http://0.0.0.0:9876
2022-07-12 20:58:25 INFO  BaseHttpServer:107 - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2022-07-12 20:58:25 INFO  log:170 - Logging initialized @10846ms to org.eclipse.jetty.util.log.Slf4jLog
2022-07-12 20:58:26 INFO  AuthenticationFilter:240 - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2022-07-12 20:58:26 INFO  HttpRequestLog:86 - Http request log for http.requests.scm is not defined
2022-07-12 20:58:26 INFO  HttpServer2:1029 - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2022-07-12 20:58:26 INFO  HttpServer2:1005 - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2022-07-12 20:58:26 INFO  HttpServer2:1013 - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2022-07-12 20:58:26 INFO  HttpServer2:1013 - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2022-07-12 20:58:26 INFO  HttpServer2:1248 - Jetty bound to port 9876
2022-07-12 20:58:26 INFO  Server:375 - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 11.0.14.1+1-LTS
2022-07-12 20:58:26 INFO  session:334 - DefaultSessionIdManager workerName=node0
2022-07-12 20:58:26 INFO  session:339 - No SessionScavenger set, using defaults
2022-07-12 20:58:26 INFO  session:132 - node0 Scavenging every 660000ms
2022-07-12 20:58:26 INFO  ContextHandler:915 - Started o.e.j.s.ServletContextHandler@79be91eb{logs,/logs,file:///var/log/hadoop/,AVAILABLE}
2022-07-12 20:58:26 INFO  ContextHandler:915 - Started o.e.j.s.ServletContextHandler@6744707b{static,/static,jar:file:/opt/hadoop/share/ozone/lib/hdds-server-scm-1.3.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2022-07-12 20:58:26 INFO  ContextHandler:915 - Started o.e.j.w.WebAppContext@5be4be74{scm,/,file:///tmp/jetty-0_0_0_0-9876-hdds-server-scm-1_3_0-SNAPSHOT_jar-_-any-1642911312629427355/webapp/,AVAILABLE}{jar:file:/opt/hadoop/share/ozone/lib/hdds-server-scm-1.3.0-SNAPSHOT.jar!/webapps/scm}
2022-07-12 20:58:26 INFO  AbstractConnector:331 - Started ServerConnector@6f96dd64{HTTP/1.1, (http/1.1)}{0.0.0.0:9876}
2022-07-12 20:58:26 INFO  Server:415 - Started @11333ms
2022-07-12 20:58:26 INFO  MetricsSinkAdapter:204 - Sink prometheus started
2022-07-12 20:58:26 INFO  MetricsSystemImpl:305 - Registered sink prometheus
2022-07-12 20:58:26 INFO  BaseHttpServer:329 - HTTP server of scm listening at http://0.0.0.0:9876
2022-07-12 20:58:30 INFO  FollowerState:143 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5031767084ns, electionTimeout:5022ms
2022-07-12 20:58:30 INFO  RoleInfo:110 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27: shutdown b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865-FollowerState
2022-07-12 20:58:30 INFO  RaftServer$Division:299 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2022-07-12 20:58:30 INFO  RaftServerConfigKeys:46 - raft.server.leaderelection.pre-vote = false (custom)
2022-07-12 20:58:30 INFO  RoleInfo:139 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27: start b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865-LeaderElection1
2022-07-12 20:58:30 INFO  LeaderElection:310 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865-LeaderElection1 ELECTION round 0: submit vote requests at term 2 for 0: [b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27|rpc:scm-0:9894|admin:|client:|dataStream:|priority:0], old=null
2022-07-12 20:58:30 INFO  LeaderElection:312 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865-LeaderElection1 ELECTION round 0: result PASSED (term=2)
2022-07-12 20:58:30 INFO  RoleInfo:130 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27: shutdown b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865-LeaderElection1
2022-07-12 20:58:30 INFO  RaftServer$Division:299 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2022-07-12 20:58:30 INFO  SCMStateMachine:259 - current SCM becomes leader of term 2.
2022-07-12 20:58:30 INFO  SCMContext:99 - update <isLeader,term> from <false,0> to <true,2>
2022-07-12 20:58:30 INFO  RaftServer$Division:287 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865: change Leader from null to b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27 at term 2 for becomeLeader, leader elected after 7536ms
2022-07-12 20:58:30 INFO  RaftServerConfigKeys:46 - raft.server.staging.catchup.gap = 1000 (default)
2022-07-12 20:58:30 INFO  RaftServerConfigKeys:46 - raft.server.write.element-limit = 4096 (default)
2022-07-12 20:58:30 INFO  RaftServerConfigKeys:46 - raft.server.write.byte-limit = 64MB (=67108864) (default)
2022-07-12 20:58:30 INFO  RaftServerConfigKeys:46 - raft.server.watch.timeout = 10s (default)
2022-07-12 20:58:30 INFO  RaftServerConfigKeys:46 - raft.server.watch.timeout.denomination = 1s (default)
2022-07-12 20:58:30 INFO  RaftServerConfigKeys:46 - raft.server.watch.element-limit = 65536 (default)
2022-07-12 20:58:30 INFO  RaftServerConfigKeys:46 - raft.server.write.element-limit = 4096 (default)
2022-07-12 20:58:30 INFO  RaftServerConfigKeys:46 - raft.server.write.follower.gap.ratio.max = -1.0 (default)
2022-07-12 20:58:30 INFO  RoleInfo:139 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27: start b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865-LeaderStateImpl
2022-07-12 20:58:30 INFO  SegmentedRaftLogWorker:430 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865-SegmentedRaftLogWorker: Rolling segment log-0_0 to index:0
2022-07-12 20:58:30 INFO  SegmentedRaftLogWorker:586 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865-SegmentedRaftLogWorker: Rolled log segment from /data/metadata/scm-ha/165e4b8c-1d57-45b7-b19b-9cb3d421b865/current/log_inprogress_0 to /data/metadata/scm-ha/165e4b8c-1d57-45b7-b19b-9cb3d421b865/current/log_0-0
2022-07-12 20:58:30 INFO  RaftServer$Division:393 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865: set configuration 1: [b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27|rpc:scm-0:9894|admin:|client:|dataStream:|priority:0], old=null
2022-07-12 20:58:30 INFO  SegmentedRaftLogWorker:629 - b5b4366e-c5f1-4860-ab81-a8c3d8e7ff27@group-9CB3D421B865-SegmentedRaftLogWorker: created new log segment /data/metadata/scm-ha/165e4b8c-1d57-45b7-b19b-9cb3d421b865/current/log_inprogress_1
2022-07-12 20:58:30 INFO  SCMContext:126 - update <isLeaderReady> from <false> to <true>
2022-07-12 20:58:30 INFO  BackgroundPipelineCreator:253 - Service BackgroundPipelineCreator transitions to RUNNING.
2022-07-12 20:58:30 INFO  HealthyPipelineSafeModeRule:152 - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2022-07-12 20:58:30 INFO  ContainerSafeModeRule:177 - Refreshed one replica container threshold 0, currentThreshold 0
2022-07-12 20:58:30 INFO  OneReplicaPipelineSafeModeRule:176 - Refreshed Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-07-12 20:58:30 INFO  SCMDatanodeProtocolServer:186 - ScmDatanodeProtocol RPC server for DataNodes is listening at /0.0.0.0:9861
2022-07-12 20:58:30 INFO  Server:1507 - IPC Server Responder: starting
2022-07-12 20:58:30 INFO  Server:1344 - IPC Server listener on 9861: starting
2022-07-12 20:58:30 WARN  Server:1717 - IPC Server handler 3 on default port 9861, call Call#0 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 10.42.0.19:48542: output error
2022-07-12 20:58:30 INFO  Server:2979 - IPC Server handler 3 on default port 9861 caught an exception
java.nio.channels.ClosedChannelException
	at java.base/sun.nio.ch.SocketChannelImpl.ensureOpenAndConnected(SocketChannelImpl.java:180)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:452)
	at org.apache.hadoop.ipc.Server.channelWrite(Server.java:3605)
	at org.apache.hadoop.ipc.Server.access$1700(Server.java:141)
	at org.apache.hadoop.ipc.Server$Responder.processResponse(Server.java:1667)
	at org.apache.hadoop.ipc.Server$Responder.doRespond(Server.java:1737)
	at org.apache.hadoop.ipc.Server$Connection.sendResponse(Server.java:2837)
	at org.apache.hadoop.ipc.Server$Connection.access$300(Server.java:1809)
	at org.apache.hadoop.ipc.Server$RpcCall.doResponse(Server.java:1117)
	at org.apache.hadoop.ipc.Server$Call.doResponse(Server.java:909)
	at org.apache.hadoop.ipc.Server$Call.sendResponse(Server.java:895)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1052)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:963)
	at java.base/java.security.AccessController.doPrivileged(Native Method)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:423)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2966)
2022-07-12 20:58:30 WARN  Server:1717 - IPC Server handler 2 on default port 9861, call Call#0 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 10.42.0.20:46666: output error
2022-07-12 20:58:30 INFO  Server:2979 - IPC Server handler 2 on default port 9861 caught an exception
java.nio.channels.ClosedChannelException
	at java.base/sun.nio.ch.SocketChannelImpl.ensureOpenAndConnected(SocketChannelImpl.java:180)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:452)
	at org.apache.hadoop.ipc.Server.channelWrite(Server.java:3605)
	at org.apache.hadoop.ipc.Server.access$1700(Server.java:141)
	at org.apache.hadoop.ipc.Server$Responder.processResponse(Server.java:1667)
	at org.apache.hadoop.ipc.Server$Responder.doRespond(Server.java:1737)
	at org.apache.hadoop.ipc.Server$Connection.sendResponse(Server.java:2837)
	at org.apache.hadoop.ipc.Server$Connection.access$300(Server.java:1809)
	at org.apache.hadoop.ipc.Server$RpcCall.doResponse(Server.java:1117)
	at org.apache.hadoop.ipc.Server$Call.doResponse(Server.java:909)
	at org.apache.hadoop.ipc.Server$Call.sendResponse(Server.java:895)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1052)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:963)
	at java.base/java.security.AccessController.doPrivileged(Native Method)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:423)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2966)
2022-07-12 20:58:30 WARN  Server:1717 - IPC Server handler 0 on default port 9861, call Call#0 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 10.42.0.15:41748: output error
2022-07-12 20:58:30 INFO  Server:2979 - IPC Server handler 0 on default port 9861 caught an exception
java.nio.channels.ClosedChannelException
	at java.base/sun.nio.ch.SocketChannelImpl.ensureOpenAndConnected(SocketChannelImpl.java:180)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:452)
	at org.apache.hadoop.ipc.Server.channelWrite(Server.java:3605)
	at org.apache.hadoop.ipc.Server.access$1700(Server.java:141)
	at org.apache.hadoop.ipc.Server$Responder.processResponse(Server.java:1667)
	at org.apache.hadoop.ipc.Server$Responder.doRespond(Server.java:1737)
	at org.apache.hadoop.ipc.Server$Connection.sendResponse(Server.java:2837)
	at org.apache.hadoop.ipc.Server$Connection.access$300(Server.java:1809)
	at org.apache.hadoop.ipc.Server$RpcCall.doResponse(Server.java:1117)
	at org.apache.hadoop.ipc.Server$Call.doResponse(Server.java:909)
	at org.apache.hadoop.ipc.Server$Call.sendResponse(Server.java:895)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1052)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:963)
	at java.base/java.security.AccessController.doPrivileged(Native Method)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:423)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2966)
2022-07-12 20:58:32 INFO  NetworkTopologyImpl:112 - Added a new node: /default-rack/53cf9d57-0a8f-4662-aa5d-ce7b8894c440
2022-07-12 20:58:32 INFO  SCMNodeManager:397 - Registered Data node : 53cf9d57-0a8f-4662-aa5d-ce7b8894c440{ip: 10.42.0.20, host: datanode-2.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2022-07-12 20:58:32 INFO  BackgroundPipelineCreator:275 - trigger a one-shot run on RatisPipelineUtilsThread.
2022-07-12 20:58:32 INFO  SCMSafeModeManager:71 - SCM in safe mode. 1 DataNodes registered, 3 required.
2022-07-12 20:58:32 INFO  RatisPipelineProvider:195 - Sending CreatePipelineCommand for pipeline:PipelineID=4445ab1a-5574-477d-b9a5-1bbdb3210c5d to datanode:53cf9d57-0a8f-4662-aa5d-ce7b8894c440
2022-07-12 20:58:32 INFO  SCMSafeModeManager:204 - ContainerSafeModeRule rule is successfully validated
2022-07-12 20:58:32 INFO  SCMSafeModeManager:204 - AtleastOneDatanodeReportedRule rule is successfully validated
2022-07-12 20:58:32 INFO  PipelineStateManagerImpl:103 - Created pipeline Pipeline[ Id: 4445ab1a-5574-477d-b9a5-1bbdb3210c5d, Nodes: 53cf9d57-0a8f-4662-aa5d-ce7b8894c440{ip: 10.42.0.20, host: datanode-2.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2022-07-12T20:58:32.570Z[UTC]].
2022-07-12 20:58:32 INFO  HealthyPipelineSafeModeRule:152 - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2022-07-12 20:58:33 INFO  NetworkTopologyImpl:112 - Added a new node: /default-rack/386504ce-1fd8-4c81-9d01-b86284c556b9
2022-07-12 20:58:33 INFO  SCMNodeManager:397 - Registered Data node : 386504ce-1fd8-4c81-9d01-b86284c556b9{ip: 10.42.0.15, host: datanode-0.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2022-07-12 20:58:33 INFO  BackgroundPipelineCreator:275 - trigger a one-shot run on RatisPipelineUtilsThread.
2022-07-12 20:58:33 INFO  SCMSafeModeManager:71 - SCM in safe mode. 2 DataNodes registered, 3 required.
2022-07-12 20:58:33 INFO  RatisPipelineProvider:195 - Sending CreatePipelineCommand for pipeline:PipelineID=ceadbef7-4712-49f9-8d8d-1dd7bdde3247 to datanode:386504ce-1fd8-4c81-9d01-b86284c556b9
2022-07-12 20:58:33 INFO  PipelineStateManagerImpl:103 - Created pipeline Pipeline[ Id: ceadbef7-4712-49f9-8d8d-1dd7bdde3247, Nodes: 386504ce-1fd8-4c81-9d01-b86284c556b9{ip: 10.42.0.15, host: datanode-0.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2022-07-12T20:58:33.093Z[UTC]].
2022-07-12 20:58:33 INFO  HealthyPipelineSafeModeRule:152 - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2022-07-12 20:58:33 INFO  NetworkTopologyImpl:112 - Added a new node: /default-rack/a1de5deb-8363-43d5-90ec-7df665546ed1
2022-07-12 20:58:33 INFO  SCMNodeManager:397 - Registered Data node : a1de5deb-8363-43d5-90ec-7df665546ed1{ip: 10.42.0.19, host: datanode-1.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2022-07-12 20:58:33 INFO  BackgroundPipelineCreator:275 - trigger a one-shot run on RatisPipelineUtilsThread.
2022-07-12 20:58:33 INFO  SCMSafeModeManager:71 - SCM in safe mode. 3 DataNodes registered, 3 required.
2022-07-12 20:58:33 INFO  SCMSafeModeManager:204 - DataNodeSafeModeRule rule is successfully validated
2022-07-12 20:58:33 INFO  SCMSafeModeManager:233 - All SCM safe mode pre check rules have passed
2022-07-12 20:58:33 INFO  RatisPipelineProvider:195 - Sending CreatePipelineCommand for pipeline:PipelineID=b90e3501-85ee-44a8-806e-47956d889fab to datanode:a1de5deb-8363-43d5-90ec-7df665546ed1
2022-07-12 20:58:33 WARN  EventQueue:216 - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2022-07-12 20:58:33 INFO  SCMContext:228 - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=true}.
2022-07-12 20:58:33 INFO  BackgroundPipelineCreator:275 - trigger a one-shot run on RatisPipelineUtilsThread.
2022-07-12 20:58:33 INFO  PipelineStateManagerImpl:103 - Created pipeline Pipeline[ Id: b90e3501-85ee-44a8-806e-47956d889fab, Nodes: a1de5deb-8363-43d5-90ec-7df665546ed1{ip: 10.42.0.19, host: datanode-1.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2022-07-12T20:58:33.745Z[UTC]].
2022-07-12 20:58:33 INFO  HealthyPipelineSafeModeRule:152 - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2022-07-12 20:58:33 INFO  RatisPipelineProvider:195 - Sending CreatePipelineCommand for pipeline:PipelineID=5e4457cc-35c2-478f-8c18-d7b4aeedf9c5 to datanode:53cf9d57-0a8f-4662-aa5d-ce7b8894c440
2022-07-12 20:58:33 INFO  RatisPipelineProvider:195 - Sending CreatePipelineCommand for pipeline:PipelineID=5e4457cc-35c2-478f-8c18-d7b4aeedf9c5 to datanode:a1de5deb-8363-43d5-90ec-7df665546ed1
2022-07-12 20:58:33 INFO  RatisPipelineProvider:195 - Sending CreatePipelineCommand for pipeline:PipelineID=5e4457cc-35c2-478f-8c18-d7b4aeedf9c5 to datanode:386504ce-1fd8-4c81-9d01-b86284c556b9
2022-07-12 20:58:33 INFO  PipelineStateManagerImpl:103 - Created pipeline Pipeline[ Id: 5e4457cc-35c2-478f-8c18-d7b4aeedf9c5, Nodes: 53cf9d57-0a8f-4662-aa5d-ce7b8894c440{ip: 10.42.0.20, host: datanode-2.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}a1de5deb-8363-43d5-90ec-7df665546ed1{ip: 10.42.0.19, host: datanode-1.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}386504ce-1fd8-4c81-9d01-b86284c556b9{ip: 10.42.0.15, host: datanode-0.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-07-12T20:58:33.787Z[UTC]].
2022-07-12 20:58:33 INFO  HealthyPipelineSafeModeRule:152 - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2022-07-12 20:58:35 INFO  PipelineManagerImpl:359 - Pipeline Pipeline[ Id: 4445ab1a-5574-477d-b9a5-1bbdb3210c5d, Nodes: 53cf9d57-0a8f-4662-aa5d-ce7b8894c440{ip: 10.42.0.20, host: datanode-2.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:53cf9d57-0a8f-4662-aa5d-ce7b8894c440, CreationTimestamp2022-07-12T20:58:32.570Z[UTC]] moved to OPEN state
2022-07-12 20:58:35 INFO  HealthyPipelineSafeModeRule:152 - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2022-07-12 20:58:35 INFO  SCMSafeModeManager:124 - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2022-07-12 20:58:36 INFO  SCMSafeModeManager:124 - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2022-07-12 20:58:36 INFO  PipelineManagerImpl:359 - Pipeline Pipeline[ Id: ceadbef7-4712-49f9-8d8d-1dd7bdde3247, Nodes: 386504ce-1fd8-4c81-9d01-b86284c556b9{ip: 10.42.0.15, host: datanode-0.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:386504ce-1fd8-4c81-9d01-b86284c556b9, CreationTimestamp2022-07-12T20:58:33.093Z[UTC]] moved to OPEN state
2022-07-12 20:58:36 INFO  HealthyPipelineSafeModeRule:152 - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2022-07-12 20:58:36 INFO  SCMSafeModeManager:124 - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2022-07-12 20:58:37 INFO  PipelineManagerImpl:359 - Pipeline Pipeline[ Id: b90e3501-85ee-44a8-806e-47956d889fab, Nodes: a1de5deb-8363-43d5-90ec-7df665546ed1{ip: 10.42.0.19, host: datanode-1.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:a1de5deb-8363-43d5-90ec-7df665546ed1, CreationTimestamp2022-07-12T20:58:33.745Z[UTC]] moved to OPEN state
2022-07-12 20:58:37 INFO  HealthyPipelineSafeModeRule:152 - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2022-07-12 20:58:37 INFO  SCMSafeModeManager:124 - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2022-07-12 20:58:37 INFO  SCMSafeModeManager:124 - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2022-07-12 20:58:37 INFO  SCMSafeModeManager:124 - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2022-07-12 20:58:41 INFO  SCMSafeModeManager:124 - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2022-07-12 20:58:41 INFO  PipelineManagerImpl:359 - Pipeline Pipeline[ Id: 5e4457cc-35c2-478f-8c18-d7b4aeedf9c5, Nodes: 53cf9d57-0a8f-4662-aa5d-ce7b8894c440{ip: 10.42.0.20, host: datanode-2.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}a1de5deb-8363-43d5-90ec-7df665546ed1{ip: 10.42.0.19, host: datanode-1.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}386504ce-1fd8-4c81-9d01-b86284c556b9{ip: 10.42.0.15, host: datanode-0.datanode.default.svc.cluster.local, ports: [REPLICATION=9886, RATIS=9858, RATIS_ADMIN=9857, RATIS_SERVER=9856, STANDALONE=9859], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:53cf9d57-0a8f-4662-aa5d-ce7b8894c440, CreationTimestamp2022-07-12T20:58:33.787Z[UTC]] moved to OPEN state
2022-07-12 20:58:41 INFO  HealthyPipelineSafeModeRule:152 - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2022-07-12 20:58:41 INFO  SCMSafeModeManager:124 - SCM in safe mode. Healthy pipelines reported count is 1, required healthy pipeline reported count is 1
2022-07-12 20:58:41 INFO  SCMSafeModeManager:204 - HealthyPipelineSafeModeRule rule is successfully validated
2022-07-12 20:58:41 INFO  SCMSafeModeManager:219 - ScmSafeModeManager, all rules are successfully validated
2022-07-12 20:58:41 INFO  SCMSafeModeManager:248 - SCM exiting safe mode.
2022-07-12 20:58:41 WARN  EventQueue:216 - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2022-07-12 20:58:41 INFO  SCMContext:228 - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-07-12 20:58:41 INFO  BackgroundPipelineScrubber:82 - Service BackgroundPipelineScrubber transitions to RUNNING.
2022-07-12 20:58:41 INFO  ExpiredContainerReplicaOpScrubber:82 - Service ExpiredContainerReplicaOpScrubber transitions to RUNNING.
2022-07-12 20:58:41 INFO  ReplicationManager:495 - Service ReplicationManager transitions to RUNNING.
2022-07-12 20:58:41 WARN  ContainerBalancer:894 - Could not find persisted configuration for ContainerBalancer when checking if ContainerBalancer should run. ContainerBalancer should not run now.
2022-07-12 20:58:53 INFO  SequenceIdGenerator:128 - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-07-12 20:58:53 WARN  SequenceIdGenerator:237 - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-07-12 20:58:53 INFO  SequenceIdGenerator:128 - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
